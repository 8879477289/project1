var ZCSecurity=new function(){this.isURLXSSVulnerable=function(E){if(E){var B=E.trim().toLowerCase();var D=document.createElement("a");D.href=B;var A=D.protocol;if(A.indexOf("javascript:")===0||A.indexOf("vbscript:")===0||A.indexOf("data:")===0){return true}B=B.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"').replace(/'/g,"'");try{var F=decodeURIComponent(ZCSecurity.safariCheck(B)).replace(/[^\w:]/g,"").toLowerCase()}catch(C){}if(F.indexOf("javascript:")===0||F.indexOf("vbscript:")===0||F.indexOf("data:")===0){return true}}return false};this.safariCheck=function(A){return A.replace(/&([#\w]+);/g,function(C,B){if(B==="colon"){return":"}if(B.charAt(0)==="#"){return B.charAt(1)==="x"?String.fromCharCode(parseInt(B.substring(2),16)):String.fromCharCode(+B.substring(1))}return""})}}();var FormController=(function(D){ControllerFactory.call(this,D,ObjectType.FORM);var B=this;var C,G,F,E,A=false;this.fieldControllers={},this.buttonControllers={};this.bindEvents=function(){E=this.addFormStyle();F=this.adjustFormAlign();window.addEventListener("message",openURLListener);promises=B.resolveDependency();Promise.all(promises).then(function(){B.bindFormEvents()},B.handleDependencyErrors);document.addEventListener("scroll",function(H){$("#zc-fieldTooltipMsg").remove()},true)};this.handleDependencyErrors=function(H){if(H.message=="geoFenced"){$(B.getView().getDOM().getFormDOM()).remove();$("#geo-fence").show()}else{if(H.message=="ZE"){Console.log("ZE init error")}}};this.resolveDependency=function(){promiseArray=[];if(D.isGeoLocationMandatory()){if(B.getModel().hasOnLoad()){LIB._stopLoading()}geoLocationPromise=new Promise(function(I,H){Geolocation.init({overlay:B.getView().getGeoOverlay(),headerMsg:i18n.geoheaderform,success:I})}).then(function(){if(D.isGeoFenceEnabled()&&!isInsideFence(D.getGeoFenceObj(),Geolocation.getLocationDataObj())){throw new Error("geoFenced")}});promiseArray.push(geoLocationPromise)}if(D.hasDependencyField()){rtePromise=new Promise(B.checkForDepedency);promiseArray.push(rtePromise)}return promiseArray};this.applyStyles=function(H){if(H.origin===ZCGlobal.appbuilderserverprefix){B.getView().applyStyles(H.data)}};this.checkForDepedency=function(I,H){try{ZE}catch(J){if(J instanceof ReferenceError){setTimeout(function(){return B.checkForDepedency(I,H)},1000);return }H(new Error("ZE"))}A=true;I()};this.bindFormEvents=function(){var I=true;if(D.getAccessType()==FormAccessType.VIEW_EDIT_RECORD&&D.showOnlyViewFields()){I=false}if((B.removeLoading()||!I)&&!D.isPaymentCallback()){B.unlockForm()}var H=B.registerFields();if(H){B.resetForm()}else{B.getView().bindSubmit(D.getFormType());if(D.isPaymentCallback()){B.paymentCallback()}if(I){B.bindWorkflow()}B.bindButtonAction();B.bindAutomation();B.bindPermissions();B.focusFirstField();B.getView().bindScrollEvents();B.resetCaptcha();B.getView().getResetCaptchIcon().bind("click",function(){B.resetCaptcha()});if(D.getFormAlign()==FormAlign.INPLACE&&D.hasCaptcha()){this.getView().bindCaptchaFocus()}}};this.getFieldController=function(H){return this.fieldControllers[H]};this.getButtonController=function(H){return this.buttonControllers[H]};this.disableButton=function(H){B.getView().disableButton(H)};this.disableButtons=function(){var L=D.getButtons();for(var K=0,I=L.length;K<I;K++){var J=L[K];var H=J.BUTTONLABEL_NAME;this.disableButton(H)}};this.enableButton=function(H){B.getView().enableButton(H)};this.enableButtons=function(){var L=D.getButtons();for(var K=0,I=L.length;K<I;K++){var J=L[K];var H=J.BUTTONLABEL_NAME;this.enableButton(H)}};this.bindWorkflow=function(){C=new WorkflowController(this);C.execute()};this.paymentCallback=function(){var H=this;var I=false;var J={recLinkId:D.getRecordLinkIdFromMeta(),transactionId:D.getPmtTransactionId()};var L=function(){if(!LIB._isNull(D.getSuccessMsg())&&!I){$.successMsg(D.getSuccessMsg(),2000)}};var K=function(){if(LIB._isNull(D.getNextURL())){H.unlockForm()}else{H.nextUrlHandler()}};$.ajax({url:this.getURL().getPaymentPollURL(),method:"GET",data:J,success:function(N){delete Controller.FormController.cache[D.getFormLinkName()];Console.log(N);Console.log("Payment process completed..");var M=N.onCommitMsgs;if(!LIB._isNull(M)){if(!LIB._isNull(M.successMsg)){I=false;$.successMsg(M.successMsg,1000)}else{L()}if(!LIB._isNull(M.generatedJs)){evaluateJs(M.generatedJs,D.getAccessType())}else{K()}}else{L();K()}}})};this.bindAutomation=function(){var H=D.getRulesScript();if(H!=undefined){G=new AutomationController(this,H);G.execute()}};this.bindPermissions=function(){var H=this.getFormFields(),L=0,M=Object.keys(H),I=M.length;for(;L<I;++L){var K=H[M[L]],J=K.getModel();if(J.isReadOnly()){K.disableField()}if(!J.isVisible()){K.hideField()}}};this.getWorkflowController=function(){return C};this.getAutomationController=function(){return G};this.getFormAlignStyle=function(){return F.sheet};this.getFormStyle=function(){return E.sheet};this.resetCaptcha=function(){if(D.hasCaptcha()){this.getView().resetCaptcha(this.getURL().getCaptchaURL())}};this.showCaptchaError=function(H){if(D.hasCaptcha()){this.getView().showCaptchaError(H)}};this.clearCaptchaError=function(){this.getView().clearCaptchaError()};this.focusFirstField=function(){var H=D.getFirstFieldName();if(!isNull(H)&&D.focusFirstField()){this.getFieldController(H).focus()}};this.subFormAddRow=function(){var J=D.getFormFields();for(var P=0,R=Object.keys(J),M=R.length;P<M;++P){var Q=J[R[P]];var H=Q.FIELDCOMPTYPE;if(H==FieldType.SUB_FORM_GRID){var O=new SubformModel(Q,D);var N=O.getDefaultRow(),K=O.getCurrRows();if(O.hasOnAddRow()&&K==0&&N==0){var L=B.getWorkflowController();var I={fieldname:O.getActualLabelName(),rowseqid:"t::row_1"};L.trigger(L.WFTYPE.ONADD_ROW,I)}}}};this.markActive=function(){D.markActive()};this.unmarkActive=function(){D.unmarkActive()};this.submitTimeout;this.submitForm=function(){$(".zc-scroll-mask").hide();$("#active-DatePicker-Cont").empty();B.disableButtons();if((C!=undefined&&C.isActive())||D.isActive()||D.getNoOfActiveAddressOps()!=0){if(D.isActive()){LIB._startLoading()}this.submitTimeout=setTimeout(function(){B.submitForm()},100);return }if(!B.validateData()){$.alert({msg:i18n.invalidentriesfound,desc:i18n.correctandsubmit,handleFocus:false});B.enableButtons();return false}if(D.isGeoLocationMandatory()&&Geolocation.locationData==undefined){Geolocation.locationError=(Geolocation.locationError==undefined)?i18n.formgeolocationerror:Geolocation.locationError;$.alert({msg:Geolocation.locationError,desc:(Geolocation.locationError==i18n.formgeolocationerror)?i18n.formgeolocationdesc:i18n.geolocbrowsererror,handleFocus:false});B.enableButtons();return false}this.getModel().setTriggeredControllerType("formController");$.ajax({beforeSend:function(){LIB._startLoading()},type:"POST",url:B.getURL().getSubmitURL(),data:B.collectData(),success:function(I){LIB._stopLoading();var H=B.getMsgFromResponse(I);B.responseHandler(H)},error:function(J,H,I){LIB._stopLoading();B.enableButtons()}})};this.cancelSubmitForm=function(){clearTimeout(this.submitTimeout);this.enableButtons()};this.validateData=function(){var H=this.getFormFields();for(var K=0,L=Object.keys(H),J=L.length;K<J;++K){if(this.fieldControllers[L[K]].getModel().getComponentType()==FieldType.SUB_FORM_GRID){var I=this.fieldControllers[L[K]].getModel().getAllFields();for(subfld_key in I){var M=I[subfld_key].FIELDS;for(rowNo in M){if(M[rowNo].FIELDTYPE==FieldType.PHONE_NUMBER){M[rowNo].CONTROLLER.getField().trigger("blur");if(M[rowNo].CONTROLLER.getView().hasError){return false}}if(M[rowNo].FIELDTYPE==FieldType.CURRENCY&&M[rowNo].CONTROLLER.getModel().containsValidationError()){return false}}}}if(this.fieldControllers[L[K]].getModel().getComponentType()==FieldType.PHONE_NUMBER){this.fieldControllers[L[K]].getField().trigger("blur");if(this.fieldControllers[L[K]].getView().hasError){return false}}if(this.fieldControllers[L[K]].getModel().getComponentType()==FieldType.CURRENCY&&this.fieldControllers[L[K]].getModel().containsValidationError()){return false}}return true};this.addFormStyle=function(){return this.getView().addStyleToForm("formStyle",D.getFormStyle())};this.bindButtonAction=function(){var H=D.getButtons(),L=this.getView();for(var K=0,I=H.length;K<I;K++){var J=H[K];this.buttonControllers[J.BUTTONLABEL_NAME]=Controller.FormButtonController.create({model:J,formcontroller:this})}};this.resetForm=function(I){if(D.getAccessType()!=FormAccessType.VIEW_EDIT_RECORD){Controller.FormController.loadFromCacheOrfetchForm(D.getFormLinkName(),D.getFromParams(),I)}if(!(D.isPerma()||D.isEmbed())){if(!isNull(getCookie("zc-walkthroughstep"))){var H=parseInt(getCookie("zc-walkthroughstep"));new WalkThrough().proceed(H)}}};this.lockForm=function(){this.getView().showOverlay()};this.unlockForm=function(){if(this.isPage&&this.container){$(this.container.querySelector("#form-overlay")).hide()}else{this.getView().hideOverlay()}LIB._stopLoading()};this.showProgress=function(){this.getView().showProgress()};this.hideProgress=function(){this.getView().hideProgress()};this.adjustFormAlign=function(){var Z="",N=this.getView(),O=0,J=30,V=N.getFormContainerLeftRightPadding(),e="#"+D.getFormLinkName()+"_"+D.getRandStr();var Y=N.getContainerWidth();var T=".zcform_"+D.getFormLinkName()+" ";var o=$.isEmptyObject(D.getFormFields());var d=0;var R=1;var U=0;var a=0;if(!D.isCustomFormLabelWidth()&&(D.getFormType()==2)){var L=$(".form-outer-wrapper").length-1;$(".form-outer-wrapper").eq(L).addClass("statelessFormWidth")}while(R<=D.getMaxCol()){if(R==D.getMaxCol()){J=0}var n=R==1?".first-column":(R==2?".second-column":".column-"+R);var M=X(D.getFieldsByColumnNo(R));var W=N.findCaptchaLabelWidth();M.LABEL=(R==1&&D.hasCaptcha()&&M.LABEL<W)?W:M.LABEL;M.INPUT=(R==1&&D.hasCaptcha()&&M.INPUT<Constants.CAPTCHA_MIN_WIDTH)?Constants.CAPTCHA_MIN_WIDTH:M.INPUT;var I=(D.isCustomFormLabelWidth())?D.getLabelWidth():M.LABEL;Z+=T+n+" .form-label{width : "+I+((D.isCustomFormLabelWidth())?D.getLabelWidthUnit():"px")+";}\n";Z+=T+n+" .form-field{width : "+M.INPUT+"px;}\n";if(D.getFormAlign()==FormAlign.LEFT||D.getFormAlign()==FormAlign.RIGHT){var b=I+M.INPUT+O+J;var K=p(D.getFieldsByColumnNo(R))+O+J;b=Math.max(b,K);b=Math.ceil(b);b=b<Constants.COLUMN_MINWIDTH?Constants.COLUMN_MINWIDTH:b;Z+=T+".label-left "+n+", .label-right "+n+" {width : "+b+"px;}\n";d+=b;U=U+b}else{var Q=Math.max(I,M.INPUT)+J;Q=Q<Constants.COLUMN_MINWIDTH?Constants.COLUMN_MINWIDTH:Q;Q=Math.ceil(Q);Z+=T+".label-top "+n+", .label-inplace "+n+" {width : "+Q+"px;}\n";d+=Q;a=a+Q}var H=S(M,K,O,J,n);Z+=T+n+" .notes-field{width:"+H+"px}\n";R++}d+=V;Z+=T+".decision-box-label {width:auto !important}\n";if(o&&!D.isPerma()){Z+=T+"form[name='"+D.getFormLinkName()+"'].label-left {width : 100%;}\n"}else{var h=(window.location!=window.parent.location)?document.body.scrollWidth:screen.width;if((!D.isPerma()&&!D.isEmbed())||((D.isPerma()||D.isEmbed())&&d>h)){var c=(U+V),P=(a+V);Z+="form[name='"+D.getFormLinkName()+"'].label-left {width : "+Math.max(Y,c)+"px;}\n";Z+="form[name='"+D.getFormLinkName()+"'].label-top {width : "+Math.max(Y,P)+"px;}\n";Z+="form[name='"+D.getFormLinkName()+"'].label-right {width : "+Math.max(Y,c)+"px;}\n";Z+="form[name='"+D.getFormLinkName()+"'].label-inplace {width : "+Math.max(Y,P)+"px;}\n"}if(D.isPerma()&&d>h){if($("body").hasClass("zc-form-perma")){$("body").removeClass("zc-form-perma");$("body").addClass("zc-form-embed")}}}return this.getView().addStyleToForm("alignmentStyle",Z);function m(q){var s=$(N.getDOM().getFormDOM().querySelector('div[name="'+q+'"]'));if(s!=null){return $(s).parents('div[elname="formRow"]').children(".formColumn").not(".column-0").children().length==1}return false}function X(z){var AB=0,u=0,w=0;maxPlainTextWidth=0;for(var y=0,AD=Object.keys(z),x=AD.length;y<x;++y){var AC=z[AD[y]],q=AC.FIELDCOMPTYPE,v=AC.ISSUBFORM,AA,s;if(AC.FIELDISHIDDEN||q==FieldType.SUB_FORM_GRID||q==FieldType.SECTION||q==FieldType.DECISIONBOX){continue}else{if(q==FieldType.PLAIN_TEXT){H=N.plainTextWidth(AC.FIELDCLASSNAME);H=(H<Constants.PLAINTEXT_MIN_WIDTH)?Constants.PLAINTEXT_MIN_WIDTH:H;if(m(AC.ACTUALLABEL)){$(N.getDOM().getFormDOM().querySelector('div[name="'+AC.ACTUALLABEL+'"]')).width(H);continue}if(H>maxPlainTextWidth){maxPlainTextWidth=H}}else{AA=N.findFieldLabelWidth(AC.FIELDCLASSNAME+"-label");s=N.findFieldInputWidthEveryColumn(AC.FIELDCLASSNAME);if(q==FieldType.IMAGE&&AC.IMAGETYPE==Constants.LINKANDLOCAL){s=s+30}}}if(AA>AB){AB=AA}if(s>u){u=s}}if((D.getFormAlign()==FormAlign.LEFT||D.getFormAlign()==FormAlign.RIGHT)&&(maxPlainTextWidth>AB+u)){u=maxPlainTextWidth-AB}else{if((D.getFormAlign()==FormAlign.TOP||D.getFormAlign()==FormAlign.INPLACE)&&(maxPlainTextWidth>AB&&maxPlainTextWidth>u)){u=maxPlainTextWidth}}return{LABEL:AB,INPUT:u,}}function S(u,x,z,v,y){var s=(D.isCustomFormLabelWidth())?D.getLabelWidth():u.LABEL;var q=null;if(u.INPUT==0){q=N.getFormContainer().find(y).width()}else{q=u.INPUT+z+v;if(D.getFormAlign()!=FormAlign.TOP&&D.getFormAlign()!=FormAlign.INPLACE){q+=s}}var w=Math.max(q,x);return Math.ceil(w)}function p(x){var w=0;for(var u=0,v=Object.keys(x),q=v.length;u<q;++u){var s=x[v[u]];if(s.FIELDISHIDDEN||s.FIELDCOMPTYPE!=FieldType.SUB_FORM_GRID||s.FIELDWIDTH==undefined){continue}w=Math.max(w,s.FIELDWIDTH)}return w}};this.registerFields=function(){var M=D.getFormFields();var I=D.isPermaOrEmbed();var N=(window.performance!=undefined&&(window.performance.navigation.type==window.performance.navigation.TYPE_BACK_FORWARD));var K=D.hasOnLoad();for(var J=0,L=Object.keys(M),H=L.length;J<H;++J){if(I&&N&&(D.getAccessType()==FormAccessType.ADD_RECORD)&&(K||M[L[J]].ONCHANGEEXIST)&&!ZCGlobal.stopResetClick){ZCGlobal.stopResetClick=true;return true}this.fieldControllers[L[J]]=Controller.FieldController.create({model:D.getFormFieldMeta(L[J]),formController:this,data:D.getFormFieldData(L[J])})}return false};this.handlePopupPositionForMobile=function(){if((window.self!==window.top)&&isMobileBrowser()){var I=$(".popupbox-wrapper");$(I[I.length-1]).removeClass("zc-alert-popupissue").addClass("zc-alert-popupissue");var H=$(".zc-freezer.zc-freezer-layer");$(H[H.length-1]).removeClass("zc-alert-popupissue").addClass("zc-alert-popupissue")}};this.responseHandler=function(K){this.getView().hideFormErrorInfo();if(K.errMsg!=undefined&&K.errMsg.length>0){this.getView().showFormErrorInfo(K.errMsg);B.enableButtons()}if(K.fieldErrObj!=undefined){if(K.paidUserFieldError!=undefined){$.alert({msg:K.paidUserFieldError,handleFocus:false});this.getView().showFormErrorInfo(K.paidUserFieldError)}else{$.alert({msg:i18n.invalidentriesfound,desc:i18n.correctandsubmit,handleFocus:false,callback:function(){B.errorhandler(K.errMsg,K.fieldErrObj)}})}B.handlePopupPositionForMobile();this.resetCaptcha();B.enableButtons();return }if(K.succMsg!=undefined){if(K.paymentConfig!=undefined){$.successMsg(i18n.redirectopaypal,4000);this.lockForm();this.showProgress();this.proceedPayment(K.paymentConfig,K.recLinkID);return false}if(B.isNewPage){$(document).trigger("datachange",[B.getModel().getFormId(),$(this.container).closest("[eltype]")])}this.successHandler(K)}if(K.hostedPageUrl!=undefined){$.successMsg(i18n.redirectopaypal,4000);this.lockForm();this.showProgress();this.redirectToCheckout(K.hostedPageUrl,K.recLinkID);return false}if(K.PMT_ERROR!=undefined){$.alert({msg:K.PMT_ERROR})}if(K.alertMsg!=undefined&&K.alertMsg.length>0){for(alertsInd in K.alertMsg){var M=K.alertMsg[alertsInd];for(var J=0,H=M.length;J<H;J++){var L=M[J];L=L.replace(/\n/g,"<br>").replace(/\\r/g,"").replace(/#zc_amp#/g,"&");$.alert({msg:L});B.handlePopupPositionForMobile()}}}if(K.infoMsg!=undefined&&Object.keys(K.infoMsg).length>0){var I=(D.getAccessType()!=1)?true:((K.succMsg!=undefined)?false:true);if(I){this.infoMsgHandler(K.infoMsg)}}if(K.errorMsg!=undefined&&Object.keys(K.errorMsg).length>0){this.showError(K.errorMsg);return }if(K.isScriptCancelSubmit){if(!LIB._isNull(K.generatedjs)){evaluateJs(K.generatedjs,D.getAccessType())}if(K.alertMsg==undefined||K.alertMsg.length<=0){$.alert({msg:i18n.invalidentriesfound,desc:i18n.correctandsubmit,handleFocus:false,callback:function(){B.errorhandler(K.errMsg,K.fieldErrObj)}});B.handlePopupPositionForMobile()}this.resetCaptcha();B.enableButtons();return }if(!K.isScriptCancelSubmit){this.nextUrlHandler(K)}};this.nextUrlHandler=function(L){if(!LIB._isNull(L)&&!LIB._isNull(L.generatedjs)){var R=evaluateJs(L.generatedjs,D.getAccessType());if(R){return false}}if(!LIB._isNull(D.getNextURL())){var S=ZCSecurity.isURLXSSVulnerable(D.getNextURL())?null:D.getNextURL();var R=(S!=null)?LIB._openURL(S,D.openFormIn()):false;if(R){return false}}function I(V,U){if(U==V){if($zcmodal.hasInstance()){$zcmodal.getTopPopup().close()}$(window).trigger("hashchange")}}if(!LIB._isNull(L)&&!LIB._isNull(L.nexturl_rule)){var Q=L.nexturl_rule;if(Q!=undefined&&Q!=null&&!$.isEmptyObject(Q)){var S=L.nexturl_rule.nexturl;S=ZCSecurity.isURLXSSVulnerable(S)?null:S;var N=Q.openin;var P=Q.type;P=(P=="form")?"Form":(P=="view")?"Report":(P=="html")?"Page":P;if((D.isPerma()||D.isEmbed())&&P!="url"){return true}var H=Q.component;if(N=="2"){if(P=="url"){ZSEC.secureRedirector.open(S,"_new")}else{var K=window.location.href.split("#")[0]+"#"+P+":"+H;window.open(K)}}else{if(N=="3"){var J=window.opener;var O=window;O=(J!=null)?J:window.parent;if(P=="url"){O.location.href=S}else{var M=O.location.hash;var T="#"+P+":"+H;O.location.hash=T;I(M,T)}}else{if(P=="url"){window.location=S}else{var M=window.location.hash;var T="#"+P+":"+H;window.location.hash=T;I(M,T)}}}return true}}return true};this.proceedPayment=function(I,T){var P=false;var R=false;if(D.isPermaOrEmbed()&&!D.isPublic()){LIB._initGlobals()}if(I.isDemo){I[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken}if(D.isPerma()||B.isPagePerma){P=true}if(D.isEmbed()||B.isPageEmbed){R=true}var H=D.getPrivateLink();var K=this.getURL().getPaymentCallbackURL(I.environment,T,P,R);var N=this.getURL().getNotificationUrl(I.environment,T,P,R);var L=K+"/cancel";var Q=K+"/return";if(!LIB._isNull(H)){N+="?privatelink="+H;L+="?privatelink="+H;Q+="?privatelink="+H}var J=!LIB._isNull(H)?"&":"?";L+=J;Q+=J;if(!LIB._isNull(D.getNextURL())){L+="zc_NextUrl="+D.getNextURL()+"&";Q+="zc_NextUrl="+D.getNextURL()+"&"}else{if(B.isPage){var O=window.location.href;if(O.indexOf("#")!=-1){var M=encodeURIComponent(O.substring(O.indexOf("#")));L+="zc_NextUrl="+M+"&";Q+="zc_NextUrl="+M+"&"}else{O=encodeURIComponent(O);L+="zc_NextUrl="+O+"&";Q+="zc_NextUrl="+O+"&"}}}if(!LIB._isNull(D.openFormIn())){L+="zc_OpenUrlIn="+D.openFormIn()+"&";Q+="zc_OpenUrlIn="+D.openFormIn()+"&"}if(!LIB._isNull(D.getSuccessMsg())){L+="zc_SuccMsg="+i18n.paypaypaymentcancel;Q+="zc_SuccMsg="+D.getSuccessMsg()}else{L+="zc_SuccMsg="+i18n.paypaypaymentcancel}I.notify_url=N;I.cancel_return=L;I["return"]=Q;var S=document.createElement("form");S.setAttribute("method","post");S.setAttribute("action",(I.isDemo)?"/app/form/jsp/paypalTesting.jsp":I.paypalUrl);S.setAttribute("target","_top");delete I.paypalUrl;delete I.environment;$.each(I,function(V,U){var W=document.createElement("input");W.setAttribute("type","hidden");W.setAttribute("name",V);W.setAttribute("value",U);S.appendChild(W)});$(S).appendTo("body").submit()};this.redirectToCheckout=function(H,I){window.open(H,"_self")};this.successHandler=function(L){if(!(D.isPerma()||D.isEmbed())){if(!isNull(getCookie("zc-walkthroughstep"))){var I=parseInt(getCookie("zc-walkthroughstep"));if(I===17||I===18||I===19){setCookie("zc-walkthroughstep",I+1,30,"","/");new WalkThrough().proceed(I)}}}var R=(!LIB._isNull(D.getSuccessMsg()))?D.getSuccessMsg():L.succMsg;var Q=D.getNextURL();if(R!="zc_success"){if(D.getAccessType()!=FormAccessType.VIEW_EDIT_RECORD){$.successMsg(R,3000)}}if(!LIB._isNull(L.formrestriction)){this.resetForm()}else{function K(T){if(T.indexOf("openWindowTask")!=-1){var U="openWindowTask('";var S=T.substring(T.indexOf("openWindowTask(")+"openWindowTask('".length);openType=S.split(",")[1];openWindowType=openType.substring(1,openType.length-1).toLowerCase();S=S.substring(0,S.indexOf("'"));return(S!=""&&(openWindowType=="same window"||openWindowType=="parent window"))}else{return false}}function J(V){var S=L.nexturl_rule;if(S!=undefined&&S!=null&&!$.isEmptyObject(S)){if((D.isPerma()||D.isEmbed())&&!LIB._isNull(S.component)){return false}var T=L.nexturl_rule.nexturl;var U=S.openin;return(T!=""&&(U=="SameWindow"||U=="1"))}else{return false}}if(D.getAccessType()==FormAccessType.VIEW_EDIT_RECORD){var H=function(){if(!LIB._isNull(L.generatedjs)&&!K(L.generatedjs)){var S=B.getURL().getRecordSuccessURL(D.getViewLinkName());var U=document.createElement("form");U.method="POST";U.action=S;var V=document.createElement("input");V.name="successMsg";V.type="hidden";V.value=R;if(D.getPrivateLink()!=undefined){var T=document.createElement("input");T.name="privateLink";T.type="hidden";T.value=D.getPrivateLink();U.appendChild(T)}U.appendChild(V);document.body.appendChild(U);U.submit()}};var O=function(S){if(LIB._isNull(S)){return false}switch(S.toLowerCase()){case"same window":case"same":case"this":case"this window":return true;default:return false}};var P=function(){var S=L.nexturl_rule;if(S!=undefined&&S!=null&&!$.isEmptyObject(S)){if((D.isPerma()||D.isEmbed())&&!LIB._isNull(S.component)){return false}return true}return false};var N=function(){if(!LIB._isNull(L.generatedjs)&&(L.generatedjs.indexOf("openWindowTask(")!=-1)&&!D.isPerma()&&!D.isEmbed()){return true}return false};if(!LIB._isNull(Q)){var M=D.openFormIn();if(!LIB._isNull(M)&&!O(M)){H()}}else{if(N()||P()){return true}else{H()}}}else{if((!LIB._isNull(L.generatedjs)&&!K(L.generatedjs))&&(!LIB._isNull(L.nexturl_rule)&&!J(L.nexturl_rule))){this.resetForm(L.infoMsg)}}}};this.errorhandler=function(N,T){var S=0,M={SF:"SUBFROM",FD:"ROW",SV:"FIELD",MV:"FIELD"},O=this;for(var I in T){var J=T[I];for(var K in J){if(K=="zc_captcha_txt"){O.showCaptchaError(J[K]);continue}var L=J[K],R={};if(K.indexOf("(")!=-1){P(K,R,0);K=R.SUBFROM}var Q=O.getFieldController(K);if(Q!=undefined){Q.showError(L,R.ROW,R.FIELD);if(S==0){Q.focus(R.ROW,R.FIELD)}}}S++}if(!(D.isPerma()||D.isEmbed())){if(!isNull(getCookie("zc-walkthroughstep"))){var H=parseInt(getCookie("zc-walkthroughstep"));setCookie("zc-walkthroughstep",(H),30,"","/");new WalkThrough().proceed(H)}}function P(W,a,Z){var V=W.indexOf("(",Z),Y=W.indexOf(")",V),U=W.length;if(Y!=U-1){P(W,a,Y)}var X=M[W.substr((V-2),2)];a[X]=W.substring(V+1,Y)}};this.infoMsgHandler=function(H){this.getView().showFormInfo(H)};this.showInfo=function(H){$.zcmodal({type:ZCModalConstants.JIT_MODAL,width:450,beforeShow:function(J){for(var K in H){var L=H[K];for(var I in L.UserMsgs){$(J).find("#info-"+K+""+I).text(L.UserMsgs[I])}}},buildDOM:function(){var I="";for(var K in H){var L=H[K];I+="<h3>"+L.HeaderMsg+"</h3>";for(var J in L.UserMsgs){I+="<span id='info-"+K+""+J+"'></span></br>";while(L.UserMsgs[J].indexOf("#zc_amp#")!=-1){L.UserMsgs[J]=L.UserMsgs[J].replace("#zc_amp#","&")}}}return'<div class="infoMsg" style="white-space:pre-line">'+I+"</div>"},buttons:[]})};this.showError=function(H){$.zcmodal({type:ZCModalConstants.JIT_MODAL,width:450,buildDOM:function(){var J="";var I="Error";J+="<h3>"+I+"</h3><p>"+H+"</p><br/>";return'<div class="infoMsg">'+J+"</div>"},buttons:[]})};this.getMsgFromResponse=function(L){var J={},M=D.getFormId();if(typeof (L)=="object"){for(var I in L){var N=L[I];if(typeof (N)=="object"){for(var K in N){var H=N[K];if(K==("success"+M)){J.succMsg=H}else{if(K==("errors"+M)&&typeof (H)=="object"){J.fieldErrObj=H}else{if(K==("errors"+M)){J.errors=H}else{if(K==("errorList"+M)&&typeof (H)=="object"){J.errorList=H}else{if(K==("successList"+M)&&typeof (H)=="object"){J.successList=H}else{if(K==("successes"+M)){J.fieldSuccObj=H}else{if(K==("recordDetails"+M)){J.recordDetails=H}else{if(K==("msg"+M)){J.errMsg=H}else{if(K==("info"+M)){J.infoMsg=H}else{if(K==("alert"+M)){J.alertMsg=H}else{if(K==("successMsgDuration"+M)){J.successMsgDuration=H}else{if(K==("captcha"+M)){J.captchaTxt=H}else{if(K==("generatedjs"+M)){J.generatedjs=H}else{if(K==("errorMsg"+M)){J.errorMsg=H}else{if(K==("status"+M)){J.statusMsg=H}else{if(K==("dummyForm")){J.dummyForm=H}else{if(K==("execType")){J.execType=H}else{if(K==("successmsg")){J.successmsg=H}else{if(K==("lookupFieldValue"+M)){J.lookupFieldValue=H}else{if(K==("childFormAccessType"+M)){J.childFormAccessType=H}else{if(K==("childFieldLabelName"+M)){J.childFieldLabelName=H}else{if(K==("childFormLinkName"+M)){J.childFormLinkName=H}else{if(K==("isFromSubForm"+M)){J.isFromSubForm=H}else{if(K==("compType"+M)){J.compType=H}else{if(K==("childSubformField"+M)){J.childSubformField=H}else{if(K==("rowNo"+M)){J.rowNo=H}else{if(K==("recLinkID"+M)){J.recLinkID=H}else{if(K==("paymentConfigId"+M)){J.paymentConfigId=H}else{if(K==("paymentConfig"+M)){J.paymentConfig=H}else{if(K==("hostedPageUrl")+M){J.hostedPageUrl=H}else{if(K==("PMT_ERROR")+M){J.PMT_ERROR=H}else{if(K==("combinedValue"+M)){J.combinedValue=H}else{if(K==("paidUserFieldError"+M)){J.paidUserFieldError=H}else{if(K===("nexturl_rule"+M)){J.nexturl_rule=H}else{if(K===("formrestriction"+M)){J.formrestriction=H}else{if(K==("showHtmlOnly")){J.showHtmlOnly=H}else{if(K==("scriptCancelSubmit"+M)){J.isScriptCancelSubmit=H}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return J};this.applyDataChanges=function(H){if(D.getAccessType()==FormAccessType.VIEW_EDIT_RECORD){H.viewLinkName=D.getViewLinkName();H.pkValue=D.getPKValue()}return H};this.collectFieldData=function(I,L){var N={},M=this.getFormFields();for(var K=0,P=Object.keys(M),J=P.length;K<J;++K){if(!L&&M[P[K]].getModel().getComponentType()==FieldType.SCRIPT){continue}var O=M[P[K]].getModel();var H=O.getComponentType();if((H==FieldType.DROPDOWN||H==FieldType.INLINE_PICK_LIST||H==FieldType.POPUP_SINGLE||H==FieldType.SYSTEM_LOOKUP||H==FieldType.EXTERNAL_FIELD)&&this.getModel().getTriggeredControllerType()=="formController"){if(M[P[K]].getValue()==""){N[O.getActualLabelName()]="-Select-"}else{M[P[K]].fillValue(N)}}else{M[P[K]].fillValue(N)}if(!I){M[P[K]].clearError()}}return N};this.collectData=function(J,I){var H=this.collectFieldData(J,I);if(!J&&D.hasCaptcha()){this.clearCaptchaError();H.zc_captcha=this.getView().getCaptchaVal();H.cdigest=this.getView().getCaptchaDigest()}if(!J&&D.isGeoLocationMandatory()&&Geolocation.locationData!=undefined){H.geolocation=Geolocation.locationData}H.formid=D.getFormId();H[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;H.recType=D.getAccessType();if(!isNull(D.getPrivateLink())){if(D.getAccessType()==FormAccessType.BULK_EDIT){H.privateLink=D.getPrivateLink()}H.privatelink=D.getPrivateLink();if(D.getAccessType()==FormAccessType.VIEW_ADD_RECORD||D.getAccessType()==FormAccessType.VIEW_EDIT_RECORD||D.getAccessType()==FormAccessType.BULK_EDIT){H.viewPrivateLink=D.getPrivateLink()}if(D.getAccessType()==FormAccessType.LOOKUP_ADD){H.childFormPrivateLink=D.getPrivateLink()}}return this.applyDataChanges(H)};this.triggerOnUserInput=function(){};this.childRelations=[];this.getChildRelation=function(){var I={zc_lookupCount:1,zc_childappname_1:D.getAppLinkName(),zc_childformname_1:D.getFormLinkName(),childFormAccessType:D.getAccessType(),childFormLinkName:D.getFormLinkName(),childAppLinkName:D.getAppLinkName(),baseAccessType:1};for(var H in this.childRelations){I=$.extend(I,this.childRelations[H])}return I};this.addChildRelation=function(H){this.childRelations.push(H)};this.getFormFields=function(){return this.fieldControllers};this.getFormButtons=function(){return this.buttonControllers};this.closeForm=function(){if($zcmodal.getTopPopup()!=undefined){$zcmodal.getTopPopup().close()}};this.removeLoading=function(){if(D.getAccessType()==FormAccessType.VIEW_EDIT_RECORD&&D.showOnlyViewFields()){return true}else{if(D.hasDependencyField()&&!B.getModel().hasOnLoad()){return A}}return !B.getModel().hasOnLoad()};this.addPendingTask=function(H){B.getModel().addPendingTask(H)};this.removePendingTask=function(H){B.getModel().removePendingTask(H)};this.getPendingTaskFields=function(){return B.getModel().getPendingTaskFields()};this.resizeInPage=function(){if(B.isNewPage){$(document).trigger("resizeform",[$("#"+B.getModel().getFormLinkName()+"_"+B.getModel().getRandStr())])}}});FormController.prototype=Object.create(ControllerFactory.prototype);FormController.prototype.constructor=FormController;var PreviewFormController=(function(B,C){FormController.call(this,B);var A=this;this.bindEvents=function(){formStyle=this.addFormStyle();alignStyle=this.adjustFormAlign();this.registerFields();this.unlockForm();if(window.self!==window.top){window.addEventListener("message",A.applyStyles);parent.postMessage("zc-formpublishpreview",ZCGlobal.appbuilderserverprefix)}};this.removeLoading=function(){return true};$(document).bind("contextmenu",function(D){return false})});PreviewFormController.prototype=Object.create(FormController.prototype);PreviewFormController.prototype.constructor=PreviewFormController;var ReportFormController=(function(A,B){FormController.call(this,A);this.successHandler=function(C){if(C.succMsg!="zc_success"){$.successMsg(C.succMsg,3000)}if(ZCGlobal.isMobileLayout&&$zcmodal.hasInstance()){setTimeout(function(){$(".zc-mobile-back-button").show()})}B.showReport("","","","",undefined,true)};this.applyDataChanges=function(D){var C;var E=B.getModel();if(E.isSavedReport()){C=E.getParentReportLinkName()}else{C=E.getReportLinkName()}D.viewLinkName=C;D.pkValue=A.getPKValue();return D};this.infoMsgHandler=function(C){this.showInfo(C)}});ReportFormController.prototype=Object.create(FormController.prototype);ReportFormController.prototype.constructor=ReportFormController;var ReportAddFormController=(function(A,B){FormController.call(this,A);this.successHandler=function(C){if(C.succMsg!="zc_success"){$.successMsg(C.succMsg,3000)}this.closeForm();B.showRelatedListRecord()};this.infoMsgHandler=function(C){this.showInfo(C)}});ReportAddFormController.prototype=Object.create(FormController.prototype);ReportAddFormController.prototype.constructor=ReportAddFormController;var BulkEditFormController=(function(A,B){FormController.call(this,A);this.bindEvents=function(){formStyle=this.addFormStyle();alignStyle=this.adjustFormAlign();this.registerFields();this.getView().bindSubmit(A.getFormType());this.unlockForm()};this.registerFields=function(){var I=A.getFormFields(),D=[];var H=A.getSortedKeys();for(var F=0,C=H.length;F<C;++F){var E=Controller.FieldController.create({model:A.getFormFieldMeta(H[F]),formController:this,data:A.getFormFieldData(H[F])});var G={};G.text=I[H[F]].FIELDDISPLAYNAME;G.id=H[F];D.push(G);E.hideField();this.fieldControllers[H[F]]=E}this.getView().bindBulkEditInput(D)};this.submitForm=function(){var D=this,E=B.getSelectedRecords().length,F=D.getView().getBulkEditSelFields().length;$(".zc-scroll-mask").hide();$("#active-DatePicker-Cont").empty();D.disableButtons();if(A.getNoOfActiveAddressOps()!=0){D.submitTimeout=setTimeout(function(){D.submitForm()},100);return }if(E==0){$.alert({msg:i18n.norecordselect,desc:i18n.updatenorecord});return false}if(F==0){$.alert({msg:i18n.nofieldselect,desc:i18n.updatenofield});return false}if(A.isGeoLocationMandatory()&&Geolocation.locationData==undefined){Geolocation.locationError=(Geolocation.locationError==undefined)?i18n.formgeolocationerror:Geolocation.locationError;$.alert({msg:Geolocation.locationError,desc:(Geolocation.locationError==i18n.formgeolocationerror)?i18n.formgeolocationdesc:i18n.geolocbrowsererror,handleFocus:false});return false}this.getModel().setTriggeredControllerType("formController");var C=new Array();C[0]=E;$.confirm({message:((E>1)?replaceParams(i18n.updaterecords,C):replaceParams(i18n.updaterecord,C))+" "+((F>1)?i18n.updatevalues:i18n.updatevalue),description:i18n.editcontinue,success:function(){$.ajax({beforeSend:function(){LIB._startLoading()},type:"POST",url:D.getURL().getSubmitURL(),data:D.collectData(),success:function(H){LIB._stopLoading();var I=B.getModel();if(B.isPage!=undefined&&B.isPage&&I.isReportEmbedEnhancement()){$("div[elname='recordDetailViewFreeze']").remove()}var G=D.getMsgFromResponse(H);D.responseHandler(G)}})}})};this.collectFieldData=function(){var E={},C=this.getView().getBulkEditSelFields();for(var G=0,D=C.length;G<D;G++){var F=this.getFieldController(C[G]);F.fillValue(E);F.clearError()}return E};this.applyDataChanges=function(D){var E=B.getModel();var C=E.getReportLinkName();if(E.isSavedReport()){C=E.getParentReportLinkName()}D.viewLinkName=C;D.SelLabel=JSON.stringify(this.getView().getBulkEditSelFields());D.updateIdList=JSON.stringify(B.getSelectedRecords());return D};this.showhideField=function(D,C){if(C){this.getFieldController(D).showField()}else{this.getFieldController(D).hideField()}};this.successHandler=function(C){if(C.succMsg!="zc_success"){$.successMsg(C.succMsg,3000)}if($zcmodal.hasInstance()){$zcmodal.getTopPopup().close()}B.showReport()};this.nextUrlHandler=function(){return true};this.infoMsgHandler=function(C){this.showInfo(C)}});BulkEditFormController.prototype=Object.create(FormController.prototype);BulkEditFormController.prototype.constructor=BulkEditFormController;var LookupFormController=(function(B,C){FormController.call(this,B);var A=this;this.getChildRelation=function(){var D=C.getChildRelation(),E=D.zc_lookupCount+1;D.zc_lookupCount=E;D["zc_childappname_"+E]=B.getAppLinkName();D["zc_childformname_"+E]=B.getFormLinkName();D.childFormAccessType=B.getAccessType();D.childFormLinkName=B.getFormLinkName();D.childAppLinkName=B.getAppLinkName();return D};this.successHandler=function(I){var G={id:I.lookupFieldValue,text:I.combinedValue};var F=C.getModel();C.addValue(G);if(F.getComponentType()==FieldType.LIST||F.getComponentType()==FieldType.CHECK_BOXES){var E=C.getSelectedChoice();E.push(G);C.setFieldValue(E)}else{C.setFieldValue(G)}closeDialog();var D=F.getFormModel();var H=A.getModel().getFormLinkName()};this.nextUrlHandler=function(){return true};this.infoMsgHandler=function(D){};this.applyDataChanges=function(F){F.recType=5;var D=C.getChildRelation();for(var E in D){if(D.hasOwnProperty(E)){F[E]=D[E]}}return F}});LookupFormController.prototype=Object.create(FormController.prototype);LookupFormController.prototype.constructor=LookupFormController;var FormButtonController=(function(D,F){ControllerFactory.call(this,D,ObjectType.FORMBUTTON);AutomationOperation.call(this);var E={62:{TYPE:"SUBMIT",ACTION:1},63:{TYPE:"RESET",ACTION:2},64:{TYPE:"CANCEL",ACTION:2},61:{TYPE:"BUTTON",ACTION:1}};var A=F.getModel().getAccessType(),B=F.getModel().getFormType(),C=F.getWorkflowController();this.bindEvents=function(){if(E[D.getButtonID()].ACTION==1){this.bindPrimaryAction()}else{this.bindSecondaryAction()}return this};this.resetToCancel=function(){$(this.getButton()).val(i18n.cancel);$(this.getButton()).unbind("click").click(function(){F.closeForm()})};this.getButton=function(){return F.getView().getButton(D.getButtonName())};this.getLabelName=function(){return D.getButtonName()};this.isVisible=function(){return this.visibility};this.isAccessible=function(){return this.accessibility};this.hideField=function(){$(this.getButton()).hide()};this.showField=function(){$(this.getButton()).show()};this.enableField=function(){this.enableButton()};this.disableField=function(){this.disableButton()};this.disableButton=function(G){F.getView().disableButton(D.getButtonName())};this.enableButton=function(G){F.getView().enableButton(D.getButtonName())};this.bindPrimaryAction=function(){if(B==2&&D.getButtonEvent()==51){var G={buttonname:D.getButtonName()};this.getButton().click(function(I){var H=F.getPendingTaskFields();if(H.length){$(this).attr("autosubmit",true);return }C.trigger(C.WFTYPE.BUTTON_CLICK,G);I.preventDefault()})}};this.bindSecondaryAction=function(){$(this.getButton()).click(function(G){if(A==1){F.resetForm()}else{F.closeForm()}G.preventDefault()})};this.visibility=$(this.getButton()).is(":visible");this.accessibility=!$(this.getButton()).is(":disabled")});FormButtonController.prototype=Object.create(ControllerFactory.prototype);FormButtonController.prototype.constructor=FormButtonController;var FieldController=(function(A,C){var B=C;ControllerFactory.call(this,A,ObjectType.FIELD,C);AutomationOperation.call(this);this.recordsLimit=100000;this.init=function(){var D=A.getDefaultValue();if(D!==""){this.getView().setValue(D)}};this.positionDropDown=function(H,D){if(ZCGlobal.appDirectionMeta.isRTL){var F=$(H);var G=$(D);var E=F.width()-G.width();if(G.offset().left==F.offset().left){F.css("left",F.offset().left-E)}}};this.bindEvents=function(){this.getView().fieldEvents();this.getView().bindChange();var E=A.getComponentType();if(A.isFormulaExist()&&E!=FieldType.IMAGE&&E!=FieldType.FILE_UPLOAD&&E!=FieldType.VIDEO&&E!=FieldType.AUDIO){this.getView().bindFormula()}if(this.getView().isFloatLabelAlignment()){this.getView().bindFocus()}var F=A.getDescType();if(A.getTitle()!=undefined&&!isNull(A.getTitle().trim())&&F!=0){function D(G){if(!ZCGlobal.isMobileLayout&&!isMobileBrowser()){if(G==1||(G==2&&A.isSubformField())){return"tooltip"}else{if(G==2){return"helptext"}}}else{if(!A.isSubformField()){return"helptext"}}return"none"}switch(D(F)){case"tooltip":this.getView().bindFieldDescription();break;case"helptext":this.getView().bindFieldHelpText();break;case"none":break}}if(this.getView().isFloatLabelAlignment()&&(E!=FieldType.CHECK_BOXES||(E==FieldType.CHECK_BOXES&&A.isLookup()))&&this.isFieldSupportedInInplace(E)){if(A.getDefaultValue()!=""&&A.getDefaultValue()!=undefined&&E!=FieldType.PHONE_NUMBER){this.getView().adjustLabelWidth(E,true)}else{this.getView().adjustLabelWidth(E,false)}}return this};this.getFormController=function(){return B};this.fillValue=function(D){D[A.getActualLabelName()]=this.getValue()};this.getValue=function(){return this.getView().getValue()};this.showError=function(D){if(A.getDescType()==2&&!A.isSubformField()){this.getView().hideHelpText()}this.getView().showError(D)};this.clearError=function(){if(A.getDescType()==2&&!A.isSubformField()){this.getView().showHelpText()}this.getView().clearError()};this.focus=function(){this.getView().focus()};this.validate=function(){try{this.validator.validate(this)}catch(D){D.handle()}};this.getLabelName=function(){return A.getLabelName()};this.getEmptyRowKey=function(){return".t::row_0."};this.destroy=function(){this.getView().destroy()};this.showLoader=function(){this.getView().showLoader()};this.hideLoader=function(){this.getView().hideLoader()};this.showInPage=function(){this.getView().showInPage()};this.hideInPage=function(){this.getView().hideInPage()};this.hideField=function(){this.getView().hideField(A.getClassName());A.setVisible(false);if(!A.isSubformField()){C.resizeInPage()}};this.showField=function(){this.getView().showField(A.getClassName());A.setVisible(true);if(!A.isSubformField()){C.resizeInPage()}};this.isVisible=function(D){return A.isVisible(D)};this.disableField=function(){if(ZCGlobal.isMobileLayout){this.getView().getDOM().getFieldParentGroup().addClass("zc-fld-disabled")}this.getView().disableField();A.setReadOnly(true)};this.enableField=function(){if(ZCGlobal.isMobileLayout){this.getView().getDOM().getFieldParentGroup().removeClass("zc-fld-disabled")}this.getView().enableField();A.setReadOnly(false)};this.isAccessible=function(D){return !A.isReadOnly(D)};this.hideShowField=function(D){if(D){this.getView().showField()}else{this.getView().hideField()}A.setVisiblity(D)};this.clear=function(){this.getView().setValue("")};this.setFieldValue=function(E,D){var F=this.getValue();this.setValue(E,true);if(A.isFormulaExist()&&F!=E){this.getView().trigger("triggerformula")}if(A.isOnChangeExist()&&(!A.isSubformField()||A.isAddedToParent)){if(!(A.getComponentType()==FieldType.EXTERNAL_FIELD&&D!=undefined&&D!=""&&D.compType==FieldType.EXTERNAL_LINK_FIELD)){this.getView().trigger("onuserinput")}A.isAddedToParent=false}};this.setValue=function(F,D){this.getView().setValue(F);if(A.isCompositeSubField()){var G=this.getParentField();var E=G.getModel();if(A.isAddressSubField()){G.subFieldsGroupHandler(A.getGMAPKEY(),D)}else{if(E.isOnChangeExist()&&D){G.getView().trigger("onuserinput")}}}};this.reset=function(){this.setValue(A.getDefaultValue())};this.getField=function(){return this.getView().getField()};this.getParentField=function(){var D=A.isSubformField()?C.getFormController():C;if(A.isCompositeSubField()&&A.getGroupParentField()!=undefined){return A.isSubformField()?C.getModel().getSubformField(A.getRowID(),A.getGroupParentField()):D.getFieldController(A.getGroupParentField())}};this.isFieldSupportedInInplace=function(D){var E=[FieldType.NAME,FieldType.ADDRESS,FieldType.DECISIONBOX,FieldType.PLAIN_TEXT,FieldType.RICH_TEXT_AREA,FieldType.SECTION,FieldType.SIGNATURE,FieldType.SUB_FORM_GRID,FieldType.INLINE_RADIO];return(E.indexOf(D)==-1)}});createPrototype(FieldController,ControllerFactory.prototype,new BasicValidator());var CurrencyController=(function(A,B){FieldController.call(this,A,B);this.getValue=function(){var D=this.getView().getValue();var C=A.getValueFormat();if(!isNull(D)&&C!==FormatConstants.DEFAULTFORMAT){return D.replace(new RegExp("\\"+FormatSeparators[C][0],"g"),"").replace(new RegExp("\\"+FormatSeparators[C][1],"g"),".")}return D}});createPrototype(CurrencyController,FieldController.prototype,new BasicValidator());var URLController=(function(B,C){FieldController.call(this,B,C);var D=this.getView(),A=B.getActualLabelName();this.init=function(){var E=B.getData();D=this.getView();D.setURLVal(E.urlSRC);D.setLinkVal(E.urlLinkName);D.setTitleVal(E.urlTitle)};this.getValue=function(){var E={};E[A]="";E["zcurl-"+A]=D.getURLVal();E["zctarg-"+A]=B.getURLTarget();if(B.isLinkNameReq()){E["zclnkname-"+A]=D.getLinkVal()}if(B.isTitleReq()){E["zctitle-"+A]=D.getTitleVal()}return JSON.stringify(E)};this.setValue=function(F){var E=parseAttr(B.getComponentType(),F);D.setURLVal(E.zcurl);D.setLinkVal(E.zclnkname);D.setTitleVal(E.zctitle);B.setURLTarget(E.target);D.fieldEvents()};this.reset=function(){D.reset()}});createPrototype(URLController,FieldController.prototype,new BasicValidator());var ImageController=(function(B,F){FieldController.call(this,B,F);var G=this.getView(),A=B.getActualLabelName();var E={};var D=B.getImageType(),C=B.getImageSelectedType();this.init=function(){var H=B.getData();G=this.getView();(H.imgLink)?G.setLinkVal(H.imgLink):G.getDOM().getLinkComp().parent().addClass("hide");(H.imgTitle)?G.setTitleVal(H.imgTitle):G.getDOM().getTitleComp().parent().addClass("hide");if(H.imgSRC&&C===1||C===3||(C===2&&D==Constants.LINK)){G.setSourceVal(H.imgSRC)}if(D==Constants.LINK||D==Constants.LINKANDCAMERA||C==3){G.getDOM().getSourceCompDiv().show();G.getDOM().getFileInput().hide()}};this.regImageEvent=function(){if(D!=Constants.LINK&&D<=Constants.IMAGEALLOPTION){var J=B.isSubformField()?B.getFormModel().getLabelName():undefined;var L=this.getURL().getUploadURL();var M=this.getURL().getDeleteFileURL();var I=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();var K={};K.data={subform:J};if(!LIB._isNull(I.getViewLinkName())){K.data.viewLinkName=I.getViewLinkName()}K.data.formAccessType=I.getAccessType();if(I.getAccessType()==5){var H=this.getChildRelation();K.data=$.extend(K.data,H)}if(I.hasPrivateLink()&&!isNull(I.getPrivateLink())){L=L+"/"+I.getPrivateLink();M=M+"/"+I.getPrivateLink()}K.name=B.getLabelName();K.url=L;K.deleteUrl=M;K.data[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;K.dimension=this.getView().getDOM().getFileInputEl().attr("dimension");if(!LIB._isNull(B.getDefaultValue())&&B.isLocalImgSRC()){K.defaultVal=B.getImageSRC()}E=Object.create(MediaPopup);E.setOpts(K);K.isDefaultValuePreseent=false;if(B.getDefaultValue()!=""&&B.getDefaultValue()!=undefined){K.isDefaultValuePreseent=true}G.createUpload(K)}if(D==Constants.LINKANDLOCAL||D==Constants.LOCALANDCAMERA||D==Constants.IMAGEALLOPTION){G.createTab(B.isLocalImgSRC()||LIB._isNull((B.getImageSRC()!=undefined?B.getImageSRC().trim():B.getImageSRC())))}if(G.isFloatLabelAlignment()){G.bindFocus()}};this.getImageObj=function(){return E};this.getValue=function(){var I={};if(D==Constants.LINK){G.setSelectedType(1)}else{G.setSelectedType(E.getSelectedType())}var H=(D==Constants.LOCAL||(D==Constants.LINKANDLOCAL&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.CAMERA&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.CAMERAANDLOCAL&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.LINKANDCAMERA&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.IMAGEALLOPTION&&G.getSelectedType()==Constants.LOCAL));I[A]="";I["zcsource-"+A]=G.getSourceVal(H&&G.getSelectedType()!=3);I["zcimagetype-"+A]=(H&&G.getSelectedType()!=3)?"2":"1";I.addToStore=G.addToStore();I["zctarget-"+A]=B.getImageTarget();if(B.isLinkReq()){I["zcfieldlink-"+A]=G.getLinkVal()}if(B.isTitleReq()){I["zctitle-"+A]=G.getTitleVal()}if(B.isAltReq()){I["zcalttext-"+A]=G.getAltVal()}return JSON.stringify(I)};this.setValue=function(I){if(I==""){G.clearValue();return }var H=parseAttr(B.getComponentType(),I);G.setSourceVal(H.zcsource);G.setLinkVal(H.zcfieldlink);G.setTitleVal(H.zctitle);G.setAltVal(H.zcalttext);B.setImageTarget(H.target);G.showLink();if(B.getImageType()==1){G.fieldEvents()}};this.reset=function(){G.reset()};this.clear=function(){this.getView().setValue("");$((this.getView().getFieldContainer())[0].querySelectorAll(".filename")).html("")};this.getChildRelation=function(){var H=F.getChildRelation();H["zc_childlabelname_"+H.zc_lookupCount]=B.getActualLabelName();H.isFromSubForm=B.isSubformField();H.childFieldLabelName=B.getActualLabelName();if(H.isFromSubForm==false){H.isNewTypeSubform=false}return H}});createPrototype(ImageController,FieldController.prototype,new BasicValidator());var FileUploadController=(function(A,B){FieldController.call(this,A,B);this.regFileUploadEvent=function(){var C=A.isOneFileUpload(),I=this.getView(),K=this;var L=A.isSubformField()?A.getFormModel().getLabelName():undefined;var F=true;var D=this.getURL().getUploadURL();var H=this.getURL().getDeleteFileURL();var J=A.isSubformField()?A.getFormModel().getFormModel():A.getFormModel();var E={};E.data={subform:L};if(!LIB._isNull(J.getViewLinkName())){E.data.viewLinkName=J.getViewLinkName()}E.data.formAccessType=J.getAccessType();if(J.getAccessType()==5){var G=this.getChildRelation();E.data=$.extend(E.data,G)}if(J.hasPrivateLink()&&!isNull(J.getPrivateLink())){D=D+"/"+J.getPrivateLink();H=H+"/"+J.getPrivateLink()}E.name=A.getActualLabelName();E.url=D;E.deleteUrl=H;E.isCloud=!C;E.data[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;if(A.getDefaultValue()){E.defaultVal=A.getDefaultValue()}if(F){E.services=A.getCloudService()}E.isDefaultValuePreseent=false;if(A.getDefaultValue()!=""&&A.getDefaultValue()!=undefined){E.isDefaultValuePreseent=true}I.createUpload(E);if(I.isFloatLabelAlignment()){I.bindFocus()}};this.isPickerRestricted=function(){return A.isPickerRestricted()};this.getValue=function(){var C={};C[A.getActualLabelName()]=this.getView().getValue();C.addToStore=this.getView().addToStore();return JSON.stringify(C)};this.clear=function(){this.getView().setValue("");$((this.getView().getFieldContainer())[0].querySelectorAll(".filename")).html("")};this.getChildRelation=function(){var C=B.getChildRelation();C["zc_childlabelname_"+C.zc_lookupCount]=A.getActualLabelName();C.isFromSubForm=A.isSubformField();C.childFieldLabelName=A.getActualLabelName();if(C.isFromSubForm==false){C.isNewTypeSubform=false}return C}});createPrototype(FileUploadController,FieldController.prototype,new BasicValidator());var MediaController=(function(A,D){FieldController.call(this,A,D);var C={},B={};this.regFileUploadEvent=function(){_view=this.getView(),_self=this;var F=A.isSubformField()?A.getFormModel().getLabelName():undefined;var H=this.getURL().getUploadURL();var I=this.getURL().getDeleteFileURL();var E=A.isSubformField()?A.getFormModel().getFormModel():A.getFormModel();if(E.hasPrivateLink()&&!isNull(E.getPrivateLink())){H=H+"/"+E.getPrivateLink();I=I+"/"+E.getPrivateLink()}var G={};G.name=A.getActualLabelName();G.url=H;G.deleteUrl=I;G.data={subform:F};G.data[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;G.data.formAccessType=E.getAccessType();if(!LIB._isNull(E.getViewLinkName())){G.data.viewLinkName=E.getViewLinkName()}if(A.getDefaultValue()){G.defaultVal=A.getDefaultValue()}G.fieldType=A.getComponentType();if(A.getComponentType()==137){C=Object.create(MediaPopup);C.setOpts(G)}else{if(A.getComponentType()==138){B=Object.create(MediaPopup);B.setOpts(G)}}G.isDefaultValuePreseent=false;if(A.getDefaultValue()!=""&&A.getDefaultValue()!=undefined){G.isDefaultValuePreseent=true}_view.createUpload(G)};this.getMediaPopup=function(){if(A.getComponentType()==137){return C}else{if(A.getComponentType()==138){return B}}return null};this.getValue=function(){var E={};E[A.getActualLabelName()]=this.getView().getValue();E.addToStore=this.getView().addToStore();return JSON.stringify(E)}});createPrototype(MediaController,FieldController.prototype,new BasicValidator());var SelectController=(function(C,H){FieldController.call(this,C,H);var E=this.getURL(),A=this,D,F,B;this.createSelect=function(){var V=this;var M=C;var O=false;var Q=[],S,R,T,L,W,K,X,J;var I={more:false,results:M.getChoices(""),cache:true};function N(Z){try{return Z.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}catch(Y){return Z}}function P(a,d,e){var c=a.filter(function(h){if(h.text!=undefined&&h.UserName!=undefined){h.text=h.UserName+" ("+h.EmailID+")"}return((d==""||N(h.text.toUpperCase()).indexOf(N(d.toUpperCase()))>=0)&&h.text!="")});if(C.isFromReport()&&C.getFieldType()==FieldType.EXTERNAL_FIELD){K=D.select2("data");if(K.length!=0){K.filter(function(h){c=c.filter(function(m){return(m.text!=h.text)})})}}if(!C.isLookup()&&C.isOtherEnabled()){c.push({id:Constants.OTHER_OPTION,text:i18n.otheroption})}if(d==""){if(M.isFromReport()==undefined){V.toggleSearchBox(c)}}if(C.isFromReport()&&C.getFieldType()==FieldType.MULTI_SELECT&&C.getTotalRecordsCount()<V.recordsLimit){K=D.select2("data");if(K.length!=0&&d!=""){var b=K[K.length-1];var Y=true,Z;$.each(c,function(h,m){R=m.id;T=m.text;Z="";Y=true;if(R!=b.id){var n=[];if(b.id instanceof Object){$.each(b.id,function(o,p){p=p.substring(1,p.length);if(p==T||!C.isPredefinedChoices(p)){Y=false}n.push("#"+p)})}else{if(!C.isPredefinedChoices(b.id)){Y=false}n.push("#"+b.text)}n.push("#"+T);if(n.length<=3&&Y){J={id:n,text:b.text+" & "+T};c.push(J)}}})}}return{more:e,results:c}}if(M.isExternalField()&&M.getModuleType()!=18){O=true}F={placeholder:(!(this.getView().isFloatLabelAlignment())||C.isSubformField())?i18n.dropdownselect:" ",allowClear:true,dropdownCssClass:C.getActualLabelName()+"-switch-search",data:M.getChoices(""),separator:"@#zoho-comma#@",createSearchChoice:function(Y){if(C.isFromReport()&&$.trim(Y)!=""){return{id:$.trim(Y),text:$.trim(Y)}}else{return }},query:function(q){var s=this;var a=E.getRelDataURL();var h=false;var m=false;if((q.page==undefined&&q.term==undefined)||!M.isRequestCompleted()){q.callback(I);--s.element.data().select2.queryCount;return }var d=M.getCacheTerm(q.term),Y=(M.isSaturated(""))?M.getChoices(""):M.getChoices(d),p=q.page;var c=(M.isSaturated(""))?false:!M.isSaturated(d);if(C.isSubformField()){C.getFormModel().getFormModel().setTriggeredControllerType("fieldController")}else{C.getFormModel().setTriggeredControllerType("fieldController")}if(!m&&M.isLookup()){var Z,b;Z=q.ZCTriggerAjax;b=q.dataPresent;if(!b&&Y.length>0){b=true;jQuery.each(Y,function(u,v){if(v.text){b=false;return false}})}m=(Z||b)}if(M.isExternalField()&&q.term.length==1){h=true}if((((Y.length>0&&p<=M.getCurrentPage(d))||!c)&&!m)||h){if(q.term!=""){F.isFirstValue=true}var o=P(Y,q.term,c);o.cache=true;I=o;q.callback(o);return }else{var e={};if(!M.isExternalField()&&!M.isIntegrationField()){e=H.collectData()}e.searchVal=d;if(M.isIntegrationField()){e.noOfRecsInCache=!M.getIntegRecCount()?0:M.getIntegRecCount();if(d!=""){e.noOfRecsInCache=M.getChoices(d).length;$(s.element.data().select2.search).addClass("select2-active")}}else{e.noOfRecsInCache=Y.length}if(M.isSubformField()){e.subformName=M.getFormModel().getLabelName();e.rowseqid=M.getRowID()}if(M.isExternalField()){e.serviceType=M.getServiceType();e.moduleType=M.getModuleType()}var n=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();e.formAccessType=n.getAccessType();if(V.getChildRelation()!=""){e=$.extend(e,V.getChildRelation())}if(n.hasPrivateLink()&&!isNull(n.getPrivateLink())){e.privatelink=n.getPrivateLink()}M.sendingReq();delete e.updateIdList;$.ajax({url:"",method:"POST",data:e,beforeSend:function(){this.url=a},success:function(w){var v=null;if(M.isIntegrationField()){var x=M.getIntegRecCount()?M.getIntegRecCount()+w.count:w.count;M.setIntegRecCount(x);if(d!=""){$(s.element.data().select2.search).removeClass("select2-active")}}var u=M.getChoices(d).length;M.addChoices(d,p,w,true);if(e.searchVal!=""){F.isFirstValue=(u==0)?true:false;w.data=C.getChoices(d);$((D.data("select2").dropdown)[0].querySelector("ul")).empty()}v=P(w.data,$(s.element.data().select2.search).val(),!w.isSaturated);v.ajax=true;I=v;M.reqCompleted();var y=e.searchVal==""?($(s.element.data().select2.search).val()!=""?true:false):true;if(M.isLookup()&&!w.isSaturated&&y&&e.searchVal!=$(s.element.data().select2.search).val()){q.ZCTriggerAjax=true;q.term=$(s.element.data().select2.search).val();s.query(q)}else{if(v.results.length==0&&!w.isSaturated){q.dataPresent=true;s.query(q)}else{q.callback(v)}}}})}}};if(!M.isExternalField()&&M.getChoiceCount()<=10){this.getView().getDOM().getSearchBoxContainer().addClass("select2-search-hidden select2-offscreen")}if(O){F.formatNoMatches=function(Y){if(Y.length==1){return i18n.mincharacter}else{return i18n.nomatchfound}}}if(C.getComponentType()==FieldType.LIST||C.getComponentType()==FieldType.CHECK_BOXES||C.isFromReport()==true||(C.getComponentType()==FieldType.SYSTEM_LOOKUP&&C.getSystemDisplayType()==FieldType.USER_MULTI_SELECT)){F.multiple=true;F.closeOnSelect=false}if(C.isFromReport()==true){F.createSearchChoicePosition="bottom";F.openOnEnter=false}if(C.getComponentType()==FieldType.POPUP_SINGLE&&!C.isIntegrationField()){F.formatResult=function(Z){var Y='<div class="crm-user" id="'+Z.id+'"><p class="crm-text">'+Z.text+"</p></div>";if(Z.UserName!=undefined&&Z.EmailID!=undefined){Y='<div class="crm-user" id="'+Z.id+'"><p class="crm-user-name">'+Z.UserName+'</p><p class="crm-user-email">'+Z.EmailID+"</p></div>"}return Y};F.formatSelection=function(Y){if(Y.UserName!=undefined&&Y.EmailID!=undefined){return Y[C.getDisplayField()]}else{return Y.text}}}if(((C.getComponentType()==FieldType.RADIO||C.getComponentType()==FieldType.CHECK_BOXES)&&!C.isSubformField())&&(!C.isLookup()||!C.isSearchEnabled())||(C.getComponentType()==FieldType.INLINE_RADIO&&!C.isSubformField())){if(!C.isExternalField()){return }}if(C.isFromReport()){D=this.getView().intitateSelect(F,H.getReportViewInstance())}else{D=this.getView().intitateSelect(F)}if(M.isFromReport()){D.on("select2-focus",function(){var Y=V.getView().getDOM().getField();$(".zc-active-search-block").removeClass("zc-active-search-block");$(Y).parents("li").addClass("zc-active-search-block")})}if(C.hasAddToParent()){var U=$("<div>",{id:"addNew","class":"addnewparent",text:C.getAddToParentText()});U.prepend("<i class='fa fa-plus'></i>");U.click(function(){V.addNewParent(D)});$((D.data("select2").dropdown)[0].querySelector("ul")).after(U)}D.select2("zcData",C.getDefaultValue());if(isMobileBrowser()){D.on("select2-open",function(){$(".select2-search:visible input").prop("focus",false).prop("autofocus",false).blur()})}};this.setValue=function(O,I){var L=O;O=C.decodeChoices(O);if(L instanceof Array){L=[];var M=0;for(var J in O){if(O!=undefined&&C.hasChoice(O[J].id)){L[M++]=O[J]}}}if(L!=undefined&&((L.length>0)||C.hasChoice(L.id)||((C.isExternalField()||C.isIntegrationField())&&L.id))){if(C.isExternalField()&&L!=""&&L.id==-1){L.id=null}this.getView().setValue(L)}else{if(!C.isOtherEnabled()){this.getView().setValue("")}}if(C.isOtherEnabled()){if(L!=undefined&&L.id&&!C.hasChoice(L.id)){this.getView().setValue({id:Constants.OTHER_OPTION,text:i18n.otheroption});$((this.getField().parent())[0].querySelector('div[elname="othersinput"]')).show();var N=this.getView().getDOM();N.getOtherValueField().val(O.text)}else{if(L==""){this.clearSelectedValues();$((this.getField().parent())[0].querySelector('div[elname="othersinput"]')).hide()}else{$((this.getField().parent())[0].querySelector('div[elname="othersinput"]')).hide()}}}if(C.isCompositeSubField()){var P=this.getParentField();var K=P.getModel();if(C.isAddressSubField()){P.subFieldsGroupHandler(C.getGMAPKEY(),I)}else{if(K.isOnChangeExist()&&I){P.getView().trigger("onuserinput")}}}};this.toggleSearchBox=function(I){if(!C.isExternalField()){if(I!=undefined&&I.length<=10){this.getView().getDOM().getSearchBoxContainer().addClass("select2-search-hidden select2-offscreen")}else{this.getView().getDOM().getSearchBoxContainer().removeClass("select2-search-hidden select2-offscreen")}}};if(C.isExternalField()||C.isIntegrationField()){this.getValue=function(){if(C.isIntegrationField()){I=C.getIntegrationFieldValue()}else{if(C.getModuleType()!=18){I=this.getSelectedChoice()}else{var K=this.getView().getValue(),J=C.getChoices(""),I;if(J.length>0){I=J.filter(function(L){return L.id==K});I=(I!=undefined)?I[0]:{}}else{if(C.getDefaultValue()!=undefined){I=C.getDefaultValue()}else{if(K!=undefined){I=this.getSelectedChoice()}}}}}I=(I!=undefined)?I:{};return JSON.stringify(I)}}this.getChildRelation=function(){var I=H.getChildRelation();I["zc_childlabelname_"+I.zc_lookupCount]=C.getActualLabelName();I.isFromSubForm=C.isSubformField();I.childFieldLabelName=C.getActualLabelName();I.lookupFieldName=C.getRefFieldLabel();if(I.isFromSubForm==false){I.isNewTypeSubform=false}return I};this.resetLoadLookup=function(){C.resetLoadLookup()};this.addValue=function(I){C.addChoice("",I,1)};this.addNewParent=function(J){var P,L,O;var I=this;if(C.isLookupAddRestricted()){$.alert({msg:i18n.lookupaddrestriction});if(C.isSelectField()){D.select2("close")}return }LIB._startLoading();if(!C.isSelectField()){C.isAddedToParent=true}var K=E.getRelatedForm();var N=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();if(N.hasPrivateLink()&&!isNull(N.getPrivateLink())){K=K+"&privatelink="+N.getPrivateLink()}$.zcAjax({beforeSend:function(){LIB._startLoading()},url:K,data:I.getChildRelation(),type:"GET",success:function(R,Q,S){M(R);LIB._stopLoading();if(C.isSelectField()){J.select2("close")}},error:function(Q){M(Q);LIB._stopLoading();if(C.isSelectField()){J.select2("close")}}});function M(Q){$.zcmodal({type:Constants.JIT_MODAL,bodyClass:"popup-form",wrapperClass:"zc-mob-fullscreen",buildDOM:function(){return Q.HTML?Q.HTML:Q},beforeShow:function(){if(Q.MODEL!=undefined){Controller.FormController.create({model:Q.MODEL,type:FormControllerType.LOOKUPFORM,childField:I,data:Q.RECORD,dynamicMeta:Q.DYNAMIC_META})}},afterClose:function(){I.focus()}})}};this.clear=function(){C.clearChoices();this.setValue("");this.clearSelectedValues()};this.clearSelectedValues=function(){this.getView().setValue("");if(C.isOtherEnabled()){var I=this.getView().getDOM();I.getOtherValueField().val("")}A.dynamicUpdateSelect2Choices()};this.appendValue=function(I){C.appendChoices(I);A.dynamicUpdateSelect2Choices()};this.deselectValue=function(I){var K=D.select2("data");var J;if(Array.isArray(K)){J=K.filter(function(L){var M=I.filter(function(N){return(N.id==L.id)});return(M.length==0)})}else{if(K!=null){J=K;if(I[0].id==K.id){J=[]}}}this.setValue(J)};this.selectAll=function(){this.setValue(C.getChoices(""))};this.deselectAll=function(){this.setValue("")};this.getSelectedChoice=function(){return this.getView().getSelectedChoice()};this.dynamicUpdateSelect2Choices=function(){var J=this.getView().getDOM();var I=$(J.getField()).parent().find(".select2-container-active");if(I!=undefined&&I.hasClass("select2-dropdown-open")){$(J.getField()).select2("close");$(J.getField()).select2("open")}};this.validateSelectedValues=function(L,M){if(L instanceof Array){var K=[];for(var J=0,I=L.length;J<I;++J){if(G(L[J],M)){K.push(L[J])}}return K}else{return G(L,M)?L:""}};function G(K,L){for(var J=0,I=L.length;J<I;++J){if(L[J].id===K.id){return true}}return false}});createPrototype(SelectController,FieldController.prototype);var SingleSelectController=(function(A,B){SelectController.call(this,A,B);this.init=function(){if(!A.isLookup()&&!A.isExternalField()&&!A.getGMAPKEY()){this.validateAndFillSelectedValues()}};this.validateAndFillSelectedValues=function(){var H=A.getChoices("");var G=A.getData().FIELDVALUE;var F=this.validateSelectedValues(G,H);var C=B.getModel().getAccessType();if(G!==F){if(A.isOtherEnabled()){this.getView().getDOM().getOtherValueContainer().show(400);var E=decode(undefined,G.text);$(this.getView().getDOM().getOtherValueContainer().find("input")).val(E);F={id:Constants.OTHER_OPTION,text:i18n.otheroption}}else{if(C===FormAccessType.VIEW_EDIT_RECORD||C===FormAccessType.SEARCH_FORM){var D=$.extend(true,[],[G]);this.appendValue(D);F=G}}}A.setDefaultValue(F)}});createPrototype(SingleSelectController,SelectController.prototype,new BasicValidator());var DropdownController=(function(A,B){SingleSelectController.call(this,A,B)});createPrototype(DropdownController,SingleSelectController.prototype,new BasicValidator());var RadioController=(function(B,D){SingleSelectController.call(this,B,D);var C=this.getURL(),A=this;if(!B.isSelectField()){_superinit=this.init;this.init=function(){_superinit.call(this);if(B.isLiveVariableCriteriaLookup()||B.isDynamicLookup()){var E=B.getChoices("");this.appendValue(E);this.validateAndFillSelectedValues()}if(B.getDefaultValue()!==undefined&&B.getDefaultValue()!==""){this.getView().setValue(B.getDefaultValue())}};this.clear=function(){B.clearChoices();this.getView().clearChoices()};this.appendValue=function(E){B.appendChoices(E);this.getView().appendChoices(E)}}this.addValue=function(F){var E=[];E.push(F);B.appendChoices(E);this.getView().appendChoices(E)};this.deselectValue=function(E){this.getView().deselect(E)}});createPrototype(RadioController,FieldController.prototype,new BasicValidator());var MultiSelectController=(function(A,B){SelectController.call(this,A,B);this.init=function(){if(!A.isLookup()){this.validateAndFillSelectedValues()}};this.validateAndFillSelectedValues=function(){var H=A.getChoices("");var G=A.getData().FIELDVALUE;var F=this.validateSelectedValues(G,H);var C=B.getModel().getAccessType();if(F.length<G.length){if(C===FormAccessType.VIEW_EDIT_RECORD||C===FormAccessType.SEARCH_FORM){var E={};F.forEach(function(I){E[I.id]=true});var D=G.filter(function(I){return E[I.id]===undefined});D=$.extend(true,[],D);this.appendValue(D);F=G}}A.setDefaultValue(F)}});createPrototype(MultiSelectController,SelectController.prototype,new BasicValidator());var CheckBoxController=(function(B,E){MultiSelectController.call(this,B,E);var C=this.getURL(),A=this;if(!B.isSelectField()){var D=this.init;this.init=function(){D.call(this);if(B.isLiveVariableCriteriaLookup()||B.isDynamicLookup()){var F=B.getChoices("");this.appendValue(F);this.validateAndFillSelectedValues()}if(B.getDefaultValue()!==undefined&&B.getDefaultValue()!==""){this.getView().setValue(B.getDefaultValue())}};this.clear=function(){B.clearChoices();this.getView().clearChoices()};this.appendValue=function(F){B.appendChoices(F);this.getView().appendChoices(F)};this.selectAll=function(){this.setValue(B.getChoices(""))};this.deselectAll=function(){this.setValue("")};this.deselectValue=function(F){this.getView().deselect(F)}}this.addValue=function(G){var F=[];F.push(G);B.appendChoices(F);this.getView().appendChoices(F)}});createPrototype(CheckBoxController,MultiSelectController.prototype,new BasicValidator());var RichTextController=(function(A,B){FieldController.call(this,A,B);this.init=function(){this.getView().getDOM().getField().val(A.getDefaultValue())};this.createEditor=function(){var C=A.getToolbarConfig();C.content=A.getDefaultValue();editor=this.getView().createEditor(C)}});createPrototype(RichTextController,FieldController.prototype,new BasicValidator());var CompositeController=(function(A,B){FieldController.call(this,A,B);this.createSelect=function(C){this.getView().initiateSelect(C)};this.initiateCompositeField=function(){var D=this;var G=A.getFullCompositeFields();var F=[];for(var E in G){var I=G[E];I.GROUPPARENTFIELD=A.getActualLabelName();I.GROUPPARENTFIELDTYPE=A.getComponentType();I.ISSUBFORM=A.isSubformField()+"";I.ROWID=A.getRowID();var C=Controller.FieldController.create({model:I,formController:B,data:I.defaultData});I.CONTROLLER=C;if(I.GMAPKEY==="country"||I.GMAPKEY==="prefix"){D.createSelect(I.GMAPKEY)}if(!C.getModel().isCoordinateField()){A.setCompositeField(E,I)}else{A.setCoordinateField(E,I)}if(A.getComponentType()==FieldType.ADDRESS){var H=A.getParentFormModel().getParamFieldLabels();if(!isNull(H)&&H.indexOf(I.FIELDLABELNAME)!==-1){F.push(C.getModel().getGMAPKEY())}}}if(A.getComponentType()==FieldType.ADDRESS){this.getView().toggleAdjustLocationContent();if(A.isCaptureGeoCoordinates()){if(D.isGeocodeEligible(F)){D.geocodeAddress(false)}}else{if(D.hasMainFields(F)){this.getView().updateZMAPLocation("","",true)}}}};this.getValue=function(){var N=A.getCompositeFields(),C={};for(var M in N){var L=N[M],E=L.FIELDLABELNAME,J=L.ACTUALLABEL;if(L.GMAPKEY==="country"){var H=this.getView().getValue(E);var K=Constants.COUNTRY_MAP[H];K=(K!=undefined)?K:H;C[J]=K}else{C[J]=this.getView().getValue(E)}}var F=A.getDefaultValue();var G=A.isSubformField()?A.getFormModel().getFormModel():A.getFormModel();C.status=(F!=undefined&&F!="")?"edit":"add";if(G.getAccessType()==FormAccessType.BULK_EDIT||G.getAccessType()==FormAccessType.VIEW_EDIT_RECORD){C.status="edit"}C.recID=A.getRecID();if(A.getComponentType()==FieldType.ADDRESS){var I=this.getCompositeSubField(A.getActualLabelNameFromMapKey("latitude"));C.latitude=I.getValue();var D=this.getCompositeSubField(A.getActualLabelNameFromMapKey("longitude"));C.longitude=D.getValue()}return JSON.stringify(C)};this.setValue=function(F){if(typeof (F)=="object"){var E=A.getCompositeFields();for(i=0,l=E.length;i<l;i++){var D=E[i],C=D.ACTUALLABEL;if(F[C]!=undefined){this.getView().setValue(D.FIELDLABELNAME,F[C])}}}};this.reset=function(){var E=A.getCompositeFields();for(i=0,l=E.length;i<l;i++){var D=E[i],C=D.FIELDLABELNAME;if(D.FIELDTYPE==FieldType.INLINE_SINGLE_SELECT){this.getView().resetDropdown(C)}else{this.getView().setValue(C,"")}}};this.focus=function(){var C=A.getSubFieldLabelName(0);A.getCompositeFields()[C].CONTROLLER.focus()};this.getCompositeSubField=function(C){if(A.getFullCompositeFields()!=undefined&&A.getFullCompositeFields()[C]!=undefined){return A.getFullCompositeFields()[C].CONTROLLER}};this.init=function(){this.initiateCompositeField()}});createPrototype(CompositeController,FieldController.prototype,new BasicValidator());var NameController=(function(A,B){CompositeController.call(this,A,B)});createPrototype(NameController,CompositeController.prototype);var AddressController=(function(H,B){CompositeController.call(this,H,B);var J=this;var F=J.getModel().getParentFormModel();var C=null,E=null;var I=function(){F.incrementActiveAddressOps()};var G=function(){F.decrementActiveAddressOps()};this.isStreetFieldsOnly=function(){var M=["administrative_area_level_2","administrative_area_level_1","postal_code","country"];var L=H.getCompositeFields();for(var N in L){var K=L[N];if(M.indexOf(K.GMAPKEY)!==-1){return false}}return true};this.hasMainFields=function(O){var K=["route","locality","administrative_area_level_2","administrative_area_level_1","postal_code","country"];var N=false;var M=false;for(var L in O){if(K.indexOf(O[L])!==-1){N=true;break}}return N};this.isGeocodeEligible=function(L){var K=this.hasMainFields(L);if(K&&(L.indexOf("latitude")!==-1||L.indexOf("longitude")!==-1)){K=false}return K};this.showWarning=function(K){if(H.isAdjustLocation()){if(!this.isSubFieldsEmpty()){this.getView().showWarning(K)}var L=H.isSubformField()?B.getFormController():B;L.cancelSubmitForm()}};this.clearWarning=function(){this.getView().clearWarning()};this.showGeocodeLoader=function(){if(H.isAdjustLocation()){this.getView().showGeocodeLoader()}else{this.showLoader()}};this.hideGeocodeLoader=function(){if(H.isAdjustLocation()){this.getView().hideGeocodeLoader()}else{this.hideLoader()}};var A=[];this.subFieldsGroupHandler=function(L,K){I();if(C){clearTimeout(C);G()}A.push(L);C=setTimeout(function(){J.getView().toggleAdjustLocationContent();J.clearWarning();if(H.isCaptureGeoCoordinates()&&J.isGeocodeEligible(A)){J.geocodeAddress(K)}else{if(H.isCaptureGeoCoordinates()){J.clearGeocodeRequest();if(H.isOnChangeExist()&&K){J.getView().trigger("onuserinput")}}else{if(J.isGeocodeEligible(A)){J.getView().updateZMAPLocation("","",K)}else{if(H.isOnChangeExist()&&K){J.getView().trigger("onuserinput")}}}}A=[];G();C=null},0)};this.getGeocodeQuery=function(){var X=H.getCompositeFields();var L=["api_key="+Constants.ZMAPS_APIKEY,"filter=3"];var P={};P.limit=1;var N={};var U="",R="";for(var W in X){var V=X[W],O=V.FIELDLABELNAME,T=V.ACTUALLABEL;var K=this.getView().getValue(O);switch(V.GMAPKEY){case"route":U=K;break;case"locality":R=K;break;case"administrative_area_level_2":if(!isNull(K)){N.city=K}break;case"administrative_area_level_1":if(!isNull(K)){N.state=K}break;case"postal_code":if(!isNull(K)){N.postalcode=K}break;case"country":if(!isNull(K)){var S=Constants.COUNTRY_MAP[K.toLowerCase()];var Q=Constants.INVERTED_COUNTRY_MAP[K.toLowerCase()];if(!isNull(S)||!isNull(Q)){N.country=!isNull(S)?S:K}}break}}if(U!=""||R!=""){var M=[];if(U!=""){M.push(U)}if(R!=""){M.push(R)}N.street=M.join(", ")}if(this.isStreetFieldsOnly()){P.q=N.street;L.push("params="+encodeURI(JSON.stringify(P)))}else{P=N;L.push("params="+encodeURI(JSON.stringify(P)));L.push("alevel=10")}return Constants.ZMAPS_DOMAIN+"/v1/query/geocode?"+L.join("&")};this.clearGeocodeRequest=function(){if(D&&D.readyState!=4){D.abort();D=null;G()}if(E){clearTimeout(E);E=null;G()}};var D;this.geocodeAddress=function(K){A=[];I();if(D&&D.readyState!=4){D.abort();D=null;G()}var L=this.getGeocodeQuery();if(!this.isSubFieldsEmpty()){J.showGeocodeLoader();if(H.isAdjustLocation()){J.getView().disableAdjustLocation()}if(E){G();clearTimeout(E)}E=setTimeout(function(){E=null;J.clearWarning();D=$.ajax({url:L,type:"GET",success:function(M){var P="",Q="";if(M.length>0){var O=M[0];P=O.lat;Q=O.lon}else{var N=i18n.mapservicelocationnotfound;J.showWarning(N)}J.getView().updateZMAPLocation(P,Q,K);J.hideGeocodeLoader();G()},error:function(M){J.hideGeocodeLoader();if(M.statusText!="abort"){$.alert({msg:i18n["zc.general.errorMessage"]})}}})},100)}else{J.getView().updateZMAPLocation("","",K);G()}};this.isSubFieldsEmpty=function(){var L=Object.keys(H.getCompositeFields());var K=JSON.parse(this.getValue());return L.reduce(function(N,M){return N&&isNull(K[M])},true)}});createPrototype(AddressController,CompositeController.prototype);var SubformController=(function(L,D){FieldController.call(this,L,D);var I=this,E=L.getDefaultRow(),J=L.getMaxRows(),C=L.getCurrRows(),H,K=C+1,G=this.getView();var M,B,F=0;var N="t::row_0";this.setCurrRow=function(O,Q,P){H=O;M=Q;B=P};this.hasCurrentRow=function(){return(H!=undefined&&M!=undefined)};this.getNextSeqNo=function(){return K};this.isReadOnly=function(){return L.isReadOnly()};this.createDefaultRow=function(){if(Object.keys(L.getAllFields()).length==0&&L.getNullRowFields().length==0){return }var S=L.getAllFields(),T=Object.keys(S),Q=T.length;for(key in S){I.setCurrRow(key,S[key].FIELDS,S[key].DATA);var U=G.getRow(key);this.bindRow(U,F===0,true);F++}for(var R=C;R<E;R++){var P=L.getNullRowFields(),O=L.getNullRowData();I.setCurrRow("t::row_"+K,P,O);L.addNewFields(H,P,K,O);var U=G.getRow(H);this.bindRow(U,F===0,true);I.setCurrRow(undefined,undefined,undefined);K++;F++}if(F==0){G.createVoidRow();if(this.isReadOnly()){this.hideAddLink();this.hideDeleteLink()}}else{G.hidePlaceHolder()}this.bindRowAction()};this.bindSortable=function(){var O={placeholder:"dragHover",start:function(P,Q){var S=Q.item.attr("rowno"),R=L.getFirstRow()},update:function(P,Q){var T=Q.item.attr("rowno"),S=L.getFirstRow();var R=L.getRow(T);I.getView().reorderSubform(Q.item,L.renameRow)}};this.getView().bindSortable(O)};this.focus=function(Q,R){R=(R!=undefined)?R:L.getFirstFieldName();Q=(Q!=undefined)?Q:L.getFirstRow();var P=L.getSubformField(Q,R);var O=L.getFormModel().focusFirstField();if(P!=undefined&&!(P instanceof Array)&&O){P.focus()}};this.showError=function(O,P,R){if(P!=undefined&&R!=undefined){var Q=L.getSubformField(P,R);if(Q!=undefined){Q.showError(O)}}else{this.getView().showError(O)}};this.clearError=function(){var Q=L.getAllFields(),R=Object.keys(Q),O=R.length,T={};for(key in Q){var S=Q[key].FIELDS,P={};for(rowNo in S){S[rowNo].CONTROLLER.clearError()}}this.getView().clearError()};this.getValue=function(){var W=L.getAllFields(),T=Object.keys(W),Q=T.length,O={};var S=L.getSubformType()==Constants.POPUP_SUBFORM;for(key in W){var V=W[key].FIELDS,R={};for(rowNo in V){var U=V[rowNo].CONTROLLER;var P=U.getModel().getComponentType();if(U!=undefined&&(!S||(P!=FieldType.PLAIN_TEXT&&P!=FieldType.SECTION))){R[U.getModel().getActualLabelName()]=U.getValue()}}R["record::status"]=W[key].STATUS;if(W[key].ID!=undefined){R.ID=W[key].ID+""}O[key]=R}return JSON.stringify(O)};this.reset=function(){var P=L.getAllFields(),Q=Object.keys(P),O=Q.length;for(key in P){var R=P[key].FIELDS;for(rowNo in R){R[rowNo].CONTROLLER.reset()}}};this.createRow=function(R){F++;if(!R||!this.hasCurrentRow()){var O=L.getNullRowFields();I.setCurrRow("t::row_"+K,O,L.getNullRowData());L.addNewFields(H,O,K,L.getNullRowData())}var T=L.getVoidRow(),Q=(F===1),S=H;T=T.replace(/t::row_0/g,H);var P=G.createNewRow(H,T,Q);this.bindRow(P,Q,R);if(!L.isDeleteLinkVisible()){G.hideDeleteLink()}D.resizeInPage();K++;return S};this.bindRow=function(U,O,S){G.setRow(U);var P=this.initiateController();this.bindPermissions(P);var R=D.getWorkflowController();if(!S){if(R!=undefined){R.bindOnUserInput(P,this,H);var W=this.getClientWorkflows();for(var V=0,T=W.length;V<T;V++){var Q=W[V];Q.rowNo=H;R.executeTask(Q)}}this.bindDeleteAction(this,H)}if(O){G.calibrateWidth(U)}G.clearRow();if(O){G.hidePlaceHolder()}I.setCurrRow(undefined,undefined,undefined);if(L.isFormulaExist()){this.getField().trigger("change")}};this.initRow=function(){};this.destroyController=function(O){for(i=0,l=O.length;i<l;i++){O[i].CONTROLLER.destroy()}};this.initiateController=function(){function V(a){var Y={};for(var Z in a){if(a.hasOwnProperty(Z)){Y[Z]=a[Z]}}return Y}var U=M;var R=[];for(var T=0,S=U.length;T<S;T++){var Q=U[T],P=L.getLabelName()+"."+H+"."+Q.ACTUALLABEL;Q.FIELDLABELNAME=P;Q.ROWID=H;if(Q.FIELDTYPE==FieldType.NAME||Q.FIELDTYPE==FieldType.ADDRESS){var O=Q.COMPOSITEFIELDS,X=[];for(j=0,len=O.length;j<len;j++){var W=V(O[j]);W.FIELDLABELNAME=P+"."+W.ACTUALLABEL;X.push(W)}Q.COMPOSITEFIELDS=X}cont=Controller.FieldController.create({model:Q,formController:this,data:B[Q.ACTUALLABEL]});Q.CONTROLLER=cont;R.push(cont)}return R};this.deleteRow=function(U,Q){F--;var T=L.isTopField(U),V=L.deleteFields(U);G.deleteRow(U,T);if(Q){G.deleteRow(N,L.isTopField(N))}if(V==0){G.createVoidRow();if(D.getWorkflowController()!=undefined){var S=this.getClientWorkflows();for(var R=0,P=S.length;R<P;R++){var O=S[R];this.executeWorkflow(O,true)}}}D.resizeInPage()};this.bindRowAction=function(){var O=this;$(O.getView().getAddLink()).click(function(){if(!O.getModel().hasMoreRows()){$.alert({msg:i18n.subformrowlimitreachedmsg});return false}O.getView().getField().removeClass("zcPlacehldflow zc-placeholder-overflow");O.createRow(false);var Q=D.getWorkflowController();if(Q!=undefined){Q.triggerRowAction(O)}});var P=O.getModel().getAvailableRows();for(rowInd in P){O.bindDeleteAction(O,P[rowInd])}};this.bindDeleteAction=function(P,O){$(P.getView().getDeleteLink(O)).click(function(R){var Q=D.getWorkflowController();if(Q!=undefined){Q.triggerDeleteAction(P,O)}P.deleteRow(O);R.preventDefault()})};this.hideAddLink=function(){this.getView().hideAddLink();L.setAddLinkVisiblity(false)};this.showAddLink=function(){this.getView().showAddLink();L.setAddLinkVisiblity(true)};this.isAddLinkVisible=function(){return L.isAddLinkVisible()};this.hideDeleteLink=function(){this.getView().hideDeleteLink();L.setDeleteLinkVisiblity(false);this.adjustWidth()};this.showDeleteLink=function(){this.getView().showDeleteLink();L.setDeleteLinkVisiblity(true);this.adjustWidth()};this.isDeleteLinkVisible=function(){return L.isDeleteLinkVisible()};this.collectData=function(){return D.collectData()};this.markActive=function(){D.markActive()};this.unmarkActive=function(){D.unmarkActive()};var A=[];this.getClientWorkflows=function(){return $.extend(true,[],A)};this.pushClientWorkflow=function(O){A.push(O);return $.extend(true,[],O)};this.executeWorkflow=function(O,Q){if(!(O.task==D.getWorkflowController().CONS.CLEAR||O.task==D.getWorkflowController().CONS.APPEND_VALUE)){if(!Q){O=this.pushClientWorkflow(O)}O=$.extend(true,{},O);var P=L.getAllFields();if(L.getCurrRows()==0){if(O.task==D.getWorkflowController().CONS.HIDE){$((this.getField())[0].querySelector("[name='"+this.getModel().getLabelName()+this.getEmptyRowKey()+O.fieldName+"']")).closest(".form-group").hide();setTimeout(function(){G.adjustWidth(N)},0)}else{if(O.task==D.getWorkflowController().CONS.SHOW){$((this.getField())[0].querySelector("[name='"+this.getModel().getLabelName()+this.getEmptyRowKey()+O.fieldName+"']")).closest(".form-group").show();setTimeout(function(){G.adjustWidth(N)},0)}}}for(key in P){O.rowNo=key;D.getWorkflowController().executeTask(O)}}};this.showField=function(){this.getView().showField(L.getClassName());L.setVisible(true);this.adjustWidth()};this.adjustWidth=function(){var O=L.getFirstRow();if(O!=undefined){G.adjustWidth(O)}else{G.adjustWidth(N)}};this.getChildRelation=function(){var P=D.getChildRelation();P.subFormAppName=L.getAppLinkName();P.childSubformField=L.getActualLabelName();P.isNewTypeSubform=L.isNewSubform();if(L.isNewSubform()){P["zc_childSubformlabelname_"+P.zc_lookupCount]=L.getActualLabelName();P.subFormLinkName=L.getFormLinkName()}else{P["zc_childformname_"+P.zc_lookupCount]=L.getRefFormLinkName();var O=L.getRefAppLinkName();if(O!=undefined&&O!=P.subFormAppName){P.subFormRefAppName=O;P.childAppIndex=P.zc_lookupCount}P.subFormLinkName=L.getRefFormLinkName()}return P};this.bindPermissions=function(T){var O=T,R=0,S=Object.keys(O),P=S.length;for(;R<P;++R){var Q=O[S[R]];if(this.isReadOnly()){Q.disableField()}}if(this.isReadOnly()){this.hideAddLink();this.hideDeleteLink()}};this.init=function(){if(Object.keys(L.getAllFields()).length==0&&Object.keys(L.getNullRowFields()).length===0){return }var O=document.createDocumentFragment();var R=Object.keys(L.getAllFields());var Q=L.getCurrRows(),U=L.getDefaultRow();var V=R.map(function(W){return P(W)});for(var T=Q;T<U;++T){V.push(P("t::row_"+(T+1)))}V.forEach(function(W){O.appendChild(W)});var S=G.getDOM().getInnerWrapper();S=S[0];S.appendChild(O);D.resizeInPage();function P(W){var Y=L.getVoidRow();Y=Y.replace(/t::row_0/g,W);var X=$(Y).attr("rowNo",W);return X[0]}}});createPrototype(SubformController,FieldController.prototype,new BasicValidator());var PhoneNumberController=(function(A,B){FieldController.call(this,A,B);this.init=function(){fieldDOM=this.getView().getDOM();fieldDOM.getField().val(A.getDefaultValue())}});createPrototype(PhoneNumberController,FieldController.prototype,new BasicValidator());var currentExtField;function CRMLookupCallBack(){if(currentExtField!=undefined){currentExtField.callBack();currentExtField=undefined}}function SDPODLookupCallBack(){if(currentExtField!=undefined){currentExtField.callBack();currentExtField=undefined}}var ExternalController=(function(A,B){FieldController.call(this,A,B);this.externalWindow=function(){var C=(document.location.protocol=="https:")?"https://":"http://";this.getView().openExternalWindow(C+A.getExternalURL());currentExtField=this};this.callBack=function(){this.getField().trigger("onuserinput")}});createPrototype(ExternalController,FieldController.prototype,new BasicValidator());var DateTimeController=(function(A,B){FieldController.call(this,A,B);this.initCalender=function(){this.getView().setupCalender(A.getComponentType(),A.getAllowedDays(),A.getAllowedTime(),A.getDefaultValue(),A.isSubformField(),A.getDateFormat())}});createPrototype(DateTimeController,FieldController.prototype,new BasicValidator());var SignatureController=(function(A,B){FieldController.call(this,A,B);this.init=function(){var D=this.getView().getDOM().getSignature(),C=false;if(B.getModel().getAccessType()==3){if(A.getDefaultValue()!==""){$(D).attr("isEdit",true);this.getView().getDOM().getSignatureContainer().attr("isHide",true);this.getView().getDOM().getSignatureTextarea().val("nochange,"+A.getDefaultValue());this.getView().getDOM().getEditEle().append(A.getDefaultValue());this.getView().getDOM().getEditEle().show();this.getView().getDOM().getSignatureContainer().find(".signature-clear span").show()}}}});createPrototype(SignatureController,FieldController.prototype,new BasicValidator());var SectionController=function(A,B){FieldController.call(this,A,B);this.init=function(){}};createPrototype(SectionController,FieldController.prototype,new BasicValidator());var IntegrationController=(function(C,F){FieldController.call(this,C,F);var B=this;var A=this.getView();var E=A.getDOM();var D=C;this.init=function(){A.constructOptionsDOM();A.hideOptionsDOM();B.setDefaultValue();D.setSearchQuery(false);D.setSaturation(false);D.setSearchSaturation(false);D.setEmptySearch(false)};this.preDataController=function(){var H,G;if(D.isSearchQuery()){if(!D.isEmptySearch()){G=D.getSearchCount()?D.getSearchCount():0;H=D.getSearchInputs();if(!D.isSearchSaturated()){B.fetchData(H,G);return false}B.postResponseHandler()}else{A.showOptionsLayout();D.setSearchQuery(false);B.postResponseHandler()}}else{G=D.getRecordCount()?D.getRecordCount():0;displayCount=D.getCurrentDisplayCount()?D.getCurrentDisplayCount():0;A.showSpinner();if(displayCount<G){B.fetchFromCache(displayCount,G);D.setInProgress(false);B.postResponseHandler()}else{if(!D.isSaturated()&&G<=displayCount){B.fetchData(H,G)}else{D.setInProgress(false);A.hideSpinner()}}}};this.fetchData=function(M,K){var J=this.getURL().getRelDataURL();var L={};var H="";var I=false;L.searchValues=M?JSON.stringify(M):JSON.stringify(new Array());L.noOfRecsInCache=K;I=K>0?false:true;if(D.isSubformField()){L.subformName=D.getFormModel().getLabelName()}var G=D.isSubformField()?D.getFormModel().getFormModel():D.getFormModel();L.formAccessType=G.getAccessType();if(B.getChildRelation()!=""){L=$.extend(L,B.getChildRelation())}if(G.hasPrivateLink()&&!isNull(G.getPrivateLink())){L.privatelink=G.getPrivateLink()}$.ajax({url:J,method:"POST",data:L,success:function(N){if(N.count>0){if(!D.isSearchQuery()){var O=D.getRecordCount()?D.getRecordCount()+N.count:N.count;D.setRecordCount(O);D.addFieldChoices(N.data);D.setSaturation(N.isSaturated);if(D.isActive()){A.constructOptions(E.getOptionsLayout(),N.data[0],false);D.setCurrentDisplayCount(O)}else{return }A.showOptionsLayout()}else{var O=D.getSearchCount()?D.getSearchCount()+N.count:N.count;D.setSearchCount(O);D.addSearchChoices(N.data);D.setSearchSaturation(N.isSaturated);if(D.isActive()){A.constructOptions(E.getSearchLayout(),N.data[0],O<200)}else{return }A.showSearchLayout()}}else{A.showDefaultLayout();if(!D.isSearchQuery()){A.disableSearchBoxes()}E.getMessageContainer().html(i18n.integrationnomatchfound)}B.postResponseHandler(I)}})};this.fetchFromCache=function(K,J){var N=D.getFieldChoices();var M=K+200<=J?K+200:J;var I=Object.keys(N);var G={};var L;for(var H=K;H<M;H++){L=I[H];G[L]=N[L]}D.setCurrentDisplayCount(M);A.constructOptions(E.getOptionsLayout(),G,false);A.showOptionsLayout()};this.postResponseHandler=function(G){D.setInProgress(false);A.hideSpinner();if(!(D.isSearchQuery()||D.isEmptySearch())){E.getSearchBoxes()[0].focus()}if(G){var H=E.getHighlightedRow();H.removeClass("combined-lookup-row-highlighted");A.firstRowFocus()}A.calculatePosition()};this.initiateSearchQuery=function(H){var G=B.validateSearchData();if(G!=false){D.setSearchQuery(true);D.setSearchInputs(G);D.setSearchSaturation(false)}B.preDataController()};this.validateSearchData=function(){var N=A.getSearchValues();var K=D.getColumnHeaders();var G=true;var J;var M,H=[];for(var I=0;I<N.length;I++){var L=N[I].value;H.push(L);if(L.length<2&&L!=""){G=false}J=J!=undefined?(N[I].value==""&&J):N[I].value==""}M=D.getSearchInputs().map(function(O){return O.value});if(G){A.showSpinner()}else{A.hideSpinner()}D.setEmptySearch(J);if(H.toString()==M.toString()){D.setEmptySearch(true);D.setSearchQuery(true);A.hideSpinner();return false}else{D.clearSearchChoices();D.setSearchCount(0);E.getSearchLayout().empty()}D.setSearchInputs(N);return G?N:G};this.setValueForField=function(G){A.hideOptionsDOM();var H=D.isSearchQuery()?D.getSearchChoice(G.id):D.getFieldChoice(G.id);B.setFieldValue(H);B.reset(false)};this.setFieldValue=function(H){if(LIB._isNull(H)){H={}}var I=D.getDefaultValue()?D.getDefaultValue().id:D.getDefaultValue();var G=H?H.id:H;D.setFieldValue(H);B.setDefaultValue();A.trigger("onuserinput");if(C.isFormulaExist()&&I!=G){this.getView().trigger("triggerformula")}};this.setDefaultValue=function(){if(D.getDefaultValue()){var G=D.getDefaultValue();if(!G.id){this.clearData()}else{this.getField().attr("field-id",G.id);this.getField().val(G.text);if(A.isFloatLabelAlignment()){E.getFieldParentGroup().addClass("zc-label-float")}}}if(this.getField().attr("field-id")){A.showDeselector();A.hidePlaceholder()}else{A.hideDeselector();A.showPlaceholder()}};this.getValue=function(){var G=jQuery.extend({},D.getFieldValue());if(G){G.text=G.actualText;delete G.actualText;return JSON.stringify(G)}};this.removeValue=function(){this.clearData();this.setFieldValue({})};this.clear=function(){this.removeValue()};this.clearData=function(){this.getField().val("");this.getField().removeAttr("field-id");A.showPlaceholder();if(A.isFloatLabelAlignment()){E.getFieldParentGroup().removeClass("zc-label-float")}};this.getChildRelation=function(){var G=F.getChildRelation();G["zc_childlabelname_"+G.zc_lookupCount]=D.getActualLabelName();G.isFromSubForm=D.isSubformField();G.childFieldLabelName=D.getActualLabelName();if(G.isFromSubForm==false){G.isNewTypeSubform=false}return G};this.reset=function(H){E.getSearchOptionsTable().scrollTop(0);D.setSearchQuery(false);D.setSearchInputs([]);D.setCurrentDisplayCount(0);if(H){var J=E.getCurrentLayout().find("tbody");J.empty()}if(!H){var I=E.getSearchBoxes();for(var G=0;G<I.length;G++){I[G].value=""}}}});createPrototype(IntegrationController,FieldController.prototype,new BasicValidator());function WorkflowController(A){this.formController=A;window.tester=A;this.active=false;this.isSetTask=false;this.isSelectTask=false;this.FORMACCESSTYPE={ADD:1,ADD_REPORT:2,EDIT:3,BULK_EDIT:4,ADD_LOOKUP:5};this.WFTYPE={ONLOAD_ADD:1,ONLOAD_EDIT:2,ONUSER_INPUT:3,ONADD_ROW:4,ONDELETE_ROW:5,ONUSER_INPUT_SUBFORM:6,FORMULA:7,BUTTON_CLICK:8};this.CONS={RELOAD:1,CLEAR:9,HIDE:10,SHOW:11,SET_VALUE:12,ENABLE:14,DISABLE:15,PRINT_TASK:71,OPEN_URL:280,SELECT:1001,DESELECT:1002,SELECTALL:1003,DESELECTALL:1004,APPEND_VALUE:1005,RESET_LOAD_LOOKUP_TASK:1006,ERROR_TASK:1007,ALERT:1302,SUCCESSMSG:2020};this.getIsSetTask=function(){return this.isSetTask};this.getIsSelectTask=function(){return this.isSelectTask};this.getRequestURI=function(){return"/"+ZCGlobal.scopeName+"/"+this.formController.getModel().getAppLinkName()+"/workflow/"+this.formController.getModel().getFormLinkName()};this.sendRequest=function(D,C){if(D.actiontype==this.WFTYPE.BUTTON_CLICK){A.disableButtons()}else{if(C!=undefined){A.addPendingTask(C.getLabelName())}}var B=this;$.ajax({url:B.getRequestURI(),method:"POST",beforeSend:function(E){B.active=true;B.showPreloader(D.actiontype,C)},data:D,success:function(E){if(D.actiontype!=B.WFTYPE.BUTTON_CLICK&&C!=undefined){B.formController.removePendingTask(C.getLabelName())}B.active=false;B.hidePreloader(D.actiontype,C);B.handler(E,D);if(D.actiontype==B.WFTYPE.BUTTON_CLICK){A.enableButtons()}else{if(A.getView().getDOM().getAutoSubmitBtn().length&&!A.getPendingTaskFields().length){D={buttonname:A.getView().getDOM().getAutoSubmitBtn().attr("name")};B.trigger(B.WFTYPE.BUTTON_CLICK,D);A.getView().getDOM().getAutoSubmitBtn().removeAttr("autosubmit")}}},error:function(G,E,F){if(D.actiontype==B.WFTYPE.BUTTON_CLICK){A.enableButtons()}}})};this.isActive=function(){return this.active};this.showPreloader=function(E,G){var D=E==this.WFTYPE.BUTTON_CLICK;var B=E==this.WFTYPE.ONLOAD_ADD||E==this.WFTYPE.ONLOAD_EDIT;var F=!(this.formController.getModel().isPerma()||this.formController.getModel().isEmbed()||this.formController.isPage||this.formController.getView().isPopup());var C=E==this.WFTYPE.ONUSER_INPUT||E==this.WFTYPE.FORMULA||E==this.WFTYPE.ONUSER_INPUT_SUBFORM;if(C){G.showLoader();return }if(B){this.formController.lockForm()}if(!F){this.formController.showProgress()}if(D){LIB._startLoading()}};this.hidePreloader=function(E,G){var D=E==this.WFTYPE.BUTTON_CLICK;var B=E==this.WFTYPE.ONLOAD_ADD||E==this.WFTYPE.ONLOAD_EDIT;var F=!(this.formController.getModel().isPerma()||this.formController.getModel().isEmbed()||this.formController.isPage||this.formController.getView().isPopup());var C=E==this.WFTYPE.ONUSER_INPUT||E==this.WFTYPE.FORMULA||E==this.WFTYPE.ONUSER_INPUT_SUBFORM;if(C){G.hideLoader();return }if(B){LIB._stopLoading();this.formController.unlockForm()}if(!F){this.formController.hideProgress()}else{LIB._stopLoading()}if(D){LIB._stopLoading()}};this.addListener=function(){};this.executeTask=function(F,E){var K=this;var P;if((F.compType==12||F.compType==13||F.compType==29)&&(!F.fieldValue)&&(F.task==this.CONS.SET_VALUE||this.CONS.APPEND_VALUE)){F.fieldValue=""}if(F.subFormName!=null){var R=K.formController.getFieldController(F.subFormName);if(F.rowNo!=undefined){F.fieldName=(F.compType==FieldType.EXTERNAL_LINK_FIELD&&F.fieldName!=undefined&&((F.fieldName).lastIndexOf("_ID")==((F.fieldName).length-3)))?(F.fieldName).substr(0,(F.fieldName).length-3):F.fieldName;P=R.getModel().getSubformField(F.rowNo,F.fieldName);if(P instanceof Array){P=P[0]}}else{R.executeWorkflow(F);return }}else{F.fieldName=(F.compType==FieldType.EXTERNAL_LINK_FIELD&&F.fieldName!=undefined&&((F.fieldName).lastIndexOf("_ID")==((F.fieldName).length-3)))?(F.fieldName).substr(0,(F.fieldName).length-3):F.fieldName;P=K.formController.getFieldController(F.fieldName)}if(P==undefined){var I=[this.CONS.CLEAR,this.CONS.HIDE,this.CONS.SHOW,this.CONS.ENABLE,this.CONS.DISABLE,this.CONS.SELECTALL,this.CONS.DESELECTALL,this.CONS.SET_VALUE,this.CONS.SELECT,this.CONS.DESELECT,this.CONS.APPEND_VALUE];if(I.indexOf(F.task)!=-1){return }}if(P!=undefined&&P.getModel().isCompositeField()&&F.subFieldName!=null){P=P.getCompositeSubField(F.subFieldName);if(P==undefined){return }}switch(F.task){case this.CONS.RELOAD:K.formController.resetForm();break;case this.CONS.SUCCESSMSG:$.successMsg(F.successMsg,3000);break;case this.CONS.CLEAR:P.clear();break;case this.CONS.HIDE:P.hideField();if(F.subFormName!=null){var R=K.formController.getFieldController(F.subFormName);setTimeout(function(){R.adjustWidth()},0)}break;case this.CONS.SHOW:P.showField();if(F.subFormName!=null){var R=K.formController.getFieldController(F.subFormName);setTimeout(function(){R.adjustWidth()},0)}break;case this.CONS.ENABLE:P.enableField();break;case this.CONS.DISABLE:P.disableField();break;case this.CONS.SELECTALL:P.selectAll();break;case this.CONS.DESELECTALL:this.isSetTask=true;P.deselectAll();break;case this.CONS.ALERT:F.alertValue=F.alertValue.replace(/\n/g,"<br>").replace(/\\r/g,"");$.alert({msg:F.alertValue});K.formController.handlePopupPositionForMobile();break;case this.CONS.SET_VALUE:this.isSetTask=true;this.isSelectTask=false;var O=this.constructValue(P,F);P.setFieldValue(O!=undefined?O:"",F);break;case this.CONS.SELECT:this.isSetTask=false;this.isSelectTask=true;var H=this.constructValue(P,F);if(P.getModel().isSingleSelect()){H=H[0]}else{if((P.getModel().getComponentType()==FieldType.LIST)||P.getModel().isLookup()){var J=P.getModel().getDefaultValue();if(J!=undefined&&J.length>0&&H.length>0){$.merge(J,H);H=J}}}P.setFieldValue(H);break;case this.CONS.DESELECT:P.deselectValue(this.constructValue(P,F));break;case this.CONS.APPEND_VALUE:P.appendValue(this.constructValue(P,F));break;case this.CONS.OPEN_URL:urlString=F.urlString.trim();var M=urlString.toLowerCase();if(!ZCSecurity.isURLXSSVulnerable(urlString)){if(M.indexOf("#script:")==0){window.open(urlString,"_self")}else{LIB._openURL(F.urlString,F.windowType,F.windowSpecificArgument)}}break;case this.CONS.PRINT_TASK:var Q=[{HeaderMsg:F.headerMsg,UserMsgs:F.infoValue}];K.formController.infoMsgHandler(Q);break;case this.CONS.ERROR_TASK:var L=0;for(var G=0;G<F.errors.length;G++){var B=F.errors[G];for(var C in B){if(C=="zc_captcha_txt"){K.formController.showCaptchaError(B[C]);K.formController.resetCaptcha();continue}var N=K.formController.getFieldController(C);N.showError(B[C]);if(L==0){N.focus()}}L++}break;case this.CONS.RESET_LOAD_LOOKUP_TASK:P.resetLoadLookup();break;default:var D=F.message;if(D!=""&&D!=undefined){D=D.replace(new RegExp("@@@SQ@@@","g"),"'");if(E==K.WFTYPE.ONLOAD_ADD||E==K.WFTYPE.ONLOAD_EDIT){A.getView().closeForm("")}$.alert({msg:D})}}};this.handler=function(B,D){if(D.actiontype==this.WFTYPE.BUTTON_CLICK&&B.length==0&&this.formController.getButtonController(D.buttonname).getModel().getButtonType()!="button"){this.formController.resetForm()}for(var C=0;C<B.length;C++){this.executeTask(B[C],D.actiontype)}};this.onUserInput=function(F,E,D){var B=this;var C={};if(!LIB._isNull(E)){C.fieldname=E.getModel().getActualLabelName();C.subformfieldname=F.getModel().getActualLabelName();C.rowseqid=D;_wftype=B.WFTYPE.ONUSER_INPUT_SUBFORM}else{C.fieldname=F.getModel().getActualLabelName();_wftype=B.WFTYPE.ONUSER_INPUT}if(F.getModel().isOnChangeExist()){var G=function(I,H,J){$(I.getField()).bind("onuserinput",function(){B.trigger(H,J,I)})}(F,_wftype,C)}};this.triggerFormulaAction=function(D,C){var B=this;if(D.getModel().isFormulaExist()){var E=function(G,F,H){$(G.getField()).unbind("formulacalc").bind("formulacalc",function(I){B.trigger(F,H,G);I.stopPropagation()})}(D,B.WFTYPE.FORMULA,C)}};this.triggerRowAction=function(D){var B=this;if(D.getModel().hasOnAddRow()){var C={fieldname:D.getModel().getActualLabelName(),rowseqid:"t::row_"+(D.getNextSeqNo()-1)};B.trigger(B.WFTYPE.ONADD_ROW,C)}};this.triggerDeleteAction=function(E,D){var B=this;if(E.getModel().hasOnDeleteRow()){var C={fieldname:E.getModel().getActualLabelName(),rowseqid:D};B.trigger(B.WFTYPE.ONDELETE_ROW,C)}};this.bindOnUserInput=function(H,E,D){var C=this;for(k in H){var G=H[k];if(G.getModel().getComponentType()==99){var I=G.getModel().getAllFields();for(f in I){var B=I[f].FIELDS;var F=[];for(ff in B){if(B[ff].CONTROLLER!=undefined){F.push(B[ff].CONTROLLER)}}C.bindOnUserInput(F,G,f)}}else{C.onUserInput(G,E,D)}}};this.TriggerOnLoad=function(){var B=1;switch(this.formController.getModel().getAccessType()){case this.FORMACCESSTYPE.ADD:B=this.WFTYPE.ONLOAD_ADD;break;case this.FORMACCESSTYPE.EDIT:B=this.WFTYPE.ONLOAD_EDIT;break}this.trigger(B)};this.trigger=function(D,E,B){var C=this.constructFormData(D);C.actiontype=D;C=$.extend(C,E);this.sendRequest(C,B)};this.constructFormData=function(C){var D=[];this.formController.getModel().setTriggeredControllerType("workFlowController");var B=this.formController.collectData(C!=this.WFTYPE.BUTTON_CLICK,C==this.WFTYPE.FORMULA);B.formAccessType=B.recType;for(i in D){delete B[D[i]]}return B};this.constructValue=function(F,B){var H=[FieldType.SINGLE_SELECT,FieldType.EXTERNAL_FIELD,FieldType.POPUP_SINGLE,FieldType.DROPDOWN,FieldType.INLINE_PICK_LIST,FieldType.LIST,FieldType.RADIO,FieldType.INLINE_RADIO,FieldType.CHECK_BOXES,FieldType.SYSTEM_LOOKUP];var C=F.getModel().getComponentType();var D;if(H.indexOf(C)!=-1){if(B.fieldValue instanceof Array){D=[];for(i in B.fieldValue){var G=F.getModel().isLookup()&&B.combinedValue!=undefined?B.combinedValue[i]:B.fieldValue[i];if(G!=undefined){D.push({id:B.fieldValue[i],text:G})}}}else{if(F.getModel().getGMAPKEY()==="country"){var I=Constants.COUNTRY_MAP[B.fieldValue.toLowerCase()];if(I===undefined){I=Constants.INVERTED_COUNTRY_MAP[B.fieldValue.toLowerCase()];D={id:I!=undefined?I:B.fieldValue,text:B.fieldValue}}else{D={id:B.fieldValue.toLowerCase(),text:I}}}else{if(C==FieldType.EXTERNAL_FIELD){if(B.compType==FieldType.EXTERNAL_LINK_FIELD){F.getModel().constructId(B.fieldValue)}else{F.getModel().constructText(B.fieldValue)}var E=F.getModel().getConstructedVal();if(E.text!=undefined){E.id=(E.id==undefined)?"-1":E.id;D=E}}else{var G=(F.getModel().isLookup()&&B.combinedValue!=undefined)?B.combinedValue:B.fieldValue;if(G!=undefined&&B.fieldValue!=undefined&&B.fieldValue!=""&&G!=""){D={id:B.fieldValue,text:G}}if(F.getModel().isIntegrationField()&&B.FIELDVALUE!=undefined){if(B.FIELDVALUE.actualText!=undefined&&G!=""){D=B.FIELDVALUE}}}}}}else{if(C===FieldType.CURRENCY&&B.fieldValue!=undefined&&B.fieldValue!=""&&F.getModel().getValueFormat()===FormatConstants.DOTCOMMA){D=B.fieldValue.replace(".",",")}else{D=B.fieldValue}}return D}}WorkflowController.prototype.execute=function(){var A=this;A.bindOnUserInput(A.formController.getFormFields());if(A.formController.getModel().hasOnLoad()){A.TriggerOnLoad()}};function AutomationController(B,A){A=JSON.parse(A);this.formController=B;this.formRules=A;this.DUMMY_FIELD="_zc_Dummy_NullCritVar";this.DUMMY_FIELD_CONTROLLER=new FieldController(new FieldModel({},this.formController.getModel()),this.formController);this.TASK_TYPE={HIDE_FIELDS:1,DISABLE_FIELDS:2,ENABLE_FIELDS:3,SHOW_FIELDS:4,HIDE_SUBFORM_ADD_ENTRY:9,SHOW_SUBFORM_ADD_ENTRY:10,HIDE_SUBFORM_DELETE_ENTRY:11,SHOW_SUBFORM_DELETE_ENTRY:12,SET_FIELD_VALUE:14};this.mapFields=function(C,I){var H=this.formController.getFieldController(C);if(C.indexOf(".")!==-1){var F=C.split(".")[0];H=this.formController.getFieldController(F)}if(I.indexOf(".")!==-1){var F=I.split(".")[0];var J=I.split(".")[1];af=this.formController.getFieldController(F);af=af.getCompositeSubField(J)}else{af=this.formController.getFieldController(I)}if(af==undefined){af=this.formController.getButtonController(I)}if(C==this.DUMMY_FIELD){H=this.DUMMY_FIELD_CONTROLLER}if(H===undefined||af===undefined){return }if(!H.hasActionField(af)){H.setActionField(af)}for(var E in af.getActionFields()){H.setActionField(af.getActionFields()[E])}for(var D in this.formController.getFormFields()){var G=this.formController.getFieldController(D);if(G.hasActionField(H)){G.setActionField(af)}}};this.setFieldCriteria=function(F,C,E){var D=this.formController.getFieldController(F);if(D==undefined){D=this.formController.getButtonController(F)}if(E===undefined||D===undefined){return false}switch(C){case this.TASK_TYPE.HIDE_FIELDS:D.setCriteria("hide",E);break;case this.TASK_TYPE.DISABLE_FIELDS:D.setCriteria("disable",E);break;case this.TASK_TYPE.ENABLE_FIELDS:D.setCriteria("enable",E);break;case this.TASK_TYPE.SHOW_FIELDS:D.setCriteria("show",E);break;case this.TASK_TYPE.HIDE_SUBFORM_ADD_ENTRY:D.setCriteria("hidesubformaddentry",E);break;case this.TASK_TYPE.SHOW_SUBFORM_ADD_ENTRY:D.setCriteria("showsubformaddentry",E);break;case this.TASK_TYPE.HIDE_SUBFORM_DELETE_ENTRY:D.setCriteria("hidesubformdelentry",E);break;case this.TASK_TYPE.SHOW_SUBFORM_DELETE_ENTRY:D.setCriteria("showsubformdelentry",E);break;case this.TASK_TYPE.SET_FIELD_VALUE:D.setCriteria("setfieldvalue",E);break}};this.evaluateCondition=function(F){var D=this;var E=F.replace(/is null/g,'== ""').replace(/is not null/g,'!= ""').replace(/is today/g,"in this 1 days").replace(/is yesterday/g,"in last 1 days").replace(/is tomorrow/g,"in next 1 days").replace(/ (in) (this|next|last) (week|month|year)/g," $1 $2 1 $3s").replace(/ (in) (this|next|last) (\d+) (days|weeks|months|years)/g,'.$1$2($3, "$4")').replace(/ in (\d+) (days|weeks|months|years) ago/g,'.ago($1, "$2")');var C=jsep(E);_getTreeValue=function(G){var J=G.type;var L;switch(J){case"Literal":if(typeof (G.value)==="number"&&G.raw.length>16){L=G.raw}else{L=G.value}break;case"Identifier":var I=D.formController.getFieldController(G.name);L=(I===undefined||!I.isAccessible(true)||!I.isVisible(true))?"":I.getValue();if(I!==undefined){var K=I.getField();if(K[0].type==="checkbox"){if(L=="zc_checked"){L=true}else{if(L=="zc_unchecked"){L=false}}}}break;case"MemberExpression":if(G.object.name==="zoho"){L=D.formController.getModel().getZohoVars()[G.property.name]}else{var I=D.formController.getFieldController(G.object.name);if(I!==undefined&&I.getModel().isCompositeField()){var H=I.getCompositeSubField(G.property.name);L=(H===undefined||!H.isAccessible(true)||!I.isVisible(true))?"":H.getValue()}else{L=""}}break}return L!==undefined&&typeof (L)!=="number"?L.toString():L};_evaluateCriteira=function(V){var J=V.operator;var K=V.type;if(K==="LogicalExpression"){switch(J){case"&&":return _evaluateCriteira(V.left)&&_evaluateCriteira(V.right);case"||":return _evaluateCriteira(V.left)||_evaluateCriteira(V.right);default:return false}}else{if(K==="BinaryExpression"){var H=_getTreeValue(V.left);var O=_getTreeValue(V.right);var M=V.left.type!="MemberExpression"?V.left.name:V.left.object.name;var I="",T="",U=false,G=false;var L=D.formController.getFieldController(M).getModel().getComponentType();if(L==FieldType.DATE||L==FieldType.DATE_TIME){var I=new Date(Date.parse(H.replace(/-/g," "),ZCGlobal.uiDateFormate));var T=new Date(Date.parse(O.replace(/-/g," "),ZCGlobal.uiDateFormate));U=true;if(H==""||O==""){G=true}}if(typeof (O)==="number"){if(!$.isNumeric(H)){return false}if(H==parseInt(H)){H=parseInt(H)}else{H=parseFloat(H)}}switch(J){case"==":if(U){if(!G){return(I-T)===0}else{return(H==""&&O=="")}}return H===O;case"!=":return H!==O;case">":if(U&&!G){return I>T}else{if(U){return false}}return H>O;case"<":if(U&&!G){return I<T}else{if(U){return false}}return H<O;case">=":return H>=O;case"<=":return H<=O;default:return false}}else{if(K==="CallExpression"){var P=V.callee.property.name;var N=_getTreeValue(V.callee.object);var S=_getTreeValue(V.arguments[0]);var R=null;if(V.arguments.length==2){R=_getTreeValue(V.arguments[1])}if(N===undefined){return false}switch(P){case"contains":return N.indexOf(S)!==-1;case"startsWith":return N.indexOf(S)===0;case"endsWith":return N.indexOf(S,N.length-S.length)!==-1;case"before":return new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<new Date(Date.parse(S.replace(/-/g," "),ZCGlobal.uiDateFormate));case"after":return new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>new Date(Date.parse(S.replace(/-/g," "),ZCGlobal.uiDateFormate));case"inlast":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<new moment().startOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate)).getTime()>new moment().subtract(S+1,R).endOf(R));case"innext":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>new moment().endOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<new moment().add(S+1,R).startOf(R));case"inthis":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>=new moment().startOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<=new moment().endOf(R));case"ago":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>=new moment().subtract(S,R).startOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<=new moment().subtract(S,R).endOf(R));default:return false}}else{if(K==="UnaryExpression"){return !_evaluateCriteira(V.argument)}else{if(K==="Identifier"){var Q=_getTreeValue(V);if(typeof (Q)==="string"){Q=Q==="zc_checked"||Q==="true"}return Q}else{if(K==="Literal"){return V.value}}}}}}};return _evaluateCriteira(C)};this.event=function(Q){var M=this;var E=Q.getActionFields();for(var P in E){var K=E[P];if(K.getCriteria().hide!==undefined||K.getCriteria().show!==undefined){var H=undefined;var V=undefined;if(K.getCriteria().hide!==undefined){H=M.evaluateCondition(K.getCriteria().hide)}if(K.getCriteria().show!==undefined){V=M.evaluateCondition(K.getCriteria().show)}H=H===undefined?true:H;V=V===undefined?false:V;var Q=!H&&V?true:(H&&!V?false:K.isVisible());if(Q){K.showField()}else{K.hideField()}}if(K.getCriteria().disable!==undefined||K.getCriteria().enable!==undefined){var S,G;if(K.getCriteria().disable!==undefined){S=M.evaluateCondition(K.getCriteria().disable)}if(K.getCriteria().enable!==undefined){G=M.evaluateCondition(K.getCriteria().enable)}S=S===undefined?true:S;G=G===undefined?false:G;var Q=!S&&G?true:(S&&!G?false:K.isAccessible());if(Q){K.enableField()}else{K.disableField()}}if(K.getCriteria().hidesubformaddentry!==undefined||K.getCriteria().showsubformaddentry!==undefined){var L,D;if(K.getCriteria().hidesubformaddentry!==undefined){L=M.evaluateCondition(K.getCriteria().hidesubformaddentry)}if(K.getCriteria().showsubformaddentry!==undefined){D=M.evaluateCondition(K.getCriteria().showsubformaddentry)}L=L===undefined?true:L;D=D===undefined?false:D;var Q=L&&!D?true:(!L&&D?false:(!L&&!D?false:K.isAddLinkVisible()));if(Q){K.hideAddLink()}else{K.showAddLink()}}if(K.getCriteria().hidesubformdelentry!==undefined||K.getCriteria().showsubformdelentry!==undefined){var C,I;if(K.getCriteria().hidesubformdelentry!==undefined){I=M.evaluateCondition(K.getCriteria().hidesubformdelentry)}if(K.getCriteria().showsubformdelentry!==undefined){C=M.evaluateCondition(K.getCriteria().showsubformdelentry)}I=I===undefined?true:I;C=C===undefined?false:C;var Q=I&&!C?true:(!I&&C?false:(!I&&!C?false:K.isDeleteLinkVisible()));if(Q){K.hideDeleteLink()}else{K.showDeleteLink()}}if(K.getCriteria().setfieldvalue.criteria.length!==0){var U=K.getCriteria().setfieldvalue.criteria;var F=U.length;var R=true,N=false;var T=0,O=-1;for(var P=0;P<F;P++){if(U[P]==="true"){T++;O=P;continue}var J=U[P];if(M.evaluateCondition(J)){if(!K.getCriteria().setfieldvalue.set){K.getCriteria().setfieldvalue.prevalue=K.getValue()}else{if(K.getCriteria().setfieldvalue.set&&R===false){K.setValue(K.getCriteria().setfieldvalue.prevalue);K.getCriteria().setfieldvalue.set=false;break}if(K.getValue()!==K.getCriteria().setfieldvalue.value[K.getCriteria().setfieldvalue.correctCrit].value){K.getCriteria().setfieldvalue.prevalue=K.getValue()}}K.setValue(K.getCriteria().setfieldvalue.value[P].value);K.getCriteria().setfieldvalue.set=true;K.getCriteria().setfieldvalue.correctCrit=P;R=false}}if(!K.getCriteria().setfieldvalue.set&&T===1){K.setValue(K.getCriteria().setfieldvalue.value[O].value)}if(R&&K.getCriteria().setfieldvalue.set){if(K.getValue()===K.getCriteria().setfieldvalue.value[K.getCriteria().setfieldvalue.correctCrit].value){K.setValue(K.getCriteria().setfieldvalue.prevalue)}K.getCriteria().setfieldvalue.set=false;K.getCriteria().setfieldvalue.correctCrit=-1}}}};this.setFieldValue=function(I,D,J){var F=null;if(I.indexOf(".")!==-1){var L=I.split(".")[0];var E=I.split(".")[1];F=this.formController.getFieldController(L);F=F.getCompositeSubField(E);F.setCriteria("setfieldvalue",J)}else{F=this.formController.getFieldController(I)}if(F===undefined){return }var G=F.getCriteria().setfieldvalue.criteria;if(F.getCriteria().setfieldvalue.value===undefined){F.getCriteria().setfieldvalue.value=[]}for(var H=0;H<G.length;H++){if(G[H]===J){var C={};var K=ZCGlobal.uiDateFormate.replace("E","ddd");if(D.indexOf("${zoho.currenttime}")!=-1){D=moment().locale("en-US").format(K+" HH:mm:ss")}else{if(D.indexOf("${zoho.currentdate}")!=-1){D=moment().locale("en-US").format(K)}else{if(D.indexOf("${zoho.")!=-1){D=D.replace("${zoho.","").replace("}","");D=B.getModel().getZohoVars()[D]}}}C.value=this.constructValue(D,F);F.getCriteria().setfieldvalue.value.push(C)}}};this.constructValue=function(E,D){var C;if(D.getModel().getGMAPKEY()==="prefix"){return{id:E,text:E}}else{if(D.getModel().getGMAPKEY()==="country"){var F=Constants.COUNTRY_MAP[E.toLowerCase()];if(F===undefined){F=Constants.INVERTED_COUNTRY_MAP[E.toLowerCase()];C={id:F!=undefined?F:E,text:E}}else{C={id:E.toLowerCase(),text:F}}}else{if(D.getModel().getComponentType()===FieldType.CURRENCY&&E!=undefined&&E!=""&&D.getModel().getValueFormat()===FormatConstants.DOTCOMMA){C=E.replace(".",",")}else{C=E}}}return C}}AutomationController.prototype.execute=function(){var I=this;var G=I.formRules.isNewWfEnabled;if(G=="false"||G==undefined){for(r in I.formRules.rules){var J=I.formRules.rules[r];try{J.condition=decodeURIComponent(J.condition);for(t in J.tasks){var A=J.tasks[t];for(tf in A.taskConfig.FIELDS){var D=A.taskConfig.FIELDS[tf];if(J.conditionFields.length===0){J.conditionFields[0]=I.DUMMY_FIELD}for(cf in J.conditionFields){I.mapFields(J.conditionFields[cf],D)}I.setFieldCriteria(D,A.taskType,J.condition)}if(A.taskType===this.TASK_TYPE.SET_FIELD_VALUE){var E=JSON.parse(JSON.stringify(A.taskConfig));for(field in E.VALUES){I.setFieldValue(field,E.VALUES[field],J.condition)}}}}catch(H){var F=window.console;F.log(H)}}}else{for(r in I.formRules.rules){var J=I.formRules.rules[r];try{for(g in J.groups){var K=J.groups[g];K.condition=decodeURIComponent(K.condition);for(t in K.tasks){var A=K.tasks[t];for(tf in A.taskConfig.FIELDS){var D=A.taskConfig.FIELDS[tf];if(K.conditionFields.length===0){K.conditionFields[0]=I.DUMMY_FIELD}for(cf in K.conditionFields){I.mapFields(K.conditionFields[cf],D)}I.setFieldCriteria(D,A.taskType,K.condition)}if(A.taskType===this.TASK_TYPE.SET_FIELD_VALUE){var E=JSON.parse(JSON.stringify(A.taskConfig));for(field in E.VALUES){I.setFieldValue(field,E.VALUES[field],K.condition)}}}}}catch(H){var F=window.console;F.log(H)}}}if(I.DUMMY_FIELD_CONTROLLER.hasActionFields()){I.event(I.DUMMY_FIELD_CONTROLLER)}for(k in this.formController.getFormFields()){var C=this.formController.getFieldController(k);if(C.hasActionFields()){I.event(C);var B=function(N){var M=function(){I.event(N)};var L=C.getModel().getComponentType();if(L==FieldType.DATE||L==FieldType.DATE_TIME){if(!$(N.getField()).hasClass("automationReg")){$(N.getField()).addClass("automationReg");$(N.getField()).change(M).keyup(M)}}else{$(N.getField()).change(M).keyup(M)}}(C)}}};function AutomationOperation(){var B=[];var A={hide:undefined,show:undefined,enable:undefined,disable:undefined,hidesubformaddentry:undefined,showsubformaddentry:undefined,hidesubformdelentry:undefined,showsubformdelentry:undefined,setfieldvalue:{criteria:[],set:false,prevalue:undefined,value:[],correctCrit:-1}};this.getActionFields=function(){return B};this.setActionField=function(C){for(k in B){if(C.getLabelName()==B[k].getLabelName()){return }}B.push(C)};this.hasActionFields=function(){return B.length>0};this.hasActionField=function(D){for(var C in B){if(D.getLabelName()==B[C].getLabelName()){return true}}return false};this.getCriteria=function(){return A};this.setCriteria=function(C,D){if(C=="setfieldvalue"){A[C].criteria.push(D);return }A[C]=(A[C]==undefined)?D:(A[C]+"||"+D)}}var FormModel=(function(H,C,G){ModelFactory.call(this,H,ObjectType.FORM);var D=C,B=G;if(G!==undefined&&G["#"+H.FORMLINKNAME]!==undefined){$.extend(true,H,B["#"+H.FORMLINKNAME])}this.getFormId=function(){return this.getMeta().FORMID};this.getFormLinkName=function(){return this.getMeta().FORMLINKNAME};this.getAppLinkName=function(){return H.APPLINKNAME};this.getFormDisplayName=function(){return this.getMeta().FORMDISPLAYNAME};this.getFormFieldData=function(N){return D[N]};this.getFormFieldMeta=function(N){var O=this.getMeta().FORMLAYOUT[N];if(B!==undefined&&B[N]!=undefined){$.extend(true,O,B[N])}return O};this.getDynamicMeta=function(N){if(B!==undefined){return B[N]}};this.getFormFields=function(){return this.getMeta().FORMLAYOUT};this.getFirstColumnFields=function(){return E(this.getFormFields(),1)};this.getSecondColumnFields=function(){return E(this.getFormFields(),2)};this.getFieldsByColumnNo=function(N){return E(this.getFormFields(),N)};this.getField=function(N){return this.getMeta().FORMLAYOUT[N]};this.getFieldModel=function(N){return Model.FieldModel.create(this.getField(N),this)};this.hasDependencyField=function(){return this.hasRichtextField()};this.hasRichtextField=function(){return M(this.getFormFields(),FieldType.RICH_TEXT_AREA)};this.getFirstFieldName=function(){var Q=this.getFirstColumnFields(),O=[];for(var P=0,R=Object.keys(Q),N=R.length;P<N;++P){if(!Q[R[P]].FIELDISHIDDEN){O.push(Q[R[P]])}}O.sort(function(U,T){var S=U.SEQUENCE_NUMBER,V=T.SEQUENCE_NUMBER;return((S<V)?-1:((S>V)?1:0))});return(O.length>0)?O[0].FIELDLABELNAME:""};this.getSortedKeys=function(){var Q=this.getFormFields(),R=[];for(var O=0,P=Object.keys(Q),N=P.length;O<N;++O){R.push(P[O])}R.sort(function(U,T){var S=Q[U],X=Q[T];var V=S.SEQUENCE_NUMBER,W=X.SEQUENCE_NUMBER;return((V<W)?-1:((V>W)?1:0))});return R};this.getAccessType=function(){return H.FORMACCESSTYPE};this.getRandStr=function(){return H.RANDSTR};this.getAppLinkName=function(){return H.APPLINKNAME};this.getFormAlign=function(){return H.FORMALIGN};this.getPKValue=function(){return D.PKVALUE};this.hasOnLoad=function(){return H.HASONLOADEXIST};this.getOnLoadActions=function(){return H.ONLOADACTION};this.getFormStyle=function(){return H.FORMSTYLE};this.getRulesScript=function(){return H.RULESCRIPT};var F=undefined;this.getZohoVars=function(){if(F==undefined){if(this.isPermaOrEmbed()&&!this.isPublic()){LIB._initGlobals()}F=$.extend(true,{},H.ZOHO_VARS);F.adminuser=ZCGlobal.scopeName;F.loginuser=ZCGlobal.loginName;F.loginuserid=ZCGlobal.loginEmail}return F};this.getButtons=function(){return H.FORMBUTTON.FORMBUTTONS};this.getFormType=function(){return H.FORMBUTTON.FORMTYPE};this.isAutoWidth=function(){return(H.FORMAUTOWIDTH!=undefined)?H.FORMAUTOWIDTH:false};this.isPublic=function(){return H.ISPUBLIC};this.hasPrivateLink=function(){return(this.isPublic()||!LIB._isNull(H.PRIVATELINK))};this.getPrivateLink=function(){return H.PRIVATELINK};this.isPaymentCallback=function(){return H.ISPAYMENTCALLBACK};this.getPmtTransactionId=function(){return H.PMTTRANSACTIONID};this.getPmtReturnType=function(){return H.PMTRETURNTYPE};this.getRecordLinkId=function(){return D.RECLINKID};this.getRecordLinkIdFromMeta=function(){return H.RECLINKID};this.getSuccessMsg=function(){return H.SUCCESSMSG};this.getNextURL=function(){return H.NEXTURL};this.openFormIn=function(){return H.OPENIN};this.isCustomFormLabelWidth=function(){return(H.FORMLABELWIDTHTYPE=="custom")};this.getLabelWidth=function(){return H.FORMLABELWIDTH};this.getLabelWidthUnit=function(){return(H.FORMLABELWIDTHUNIT==1)?"%":"px"};this.getViewLinkName=function(){return H.VIEWLINKNAME};this.showOnlyViewFields=function(){return H.EDITONLYVISIBLE};this.getFromParams=function(){return H.FORMPARAMS};var K;this.getParamFieldLabels=function(){if(typeof (K)==="undefined"&&typeof (this.getFromParams())!=="undefined"){K=this.getFromParams().split("&").map(function(N){return N.split("=")[0]})}return K};var L=false;this.markActive=function(){L=true};this.unmarkActive=function(){L=false};this.isActive=function(){return L};var J=0;this.incrementActiveAddressOps=function(){J++};this.decrementActiveAddressOps=function(){J--};this.getNoOfActiveAddressOps=function(){return J};this.hasCaptcha=function(){return H.ISCAPTCHAENABLED};function E(R,P){var S={};for(var O=0,Q=Object.keys(R),N=Q.length;O<N;++O){if(R[Q[O]].FIELDCOLUMN==P){S[Q[O]]=R[Q[O]]}}return S}this.getMaxCol=function(){var R=0;var Q=this.getFormFields();for(var O=0,P=Object.keys(Q),N=P.length;O<N;++O){if(R<Q[P[O]].FIELDCOLUMN){R=Q[P[O]].FIELDCOLUMN}}return R};function M(R,O){for(var P=0,Q=Object.keys(R),N=Q.length;P<N;++P){if(R[Q[P]].FIELDCOMPTYPE==O){return true}}return false}this.isPerma=function(){return H.ISPERMA};this.isEmbed=function(){return H.ISEMBED};this.isPermaOrEmbed=function(){return H.ISEMBED||H.ISPERMA};this.focusFirstField=function(){return H.FIRSTFIELDFOCUS};this.isGeoLocationMandatory=function(){return H.GEOLOCATION!=undefined?H.GEOLOCATION:false};var A=null;this.setTriggeredControllerType=function(N){A=N};this.getTriggeredControllerType=function(){return A};this.isGeoFenceEnabled=function(){return H.GEO_FENCE!=undefined};this.getGeoFenceObj=function(){return H.GEO_FENCE};var I=[];this.addPendingTask=function(N){I.push(N)};this.removePendingTask=function(N){var O=I.indexOf(N);I.splice(O,1)};this.getPendingTaskFields=function(){return I}});FormModel.prototype=Object.create(ModelFactory.prototype);FormModel.prototype.constructor=FormModel;var FormButtonModel=(function(A){ModelFactory.call(this,A,ObjectType.FORMBUTTON);this.getButtonID=function(){return A.BUTTONID};this.getButtonName=function(){return A.BUTTONLABEL_NAME};this.getButtonType=function(){return A.BUTTON_TYPE};this.getButtonEvent=function(){return A.BUTTONEVENT};this.getButtonID=function(){return A.BUTTON_ID}});FormButtonModel.prototype=Object.create(ModelFactory.prototype);FormButtonModel.prototype.constructor=FormButtonModel;var FieldModel=(function(F,A,C){var E,D,B;E=F;D=A;B=C;this.getData=function(){return B};this.getPosition=function(){return E.POSITION};this.getComponentType=function(){return E.FIELDCOMPTYPE};this.getComponentId=function(){return E.FIELDCOMPID};this.getLabelName=function(){return E.FIELDLABELNAME};this.getActualLabelName=function(){return E.ACTUALLABEL};this.getDisplayName=function(){return E.FIELDDISPLAYNAME};this.isMandatory=function(){return E.FIELDISMANDATORY};this.getClassName=function(){return E.FIELDCLASSNAME};this.getSequenceNo=function(){return E.SEQUENCE_NUMBER};this.getFormComponentId=function(){return E.FORMCOMPID};this.readOnly=E.READONLY;this.isReadOnly=function(G){if(G){return this.readOnly}return E.READONLY};this.setReadOnly=function(G){this.readOnly=G};this.visible=E.VISIBLE;this.isVisible=function(G){if(G){return this.visible}return E.VISIBLE};this.setVisible=function(G){this.visible=G};this.isUnique=function(){return E.FIELDISUNIQUE};this.isOnChangeExist=function(){return(E.ONCHANGEEXIST=="true"||E.ONCHANGEEXIST==true)};this.isFormulaExist=function(){return(E.ISFORMULAEXIST=="true")};this.isFormulaField=function(){return(this.getComponentType()==FieldType.SCRIPT)};this.isSubformField=function(){return(E.ISSUBFORM=="true")};this.getRowID=function(){return E.ROWID};this.getDefaultValue=function(){return B!==undefined?B.FIELDVALUE:""};this.getFormModel=function(){return D};this.getParentFormModel=function(){return(E.ISSUBFORM=="true")?D.getFormModel():D};this.isLookup=function(){return false};this.getTitle=function(){return E.FIELDDESC};this.getDescType=function(){return E.FIELDDESCTYPE};this.isFromReport=function(){return E.ISFROMREPORT};this.getFieldType=function(){return E.FIELDTYPE};this.getTotalRecordsCount=function(){return E.TOTALRECORDS};this.fieldDecimalLength=function(){return E.FIELDDECIMALLENGTH};this.isCompositeField=function(){return E.FIELDCOMPTYPE==FieldType.ADDRESS||E.FIELDCOMPTYPE==FieldType.NAME};this.getGroupParentField=function(){return E.GROUPPARENTFIELD};this.isCompositeSubField=function(){return E.GROUPPARENTFIELD!=undefined?true:false};this.isAddressSubField=function(){return E.GROUPPARENTFIELD!=undefined&&E.GROUPPARENTFIELDTYPE==FieldType.ADDRESS};this.getGMAPKEY=function(){return E.GMAPKEY};this.isCoordinateField=function(){return E.GMAPKEY=="latitude"||E.GMAPKEY=="longitude"};this.isName_PrefixField=function(){return E.GMAPKEY=="prefix"};this.isAddress_CountryField=function(){return E.GMAPKEY=="country"}});var CurrencyModel=(function(D,B,C){FieldModel.call(this,D,B,C);var A=false;this.setValidationError=function(E){A=E};this.containsValidationError=function(){return A};this.getValueFormat=function(){return D.VALUEFORMAT};this.getPlaceHolderFormat=function(){return D.PLACEHOLDERFORMAT};this.getMaxDigits=function(){return D.FIELDMAXDIGITS}});var DateTimeModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.getDateFormat=function(){return C.dateFormat};this.getAllowedDays=function(){return(C.WORKWEEK!=undefined)?C.WORKWEEK:"0,1,2,3,4,5,6"};this.getPickerLanguage=function(){return C.LANGUAGE};this.getAllowedTime=function(){var F=C.WORKHOURSTART,D=C.WORKHOUREND,E=[];F=(F!=undefined)?parseInt(F):0;D=(D!=undefined)?parseInt(D):23;for(;F<=D;F++){E.push(F)}return E}});createPrototype(DateTimeModel,FieldModel.prototype);var SignatureModel=(function(C,A,B){FieldModel.call(this,C,A,B)});createPrototype(SignatureModel,FieldModel.prototype);var CompositeModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.getDefaultValue=function(){for(ind=0,len=C.COMPOSITEFIELDS.length;ind<len;ind++){var D=C.COMPOSITEFIELDS[ind];if(D.FIELDVALUE!=undefined&&D.FIELDVALUE!=""){return"composite"}}return""};this.getRecID=function(){return C.recID};this.getSubFieldLabelName=function(D){return C.COMPOSITEFIELDS[D].ACTUALLABEL};this.getActualLabelNameFromMapKey=function(G){var F=this.getFullCompositeFields();for(var E in F){var D=F[E];if(D.GMAPKEY==G){return D.ACTUALLABEL}}return null}});createPrototype(CompositeModel,FieldModel.prototype);var NameModel=(function(C,A,B){CompositeModel.call(this,C,A,B);var E={};for(ind=0,len=C.COMPOSITEFIELDS.length;ind<len;ind++){var D=C.COMPOSITEFIELDS[ind].ACTUALLABEL;E[D]=C.COMPOSITEFIELDS[ind];E[D].defaultData=B[D]}this.getCompositeFields=function(){return E};this.setCompositeField=function(F,G){E[F]=G};this.getFullCompositeFields=function(){return E}});createPrototype(NameModel,CompositeModel.prototype);var AddressModel=(function(C,A,B){CompositeModel.call(this,C,A,B);var H={};var E={};var F;for(ind=0,len=C.COMPOSITEFIELDS.length;ind<len;ind++){var D=C.COMPOSITEFIELDS[ind].ACTUALLABEL;var G=C.COMPOSITEFIELDS[ind].GMAPKEY;if(!(G=="latitude"||G=="longitude")){H[D]=C.COMPOSITEFIELDS[ind];H[D].defaultData=B[D]}else{E[D]=C.COMPOSITEFIELDS[ind];E[D].defaultData=B[D]}}this.getCompositeFields=function(){return H};this.setCompositeField=function(I,J){H[I]=J};this.getCoordinateFields=function(){return E};this.setCoordinateField=function(I,J){E[I]=J};this.getFullCompositeFields=function(){if(isNull(F)){F=$.extend(true,{},H,E)}return F};this.isCaptureGeoCoordinates=function(){return C.CAPTURE_GEO_COORDINATES};this.isAdjustLocation=function(){return C.ADJUST_LOCATION}});createPrototype(AddressModel,CompositeModel.prototype);var SubformModel=(function(J,S,B){FieldModel.call(this,J,S,B);var E={},N,P,G=true,A=false;if(J.SUBFORMFIELDS!=undefined){var F=J.SUBFORMFIELDS[0],C=R(F);if(F.SUBFORMROWNO==0){N=C}P=B.SUBFORM_RECORDS[0];for(var M=1,O=B.SUBFORM_RECORDS.length;M<O;++M){var T=$.extend(true,[],N);var I=B.SUBFORM_RECORDS[M];for(var L=0,K=T.length;L<K;++L){field=C[L];field.FIELDLABELNAME=J.FIELDLABELNAME+"."+I.IDFIELD+"."+field.ACTUALLABEL}H(T,I.IDFIELD);E[I.IDFIELD]={FIELDS:T,STATUS:I.RECSTATUS,ROWNO:I.SUBFORMROWNO,ROWKEY:I.IDFIELD,ID:I.ROWID,DATA:I}}}this.getNullRowFields=function(){var U=$.extend(true,[],N);H(U,"t::row_0");return U};this.getNullRowData=function(){return $.extend(true,[],P)};this.getFormLinkName=function(){return S.getFormLinkName()};this.getAppLinkName=function(){return S.getAppLinkName()};this.getRefFormLinkName=function(){return J.REFFORMLINKNAME};this.getRefAppLinkName=function(){return J.REFAPPLINKNAME};this.isNewSubform=function(){return J.ISNEWTYPESUBFORM=="true"};this.getDefaultRow=function(){return J.SUBFORMDEFROWS};this.getMaxRows=function(){return J.SUBFORMMAXROW};this.getCurrRows=function(){return Object.keys(E).length};this.getVoidRow=function(){return J.SUBFORMNULLROW};this.getSubformType=function(){return J.SUBFORMTYPE};this.getRefFormDispName=function(){return J.REFFORMDISPNAME};this.isEmptyRow=function(){return A};this.setEmptyRow=function(U){A=U};this.hasMoreRows=function(){return((this.getMaxRows()==-1)||(this.getCurrRows()<this.getMaxRows()))};this.addNewFields=function(X,W,V,U){E[X]={FIELDS:W,STATUS:"added",ROWNO:V,ROWKEY:X,DATA:U}};this.getFields=function(U){return E[U].FIELDS};this.getFirstFieldName=function(){var U=this.getNullRowFields().sort(function(X,W){var V=X.SEQUENCE_NUMBER,Y=W.SEQUENCE_NUMBER;return((V<Y)?-1:((V>Y)?1:0))});return(U.length>0)?U[0].ACTUALLABEL:""};this.getRow=function(U){return E[U]};this.renameRow=function(V,W,U){if(V!=W){E[V]=E[W]}};this.getSortedRow=function(){var U=[];for(key in E){U.push(E[key])}return U.sort(function(W,V){if(W.ROWNO>V.ROWNO){return 1}else{if(W.ROWNO<V.ROWNO){return -1}}return 0})};this.getFirstRow=function(){var U=Object.keys(E);return(U.length>0)?U[0]:undefined};this.getSubformField=function(V,U){if(V==undefined){var W=[];for(r in E){W.push(this.getSubformField(r,U))}return W}if(E[V]!=undefined){var X=E[V].FIELDS;for(M=0,K=X.length;M<K;M++){if(X[M].ACTUALLABEL==U){return X[M].CONTROLLER}}}};this.getControllers=function(U){var V=[],W=E[U].FIELDS;for(M=0,K=W.length;M<K;M++){V.push(W[M].CONTROLLER)}return V};this.getAllFields=function(){return E};this.isTopField=function(U){return(Object.keys(E)[0]==U)};this.deleteFields=function(U){delete E[U];return Object.keys(E).length};this.getAvailableRows=function(){return Object.keys(E)};function R(U){return U.SUBFORMROW}var Q=true,D=true;this.isAddLinkVisible=function(){return Q};this.setAddLinkVisiblity=function(U){Q=U};this.isDeleteLinkVisible=function(){return D};this.setDeleteLinkVisiblity=function(U){D=U};this.hasOnAddRow=function(){return J.SUBFORMHASADDROW};this.hasOnDeleteRow=function(){return J.SUBFORMHASDELETEROW};function H(X,Y){for(var W=0,U=X.length;W<U;++W){var V=S.getDynamicMeta(J.FIELDLABELNAME+"."+Y+"."+X[W].ACTUALLABEL);if(V!==undefined){$.extend(true,X[W],V)}}}this.getAccessType=function(){return S.getAccessType()};this.getRandStr=function(){return S.getRandStr()}});createPrototype(SubformModel,FieldModel.prototype);var ImageModel=(function(C,A,B){FieldModel.call(this,C,A,B);var D={1:"new",2:"same"};this.getImageType=function(){return C.IMAGETYPE};this.getImageSRC=function(){return B.imgSRC};this.isAltReq=function(){return C.ISALTREQ};this.isLinkReq=function(){return C.ISLINKNAMEREQ};this.isTitleReq=function(){return C.ISTITLEREQ};this.isLocalImgSRC=function(){return B.isLocalImgSRC};this.getImageTarget=function(){return D[C.IMAGETARGET]};this.setImageTarget=function(E){if(E!=undefined){C.IMAGETARGET=E}};this.getImageSelectedType=function(){return B.zcImgType};this.setDefaultValue=function(E){C.FIELDVALUE=E}});createPrototype(ImageModel,FieldModel.prototype);var FileUploadModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.isOneFileUpload=function(){return C.ISONEFILEUPLOAD};this.hasBrowse=function(){return C.ISBROWSE};this.getCloudService=function(){return C.CLOUDSERVICE};this.isPickerRestricted=function(){return C.ISPICKERRESTRICTED}});createPrototype(FileUploadModel,FieldModel.prototype);var AudioModel=(function(C,A,B){FieldModel.call(this,C,A,B)});createPrototype(AudioModel,FieldModel.prototype);var VideoModel=(function(C,A,B){FieldModel.call(this,C,A,B)});createPrototype(VideoModel,FieldModel.prototype);var RichTextModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.getToolbarConfig=function(){var E=C.RTETTOOLSJSON;ZE_Init.needplaintext=false;ZE_Init.needEditorFocus=false;if(ZCGlobal.appDirectionMeta.isRTL){ZE_Init.isRTL=true}var D={editorheight:C.FIELDHIEGTH,toolbar:E,fontsize:C.RTETFONTJSON,fontfamily:C.RTETFONTFAMILYJSON};return D}});createPrototype(RichTextModel,FieldModel.prototype);var SelectModel=(function(E,C,D){FieldModel.call(this,E,C,D);var A={},B=true;var F={};var H={};this.isAddedToParent=false;this.constructId=function(I){H.id=I};this.constructText=function(I){H.text=I};this.getConstructedVal=function(){return H};function G(I){if(A[I]==undefined){A[I]={data:[],isSaturated:false,currPage:1}}}this.isLookup=function(){return E.ISLOOKUP};this.isDynamicLookup=function(){return E.IS_DYNAMIC_LOOKUP};this.isLiveVariableCriteriaLookup=function(){return E.IS_LIVE_VAR_CRITERIA_LOOKUP};this.isIntegrationField=function(){return E.ISINTEGRATIONFIELD};this.getFormComponentID=function(){return E.FIELDCOMPID};this.isExternalField=function(){return((this.getComponentType()==FieldType.POPUP_SINGLE||this.getComponentType()==FieldType.EXTERNAL_FIELD)&&!E.IsIntegrationField)};this.isFormLookup=function(){return !this.isExternalField()&&this.getComponentType()!=FieldType.SYSTEM_LOOKUP&&E.ISLOOKUP};this.getChoiceCount=function(){var I=JSON.parse(E.FIELDCHOICES);return I!=undefined?I.length:-1};this.getChoiceColumn=function(){return E.CHOICECOLUMN};this.getDisplayField=function(){return E.EXTDISPLAYFIELD};this.getServiceType=function(){return E.EXTSERVICETYPE};this.getModuleType=function(){return E.EXTMODULE};this.isSearchEnabled=function(){return E.ISSEARCHFIELD=="true"};this.isSelectField=function(){return E.ISSELECTFIELD};this.isRequestCompleted=function(){return B};this.isOtherEnabled=function(){return E.ISOTHERENABLED};this.isSingleSelect=function(){if(this.getComponentType()==FieldType.SYSTEM_LOOKUP){return this.getSystemDisplayType()==100?true:false}return !(this.getComponentType()==FieldType.CHECK_BOXES||this.getComponentType()==FieldType.LIST)};this.sendingReq=function(){B=false};this.reqCompleted=function(){B=true};this.getChoices=function(I){G(I);return A[I].data};this.getAuxFieldChoices=function(){return F};this.isCached=function(I){return(A[I]!=undefined)};this.isPredefinedChoices=function(K){var L=this.getChoices("");for(var J in L){var I=L[J];if(I.id==K){return true}}return false};this.hasChoice=function(K){if(this.isLookup()){return true}var L=this.getChoices("");for(var J in L){var I=L[J];I.id=this.decodeChoices(I.id);if(I.id==K){return true}}return false};this.getCacheTerm=function(L){var M=Object.keys(A);for(var K=1,I=L.length-1;K<=I;K++){var J=L.substring(0,K);if(M.indexOf(J)!=-1&&A[J].isSaturated){return J}}return L};this.clearChoices=function(){A={};A[""]={data:[],isSaturated:true,currPage:1}};this.isSaturated=function(I){G(I);return A[I].isSaturated};this.resetLoadLookup=function(){A[""].isSaturated=false};this.getCurrentPage=function(I){G(I);return A[I].currPage};this.Markup=function(I){return I.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&nbsp;/g," ")};this.decodeChoices=function(K){var L=document.createElement("textarea");if(jQuery.type(K)!="string"){for(var J in K){if(K[J].id instanceof Object){var M=K[J].id;for(var I in M){M[I]=decode(L,M[I])}K[J].id=M}else{K[J].id=decode(L,K[J].id)}K[J].text=decode(L,K[J].text)}}else{K=decode(L,K)}return K};this.addChoices=function(J,L,I,M){var K=I.data;if(this.isIntegrationField()){K=I.data[0];F=$.extend(F,I.data[1])}if(M){I.data=this.decodeChoices(K)}G(J);A[J].data=A[J].data.concat(K);A[J].isSaturated=I.isSaturated;A[J].currPage=L};this.addChoicesWithOutRedendency=function(L,N,J){J.data=this.decodeChoices(J.data);G(L);for(var K in J.data){var I=false;for(var M in A[L].data){if(A[L].data[M].id==J.data[K].id){I=true;break}}if(!I){this.addChoice(L,J.data[K],N)}}};this.addChoice=function(I,K,J){G(I);A[I].data=A[I].data.concat(K);if(J!=undefined){A[I].currPage=J}this.isAddedToParent=true};this.appendChoices=function(I){var J=A[""];A={};A[""]=J;this.addChoices("",J.currPage,{data:I,isSaturated:J.isSaturated},true);return A};this.hasAddToParent=function(){return E.HASLOOKUPADD};this.getAddToParentText=function(){return E.LOOKUPADDTEXT};this.getRefFormLinkName=function(){return E.REFFORMLINKNAME};this.getRefAppLinkName=function(){return E.REFAPPLINKNAME};this.getRefFieldLabel=function(){return E.REFFORMCOMP};this.isLookupAddRestricted=function(){return E.RESTRICTLOOKUPADD};this.getSystemDisplayType=function(){var I=E.SYSTEMDISPLAYTYPE!=undefined?E.SYSTEMDISPLAYTYPE:100;return I};if(!this.isExternalField()&&!this.isIntegrationField()){if(this.getGMAPKEY()==="country"){this.addChoices("",1,{data:Constants.COUNTRY_DATA,isSaturated:E.ISSATURATED},false)}else{this.addChoices("",1,{data:JSON.parse(E.FIELDCHOICES),isSaturated:E.ISSATURATED},false)}}});createPrototype(SelectModel,FieldModel.prototype);var URLModel=(function(C,A,B){FieldModel.call(this,C,A,B);var D={1:"new",2:"same"};this.isLinkNameReq=function(){return C.ISLINKNAMEREQ};this.isTitleReq=function(){return C.ISTITLEREQ};this.getURLTarget=function(){return D[C.urlTarget]};this.setURLTarget=function(E){if(E!=undefined){C.urlTarget=E}}});createPrototype(URLModel,FieldModel.prototype);var SingleSelectModel=(function(C,A,B){SelectModel.call(this,C,A,B);this.getDefaultValue=function(){if(B.FIELDVALUE!=""&&B.FIELDVALUE!=undefined){return this.decodeChoices([B.FIELDVALUE])[0]}};this.setDefaultValue=function(D){B.FIELDVALUE=D};this.getIntegrationFieldValue=function(){if(B.FIELDVALUE!=""&&B.FIELDVALUE!=undefined){var D={};D.id=B.FIELDVALUE.id;D.text=$.isEmptyObject(this.getAuxFieldChoices())?B.FIELDVALUE.actualText:this.getAuxFieldChoices()[D.id];return D}};this.getExternalFieldID=function(){return C.EXTIDLABEL};this.getOthersOption=function(){return C.OTHERSOPTION}});createPrototype(SingleSelectModel,SelectModel.prototype);var DropdownModel=(function(C,A,B){SingleSelectModel.call(this,C,A,B);this.getIntegRecCount=function(){return C.integRecCount};this.setIntegRecCount=function(D){C.integRecCount=D}});createPrototype(DropdownModel,SingleSelectModel.prototype);var RadioModel=(function(C,A,B){SingleSelectModel.call(this,C,A,B)});createPrototype(RadioModel,SingleSelectModel.prototype);var MultipleSelectModel=(function(C,A,B){SelectModel.call(this,C,A,B);this.getDefaultValue=function(){var F=[];if(B.FIELDVALUE!=""&&B.FIELDVALUE!=undefined){for(i=0;i<B.FIELDVALUE.length;i++){var G=B.FIELDVALUE[i];var E=false;for(var D=0;D<F.length;D++){if(F[D].id==G.id){B.FIELDVALUE.splice(i--,1);E=true;break}}if(!E){F.push(G)}}return this.decodeChoices(F)}return F};this.setDefaultValue=function(D){B.FIELDVALUE=D}});createPrototype(MultipleSelectModel,SelectModel.prototype);var MultiSelectModel=(function(C,A,B){MultipleSelectModel.call(this,C,A,B)});createPrototype(MultiSelectModel,MultipleSelectModel.prototype);var CheckBoxModel=(function(C,A,B){MultipleSelectModel.call(this,C,A,B)});createPrototype(CheckBoxModel,MultipleSelectModel.prototype);var PhoneNumberModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.getDefaultCountryCode=function(){return C.DEFAULTCOUNTRY};this.getCountryList=function(){return C.ALLOWEDCOUNTRIES}});createPrototype(PhoneNumberModel,FieldModel.prototype);var ExternalModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.getExternalURL=function(){return C.EXTERNALURL}});createPrototype(ExternalModel,FieldModel.prototype);var IntegrationModel=(function(M,I,C){FieldModel.call(this,M,I,C);var J={};var G={};var D={};var K=[];var N,O;var H=false;var E=0;var L=0;var P=0;var F=false;var A=false;var B=false;this.isIntegrationField=function(){return M.ISINTEGRATIONFIELD};this.setFieldValue=function(Q){C.FIELDVALUE=Q};this.getFieldValue=function(){return C.FIELDVALUE};this.getRecordCount=function(){return this.recordCount};this.setRecordCount=function(Q){this.recordCount=Q};this.getSearchCount=function(){return this.searchCount};this.setSearchCount=function(Q){this.searchCount=Q};this.getColumnHeaders=function(){return M.DISPLAYFIELDS};this.getFieldChoice=function(Q){return J[Q]};this.getSearchChoice=function(Q){return G[Q]};this.getFieldChoices=function(){return J};this.getSearchChoices=function(){return G};this.clearSearchChoices=function(){this.searchFieldChoices={}};this.addFieldChoices=function(Q){J=this.getFieldChoices?$.extend(this.getFieldChoices(),Q[0]):$.extend([],Q[0])};this.addSearchChoices=function(Q){G=this.getSearchChoices?$.extend(this.getSearchChoices(),Q[0]):$.extend([],Q[0])};this.setSaturation=function(Q){this.saturation=Q};this.isSaturated=function(){return this.saturation};this.setSearchSaturation=function(Q){this.searchSaturation=Q};this.isSearchSaturated=function(){return this.searchSaturation};this.setEmptySearch=function(Q){this.emptySearch=Q};this.isEmptySearch=function(){return this.emptySearch};this.isSearchQuery=function(){return O};this.setSearchQuery=function(Q){O=Q};this.setSearchInputs=function(Q){K=Q};this.getSearchInputs=function(){return K};this.setInProgress=function(Q){this.inProgress=Q};this.getInProgress=function(){return this.inProgress};this.getCurrentDisplayCount=function(){return this.currentDisplayCount};this.setCurrentDisplayCount=function(Q){this.currentDisplayCount=Q};this.isActive=function(){return this.activeField};this.setActive=function(Q){this.activeField=Q}});createPrototype(IntegrationModel,FieldModel.prototype);var FormDOM=(function(A){this.getFormContainer=function(){return document.getElementById(A.getFormLinkName()+"_"+A.getRandStr())};this.getFormDOM=function(){return document.querySelector("div[id='"+A.getFormLinkName()+"_"+A.getRandStr()+"'] form[name='"+A.getFormLinkName()+"']")};this.getForm=function(){return $(this.getFormDOM())};this.getFormOuterWrapper=function(){return $(this.getFormContainer().querySelector(".formContainer"))};this.getSubmitButton=function(){return $(this.getFormDOM().querySelector("input[type=submit]"))};this.getResetButton=function(){return $(this.getFormDOM().querySelector("input[type=reset]"))};this.getCancelButton=function(){return $(this.getFormDOM().querySelector('input[type=button][elName="zc-cancelformbutton"]'))};this.getFormSettingsIcon=function(){return $(this.getFormContainer().querySelector('span[elname="zc-moreactionsel"]'))};this.getFormSettingsMenu=function(){return $(this.getFormContainer().querySelector('ul[elname="zc-formOptionsDIV"]'))};this.getInfoLink=function(){return $(this.getFormContainer().querySelector("#form-info-link"))};this.getErrorMsgCont=function(){return $(this.getFormContainer().querySelector("#form-error-msg"))};this.getButton=function(B){return $(this.getFormDOM().querySelector('input[name="'+B+'"]'))};this.getAutoSubmitBtn=function(){var B=this.getForm().find('input[type="submit"],[type="reset"],[type="button"]');return $(B).filter("[autosubmit=true]")};this.getCaptchaInput=function(){return $(this.getFormDOM().querySelector('input[elname="zc-captcha-input"][name=captcha]'))};this.getCaptchaDigest=function(){return this.getForm().find(':input[elname="zc-captcha-digest"][name=cdigest]')};this.getCaptchaImg=function(){return $(this.getFormDOM().querySelector('img[elname="zc-captcha"]'))};this.getResetCaptchIcon=function(){return $(this.getFormDOM().querySelector('div[name="zc-captcha"]')).find("#refreshCaptcha")};this.getFormOverlay=function(){return $(this.getFormContainer().querySelector("#form-overlay"))};this.getFormProgress=function(){return $(this.getFormContainer().querySelector("#form-overlay-progress"))};this.getBulkEditInput=function(){return $(this.getFormDOM().querySelector("input[name=bulkeditFields]"))};this.getGeoOverlay=function(){return $(this.getFormContainer()).parent().find("#geo-overlay")}});FormDOM.prototype=Object.create(DOMFactory.prototype);FormDOM.prototype.constructor=FormDOM;var FieldDOM=(function(C,B){DOMFactory.call(this,C);var A=B;this.getFieldDOM=function(){var E=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();var D=$(B.getForm());if(D.hasClass("zc-right-panel")||D.hasClass("popupConentContainer")){var F=D[0].querySelector('input[name="'+C.getLabelName()+'"]');if(F!=null){return F}else{return D[0].querySelector('select[name="'+C.getLabelName()+'"]')}}else{var F=document.querySelector("div[id='"+E.getFormLinkName()+"_"+E.getRandStr()+"'] form[name='"+E.getFormLinkName()+"']");if(F!=null&&$(F.querySelector("input[name='"+C.getLabelName()+"']")).length){return F.querySelector("input[name='"+C.getLabelName()+"']")}else{if(F!=null){return F.querySelector("select[name='"+C.getLabelName()+"']")}}}};this.getField=function(){return $(this.getFieldDOM())};this.getFieldParent=function(){return this.getField().closest(".form-field")};this.getFieldParentGroup=function(){return this.getFieldParent().parent(".form-group")};this.getDropDownWrapper=function(){return $(this.getField()).prev("div")}});createPrototype(FieldDOM,DOMFactory.prototype);var CurrencyDOM=(function(C,B){FieldDOM.call(this,C,B);var A=B;this.getFieldDOM=function(){return B.getFormDOM().querySelector('input[name="'+C.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getFieldParent=function(){return this.getField().closest(".form-field")}});createPrototype(FieldDOM,DOMFactory.prototype);var DropdownDOM=(function(B,A){FieldDOM.call(this,B,A);this.getSearchBoxContainer=function(){return $("."+B.getActualLabelName()+"-switch-search .select2-search")};this.getOtherValueContainer=function(){return $((this.getField().closest(".form-field")).find('div[elname="othersinput"]'))};this.getOtherValueField=function(){var C=(this.getOtherValueContainer())[0];if(C){return $(C.querySelector("input"))}return this.getOtherValueContainer().find("input")}});createPrototype(DropdownDOM,FieldDOM.prototype);var DateTimeDOM=(function(B,A){FieldDOM.call(this,B,A);this.getCalIcon=function(){return $(A.getFormDOM().querySelector('span[id="dateButtonEl_'+B.getLabelName()+'"]'))}});createPrototype(DateTimeDOM,FieldDOM.prototype);var ImageDOM=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('div[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getImageIcons=function(){return this.getField()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){return $(this.getFieldDOM().querySelector("input[type=file]")).parent()};this.getFileInputEl=function(){return $(this.getFieldDOM().querySelector("input[type=file]"))};this.getFileValue=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'-LOCAL"]'))};this.getSourceCompDiv=function(){return this.getSourceComp().parent()};this.getSourceComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'.source"]'))};this.getImgOptionsCont=function(){return $(this.getFieldDOM().querySelectorAll(".imageOpts"))};this.getAltComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'.alt"]'))};this.getLinkComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'.link"]'))};this.getTitleComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'.title"]'))}});createPrototype(ImageDOM,FieldDOM.prototype);var URLDOM=(function(B,A){FieldDOM.call(this,B,A);this.getTextField=function(){return $(this.getFieldDOM().querySelector("input[type=text]"))};this.getFieldDOM=function(){return A.getFormDOM().querySelector('div[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getURLComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'.url"]'))};this.getUrlOptions=function(){return $(this.getFieldDOM().querySelectorAll(".urlOpts"))};this.getLinkComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'.link"]'))};this.getTitleComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+B.getLabelName()+'.title"]'))}});createPrototype(URLDOM,FieldDOM.prototype);var FileUploadDOM=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('input[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getUploadElement=function(){return this.getFileInput()};this.getImageIcons=function(){return this.getField().parent()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){var C=(this.getField().parent())[0];if(C){return $(C.querySelector("input[type=file]"))}return this.getField().parent().querySelector("input[type=file]")}});createPrototype(FileUploadDOM,FieldDOM.prototype);var AudioDOM=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('input[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getUploadElement=function(){return this.getFileInput()};this.getImageIcons=function(){return this.getField().parent()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){var C=(this.getField().parent())[0];if(C){return $(C.querySelector("input[type=file]"))}return this.getField().parent().find("input[type=file]")}});createPrototype(AudioDOM,FieldDOM.prototype);var VideoDOM=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('input[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getUploadElement=function(){return this.getFileInput()};this.getImageIcons=function(){return this.getField().parent()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){var C=(this.getField().parent())[0];if(C){return $(C.querySelector("input[type=file]"))}return this.getField().parent().find("input[type=file]")}});createPrototype(VideoDOM,FieldDOM.prototype);var TextAreaDOM=(function(C,B){FieldDOM.call(this,C,B);var A=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();this.getFieldDOM=function(){if($(B.getForm()).hasClass("zc-right-panel")||$(B.getForm()).hasClass("popupConentContainer")){return B.getFormDOM().querySelector('textarea[name="'+C.getLabelName()+'"]')}else{return document.querySelector("div[id='"+A.getFormLinkName()+"_"+A.getRandStr()+"'] form[name='"+A.getFormLinkName()+"'] textarea[name='"+C.getLabelName()+"']")}};this.getField=function(){return $(this.getFieldDOM())}});createPrototype(TextAreaDOM,FieldDOM.prototype);var RichTextDOM=(function(B,A){TextAreaDOM.call(this,B,A);this.getRTDiv=function(){return $(this.getField()).siblings('div[name="'+B.getLabelName()+'"]')}});createPrototype(RichTextDOM,TextAreaDOM.prototype);var ExternalDOM=(function(B,A){FieldDOM.call(this,B,A);this.getActionLink=function(){return $((this.getField().parent())[0].querySelector("a[elname=showModule]"))};this.getClearLink=function(){return $((this.getField().parent())[0].querySelector("a[elname=clearModule]"))}});createPrototype(ExternalDOM,FieldDOM.prototype);var RadioDOM=(function(B,A){DropdownDOM.call(this,B,A);this.getFieldDOM=function(){var C=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();if(B.isSearchEnabled()||B.isSubformField()){if($(A.getForm()).hasClass("popupConentContainer")){return A.getFormDOM().querySelector('input[name="'+B.getLabelName()+'"]')}else{return document.querySelector("div[id='"+C.getFormLinkName()+"_"+C.getRandStr()+"'] form[name='"+C.getFormLinkName()+"'] input[name='"+B.getLabelName()+"']")}}else{if($(A.getForm()).hasClass("popupConentContainer")){return A.getFormDOM().querySelector('div[name="parentOf-'+B.getLabelName()+'"]')}else{return document.querySelector("div[id='"+C.getFormLinkName()+"_"+C.getRandStr()+"'] form[name='"+C.getFormLinkName()+"'] div[name='parentOf-"+B.getLabelName()+"']")}}};this.getField=function(){return $(this.getFieldDOM())};this.getOptionsDiv=function(){return $(A.getFormDOM().querySelector('div[name="parentOf-'+B.getLabelName()+'"]'))};this.getOtherTemplate=function(){var C=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();return'<div class="choice-table-cell"><span><input id="'+C.getRandStr()+"_othersVal"+B.getFormComponentId()+'" elname="othersVal'+B.getFormComponentId()+'" class="customRadio zc_radio" name="'+B.getLabelName()+'" type="radio" value="-otherVal-" title="'+B.getTitle()+'"><label title="'+B.getTitle()+'" for="'+C.getRandStr()+"_othersVal"+B.getFormComponentId()+'" elname="othersVal'+B.getFormComponentId()+'"></label><label for="'+C.getRandStr()+"_othersVal"+B.getFormComponentId()+'" elname="othersVal'+B.getFormComponentId()+'" title="'+B.getTitle()+'">'+B.getOthersOption()+"</label> </span></div>"};this.getOptionTemplate=function(){var C=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();return'<div class="choice-table-cell"><span><input id="'+C.getRandStr()+"_radioEl_zc-"+B.getLabelName()+'_${INDEX}" class="customRadio" elname="radioEl_zc-'+B.getLabelName()+'_${INDEX}" class="customRadio" name="'+B.getLabelName()+'" title="'+B.getTitle()+'" type="radio" value="${CHOICE.ID}"><label for="'+C.getRandStr()+"_radioEl_zc-"+B.getLabelName()+'_${INDEX}" elname="radioEl_zc-'+B.getLabelName()+'_${INDEX}" title="'+B.getTitle()+'"></label><label for="'+C.getRandStr()+"_radioEl_zc-"+B.getLabelName()+'_${INDEX}" elname="radioEl_zc-'+B.getLabelName()+'_${INDEX}" title="'+B.getTitle()+'">${CHOICE.TEXT}</label> </span></div>'}});createPrototype(RadioDOM,DropdownDOM.prototype);var CheckboxDOM=(function(B,A){DropdownDOM.call(this,B,A);this.getFieldDOM=function(){var C=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();if(B.isSearchEnabled()||B.isSubformField()){if($(A.getForm()).hasClass("popupConentContainer")){return A.getFormDOM().querySelector('input[name="'+B.getLabelName()+'"]')}else{return document.querySelector("div[id='"+C.getFormLinkName()+"_"+C.getRandStr()+"'] form[name='"+C.getFormLinkName()+"'] input[name='"+B.getLabelName()+"']")}}else{if($(A.getForm()).hasClass("popupConentContainer")){return A.getFormDOM().querySelector('div[name="parentOf-'+B.getLabelName()+'"]')}else{return document.querySelector("div[id='"+C.getFormLinkName()+"_"+C.getRandStr()+"'] form[name='"+C.getFormLinkName()+"'] div[name='parentOf-"+B.getLabelName()+"']")}}};this.getField=function(){return $(this.getFieldDOM())};this.getOptionsDiv=function(){return $(A.getFormDOM().querySelector('div[name="parentOf-'+B.getLabelName()+'"]'))};this.getOptionTemplate=function(){var C=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();return'<div class="choice-table-cell"><label><span><input id="'+C.getRandStr()+"_checkboxesEl_zc-"+B.getLabelName()+'_${INDEX}" elname="checkboxesEl_zc-'+B.getLabelName()+'_${INDEX}"  class="customCheckbox" name="'+B.getLabelName()+'" type="checkbox" title="" value="${CHOICE.ID}"><label for="'+C.getRandStr()+"_checkboxesEl_zc-"+B.getLabelName()+'_${INDEX}" elname="checkboxesEl_zc-'+B.getLabelName()+'_${INDEX}"  title="'+B.getTitle()+'"></label><label for="'+C.getRandStr()+"_checkboxesEl_zc-"+B.getLabelName()+'_${INDEX}" elname="checkboxesEl_zc-'+B.getLabelName()+'_${INDEX}"  title="'+B.getTitle()+'">${CHOICE.TEXT}</label></span></label></div>'}});createPrototype(CheckboxDOM,DropdownDOM.prototype);var SubformDOM=(function(B,A){FieldDOM.call(this,B,A);var C;this.getFormDOM=function(){return(C!=undefined)?C[0]:this.getField()[0]};this.getForm=function(){return(C!=undefined)?C:this.getField()};this.setRow=function(D){C=D};this.getRow=function(E){var D=(this.getInnerWrapper())[0];if(D){return $(D.querySelector('div[elName=dataRow][rowNo="'+E+'"]'))}return this.getInnerWrapper().find('div[elName=dataRow][rowNo="'+E+'"]')};this.getDeleteLink=function(E){var D=(this.getRow(E))[0];if(D){return $(D.querySelector('a[elname="zc-hideFormFieldEl"]'))}return this.getRow(E).find('a[elname="zc-hideFormFieldEl"]')};this.getFieldDOM=function(){var E=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();var D=$(A.getForm());if(D.hasClass("popupConentContainer")){return D[0].querySelector('input[name="'+B.getLabelName()+'"]')}else{return document.querySelector("div[id='"+E.getFormLinkName()+"_"+E.getRandStr()+"'] form[name='"+E.getFormLinkName()+"'] div[name='"+B.getLabelName()+"']")}};this.getField=function(){return $(this.getFieldDOM())};this.getAddNewLink=function(){var D=(this.getField().parent())[0];if(D){return $(D.querySelectorAll("span.add_value_link > a"))}return this.getField().parent().find("span.add_value_link > a")};this.getBottomAddNewLink=function(){return this.getField().siblings("#"+B.getLabelName()+"_addNewLine")};this.getDeleteLinks=function(){var D=(this.getField().parent())[0];if(D){return $(D.querySelectorAll('a[elname="zc-hideFormFieldEl"]'))}return this.getField().parent().find('a[elname="zc-hideFormFieldEl"]')};this.getPlaceHolder=function(){return $(this.getFieldDOM().querySelector("#subformplaceholder"))};this.getInnerWrapper=function(){return $(this.getFieldDOM().querySelectorAll(".subform-inner-wrapper"))};this.getScrollWrapper=function(){return $(this.getFieldDOM().querySelectorAll(".subform-scroll-wrapper"))}});createPrototype(SubformDOM,FieldDOM.prototype);var CompositeDOM=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('div[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getChildField=function(C){return $(this.getFieldDOM().querySelector("input[name='"+C+"'] , select[name='"+C+"']"))};this.getDropdown=function(C){return $(this.getFieldDOM().querySelector("select[name='"+C+"']"))};this.getChildByDisplayName=function(C){return $(this.getFieldDOM().querySelectorAll("span[display-name='"+C+"']"))};this.getAllChildFields=function(){return $(this.getFieldDOM().querySelectorAll("span[class*=-wrapper]"))}});createPrototype(CompositeDOM,FieldDOM.prototype);var AddressDOM=(function(B,A){CompositeDOM.call(this,B,A);this.getPrimaryOuterEl=function(){return $(this.getFieldDOM().querySelectorAll(".ADDRESS_LINE_1-wrapper"))};this.getPostalCodeEl=function(){return $(this.getFieldDOM().querySelectorAll(".POSTAL_CODE-wrapper"))};this.getPrimarySelectFld=function(){return $(this.getPrimaryOuterEl()[0].querySelectorAll("input.form-control"))};this.getPrimaryInput=function(){return $(this.getFieldDOM().querySelector("input[type=text]"))};this.getCountrySelect=function(){return $(this.getFieldDOM().querySelector("input.country-sel"))};this.getDropDownWrapper=function(){return $(this.getCountrySelect()).prev("div")};this.getInputFields=function(){return $(this.getFieldDOM().querySelectorAll("input[type=text]"))};this.getAdjustLocationIcon=function(){return $(this.getFieldDOM().querySelectorAll(".zc-adjustLocationIcon"))};this.getLocationContainer=function(){return $(this.getFieldDOM().querySelectorAll(".zc-location-container"))};this.getAdjustLocationWrapper=function(){return $(this.getFieldDOM().querySelectorAll(".zc-adjust_location-wrap"))};this.getLocationPlaceHolder=function(){return $(this.getFieldDOM().querySelectorAll(".zc-location-placeholder"))};this.getCoordinateInputs=function(){return $(this.getFieldDOM().querySelectorAll(".zc-adjust-latitude, .zc-adjust-longitude"))}});createPrototype(CompositeDOM,FieldDOM.prototype);var NameDOM=(function(B,A){CompositeDOM.call(this,B,A);this.getPrefixSelect=function(){return $(this.getFieldDOM().querySelector("select.prefix-sel"))};this.getPrimaryInput=function(){return $(this.getFieldDOM().querySelector("input[type=text]"))};this.getInputFields=function(){return $(this.getFieldDOM().querySelectorAll("input[type=text]"))};this.getDropDownWrapper=function(){return $(this.getPrefixSelect()).prev("div")}});createPrototype(NameDOM,CompositeDOM.prototype);var PhoneNumberDOM=(function(B,A){FieldDOM.call(this,B,A);this.getAllPhoneFields=function(){return $(A.getFormDOM().querySelectorAll(".form-phone-field input[type='tel']"))};this.getFlagContainer=function(){var C=(this.getFieldParent())[0];if(C){return $((this.getFieldParent())[0].querySelectorAll(".flag-container"))}return this.getFieldParent().find(".flag-container")}});createPrototype(PhoneNumberDOM,FieldDOM.prototype);var SignatureDOM=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('div[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getSignatureContainer=function(){return $(this.getFieldDOM().querySelector("div[elName=signatureEle]"))};this.getSignatureTextarea=function(){return $(this.getFieldDOM()).find('textarea[name="'+B.getLabelName()+'"]')};this.getSignature=function(){return $(this.getFieldDOM().querySelector("div[eleName=signature]"))};this.getClearEle=function(){return $(this.getFieldDOM().querySelector("a[eleName=signatureClear]"))};this.getToggleChangeEle=function(){return $(this.getFieldDOM().querySelector("a[eleName=zc-togglesignature]"))};this.getToggleRestoreEle=function(){return $(this.getFieldDOM().querySelector("a[eleName=zc-togglesignature-restore]"))};this.getEditEle=function(){return $(this.getFieldDOM().querySelector("div[elName=editEle-signature]"))}});createPrototype(SignatureDOM,FieldDOM.prototype);var PlainTextDom=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('div[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())}});createPrototype(PlainTextDom,FieldDOM.prototype);var SectionDom=(function(B,A){FieldDOM.call(this,B,A);this.getFieldDOM=function(){return A.getFormDOM().querySelector('div[name="'+B.getLabelName()+'"]')};this.getField=function(){return $(this.getFieldDOM())};this.getSectionRow=function(){return this.getField().parents("[elname=formRow]")}});createPrototype(SectionDom,FieldDOM.prototype);var DecisionBoxDOM=(function(B,A){FieldDOM.call(this,B,A);this.getFieldParent=function(){return this.getField().closest(".decision-box-field")}});createPrototype(DecisionBoxDOM,FieldDOM.prototype);var IntegrationDOM=(function(B,A){FieldDOM.call(this,B,A);this.getOptionsDOM=function(){return $("body").find("#zc-combined-lookup-popup")};this.getScrollMask=function(){return $("body").find(".zc-scroll-mask")};this.getInputField=function(){return this.getField()};this.getOptionsTable=function(){return this.getOptionsDOM().find("#combinedlookupoptionstable")};this.getSearchOptionsTable=function(){return this.getOptionsDOM().find(".zc-combined-lookup-search-table")};this.getSearchHeader=function(){return this.getOptionsDOM().find("#combinedlookupsearchtable")};this.getSearchTableHeader=function(){return this.getOptionsDOM().find("thead")};this.getSearchLayout=function(){return this.getOptionsTable().find("tbody[layoutType=search]")};this.getOptionsLayout=function(){return this.getOptionsTable().find('tbody[layoutType="options"]')};this.getDefaultLayout=function(){return this.getOptionsTable().find("tbody[layoutType=default]")};this.getMessageContainer=function(){return this.getDefaultLayout().find("#combinedlookupmessagecontainer")};this.getCurrentLayout=function(){return this.getOptionsTable().find("tbody:visible:first")};this.getHighlightedRow=function(){return this.getCurrentLayout().find(".combined-lookup-row-highlighted")};this.getSearchSpinner=function(){return this.getOptionsDOM().find(".zc-combined-lookup-spinner")};this.getValueDeselectButton=function(){return this.getField().parent().find(".zc-integration-close")};this.getDropArrow=function(){return this.getField().parent().find(".zc-integration-drop-arrow")};this.getSearchBoxes=function(){return this.getSearchTableHeader().find("input")}});createPrototype(IntegrationDOM,FieldDOM.prototype);var FormView=(function(A,B){ViewFactory.call(this,A);this.bindSubmit=function(C){$(A.getForm()).submit(function(D){D.preventDefault();if(C==1){B.submitForm()}})};this.getFormContainer=function(){return $(A.getFormDOM().querySelector(".formContainer"))};this.bindScrollEvents=function(){$(A.getFormContainer()).scroll(function(C){$(document).trigger("scrollChange",C)})};this.fixFormHeader=function(){this.adjustFormHeight()};this.adjustFormHeight=function(){$(A.getFormDOM().querySelector(".zc-form-scroll-wrapper")).css("max-height",this.getScrollHeight())};this.getScrollHeight=function(){var C=this.findElementHeigth("form-header"),D=this.findElementHeigth("zc-form-footer"),E=($("#zc-component").height()-C-D),F=this.getFormContainerPadding();return(E-F)};this.getFormContainerPadding=function(){var C=this.getFormContainer();return C.outerHeight()-C.height()};this.getFormContainerLeftRightPadding=function(){var C=this.getFormContainer();return C.outerWidth()-C.width()};this.findFormContainerHeight=function(){return A.getForm().closest(".form-outer-wrapper")[0].getBoundingClientRect().height};this.findElementHeigth=function(C){return A.getFormDOM().querySelector("."+C).getBoundingClientRect().height};this.findFieldLabelWidth=function(C){return A.getFormDOM().querySelector("."+C).getBoundingClientRect().width};this.plainTextWidth=function(C){return A.getFormDOM().querySelector("div[name='"+C.substring(3)+"']").getBoundingClientRect().width};this.findCaptchaLabelWidth=function(){var C=B.getModel();var D=$(A.getFormDOM().querySelector("div[name='zc-captcha']")).parent();return(C.hasCaptcha())?D[0].querySelector(".form-label").getBoundingClientRect().width:0};this.findFieldInputWidthEveryColumn=function(C){var D=A.getFormDOM().querySelector(".column-block ."+C+"-group > .form-field");if(D!=null){return D.getBoundingClientRect().width}return 0};this.decisionBoxLabelWidth=function(C){labelWidth=$(A.getFormDOM().querySelector("."+C+" .decision-box-label")).css("width");labelWidth=labelWidth.substring(0,labelWidth.length-2);return Number(labelWidth)};this.decisionBoxInputWidth=function(C){C=C.substring(3,C.length);inputWidth=$(A.getFormDOM().querySelector("input[name='"+C+"']")).css("width");inputWidth=inputWidth.substring(0,inputWidth.length-2);return Number(inputWidth)};this.disableButton=function(C){this.getButton(C).attr("disabled","disabled")};this.enableButton=function(C){this.getButton(C).removeAttr("disabled")};this.getContainerWidth=function(){return A.getFormDOM().getBoundingClientRect().width};this.showFormInfo=function(C){A.getInfoLink().show();A.getInfoLink().find("a").click(function(){B.showInfo(C)})};this.hideFormInfo=function(){A.getInfoLink().hide()};this.showFormErrorInfo=function(C){A.getErrorMsgCont().show().html(C)};this.hideFormErrorInfo=function(){A.getErrorMsgCont().hide()};this.addStyleToForm=function(I,E){this.removeStyleFromForm();var G=A.getFormDOM().querySelector("#"+I);var F=G.sheet;var D=E.split("\n");for(var C in D){var H=D[C];if(!isNull(H)){F.insertRule(H,C)}}return G};this.removeStyleFromForm=function(){if(!$("#zppagesLive")[0]){$(document.querySelectorAll(".page_content_wrapper")).removeClass("zc-page-content-wrapper")}if($(document.querySelectorAll(".page_content_wrapper")).find(".zc-htmlpage-old-table").length==0){$(document.querySelectorAll(".page_content_wrapper")).removeClass("zc-view-embed-single-report")}};this.getButton=function(C){return A.getButton(C)};this.bindCaptchaFocus=function(){var D=A.getCaptchaInput();var C=D.closest(".form-field").parent(".form-group");$(D).focus(function(){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}).blur(function(){if($(C).hasClass("zc-focus")){$(C).removeClass("zc-focus")}if(LIB._isNull($(D).val())&&$(C).hasClass("zc-label-float")){$(C).removeClass("zc-label-float")}})};this.getResetCaptchIcon=function(){return A.getResetCaptchIcon()};this.resetCaptcha=function(F){var D=A.getCaptchaImg();var G='<span id="loadingImg" class="zc-capcha-loading"><i class="fa fa-circle-o-notch fa-spin"></i></span>';D.after(G);D.siblings("#refreshCaptcha").hide();D.addClass("zc-captcha-img-loading");D.attr("src","");if(D.length>0){A.getCaptchaInput().val("");var C=B.getModel();var F=F+"?time="+new Date().getTime()+"&formid="+C.getFormId();if(C.hasPrivateLink()){F=F+"&privatelink="+C.getPrivateLink();if(C.getViewLinkName()!=undefined&&C.getAccessType()==2){F=F+"&viewLinkName="+C.getViewLinkName()+"&formAccessType=2"}}var E=A.getCaptchaDigest();$.ajax({url:F,method:"GET",progress:function(){D.attr("src","")},success:function(H){capUrl=H;cdigest=capUrl.slice(capUrl.indexOf("cdigest="),(capUrl.indexOf("&")));cdigest=cdigest.split("cdigest=")[1];F=H;if(C.hasPrivateLink()){F=F+"&privatelink="+C.getPrivateLink();if(C.getViewLinkName()!=undefined&&C.getAccessType()==2){F=F+"&viewLinkName="+C.getViewLinkName()+"&formAccessType=2"}}E.val(cdigest);D.attr("src",H);D.siblings('span[id="loadingImg"]').remove();D.siblings("#refreshCaptcha").show();D.removeClass("zc-captcha-img-loading")}})}};this.showCaptchaError=function(C){var D=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+C+"</div>");var E=A.getCaptchaInput();E.parent().append(D).addClass("validationError");if(B.getModel().getFormAlign()==FormAlign.INPLACE){E.blur()}};this.clearCaptchaError=function(){A.getCaptchaInput().parent().removeClass("validationError");$((A.getCaptchaInput().parent())[0].querySelector(".fieldErrorMsg")).remove()};this.getCaptchaVal=function(){return A.getCaptchaInput().val()};this.getCaptchaDigest=function(){return A.getCaptchaDigest().val()};this.showOverlay=function(){return A.getFormOverlay().show()};this.hideOverlay=function(){return A.getFormOverlay().hide()};this.showProgress=function(){return A.getFormProgress().show()};this.hideProgress=function(){return A.getFormProgress().hide()};this.bindBulkEditInput=function(D){var C=A.getBulkEditInput();_config={placeholder:"- "+i18n.bulkeditselcolumn+" -",data:D,multiple:true,escapeMarkup:function(E){return E}};C.select2(_config).on("change",function(F){var E=(F.added)?F.added:F.removed;B.showhideField(E.id,(F.added!=undefined))})};this.getBulkEditSelFields=function(){var E=A.getBulkEditInput().select2("data"),F=[];for(var D=0,C=E.length;D<C;D++){F.push(E[D].id)}return F};this.closeForm=function(C){$(A.getFormContainer()).html(C)};this.applyStyles=function(E){for(var C in E){var H=E[C];var F=A.getFormDOM();var D=/^([A-Fa-f0-9]{6})$/;if((C.indexOf("zc_")==0)&&D.test(H)){H="#"+H}switch(C){case"zc_Header":G(".form-header","display",H=="true"?"block":"none");break;case"zc_SuccMsg":break;case"zc_NextUrl":break;case"zc_OpenUrlIn":break;case"zc_BgClr":$(F.querySelector(".formContainer")).css("background-color",H);break;case"zc_BdrClr":G(".form-table","border","1px solid "+H);break;case"zc_HdrClr":$(F.querySelector(".form-header")).css("background-color",H);break;case"zc_HdrHeight":$(F.querySelector(".form-header")).css("height",H);break;case"zc_HdrFont":$(F.querySelector(".form-header")).css("font-family",H);break;case"zc_HdrFontSize":$(F.querySelector(".form-title")).css("font-size",H);break;case"zc_HdrFontClr":$(F.querySelector(".form-title")).css("color",H);break;case"zc_FtrClr":$(F.querySelector(".form-action-container")).css("background-color",H);break;case"zc_FtrHeight":$(F.querySelector(".form-action-container")).css("height",H);break;case"zc_BtnBgClr":$(F.querySelectorAll(".zc-live-primary-btn")).css("background-color",H);break;case"zc_BtnClr":$(F.querySelectorAll(".zc-live-primary-btn")).css("color",H);break;case"zc_BtnMovrClr":$(F.querySelectorAll(".zc-live-primary-btn")).attr("onmouseover","this.className='zc-formbutton-hover';this.style.color='"+H+"'");break;case"zc_BtnFont":$(F.querySelectorAll(".zc-live-primary-btn")).css("font-family",H);break;case"zc_BtnFontSize":G(".zc-live-primary-btn","font-size",H+"px");break;case"zc_LblClr":$(F.querySelectorAll(".form-label")).css("background-color",H);break;case"zc_LblWidth":$(F.querySelectorAll(".form-label")).css("width",H);break;case"zc_LblFontClr":$(F.querySelectorAll(".form-label")).css("color",H);break;case"zc_LblFont":$(F.querySelectorAll(".form-label")).css("font-family",H);break;case"zc_LblFontSize":G(".form-label","font-size",H+"px");break;case"zc_InpClr":$(F.querySelectorAll(".form-group input, .form-group select, .form-group textarea, .form-control")).css("background-color",H);break;case"zc_InpWidth":$(F.querySelectorAll(".form-group input, .form-group select, .form-group textarea, .form-control")).css("width",H);break;case"zc_InpFieldFontClr":$(F.querySelectorAll(".form-group input, .form-group select, .form-group textarea, .form-control")).css("color",H);break;case"zc_InpFieldFont":$(F.querySelectorAll(".form-group input, .form-group select, .form-group textarea, .form-control")).css("font-family",H);break;case"zc_InpFieldFontSize":G(".form-group input, .form-group select, .form-group textarea, .form-control, .form-group .choice-table-row, .form-group .select2-chosen","font-size",H+"px");break;case"zc_freezePublishPreview":$("#zc-component div").css("pointer-events","none");break}}function G(K,J,I){var L=F.querySelectorAll(K);if(K==".form-table"){F.style.setProperty(J,I,"important")}else{if(L!=undefined){L.forEach(function(M){M.style.setProperty(J,I,"important")})}}}};this.isPopup=function(){return $(A.getFormContainer()).parent().hasClass("popupConentContainer")||$(A.getFormContainer()).parent().parent().hasClass("popupConentContainer")};this.getGeoOverlay=function(){return A.getGeoOverlay()}});FormView.prototype=Object.create(ViewFactory.prototype);var FieldView=(function(D,C,B){ViewFactory.call(this,D);var A=this;this.bindChange=function(){var H=C.getModel();var G=H.getComponentType();if(G==FieldType.EMAIL_ADDRESS){var E=H.getDisplayName();var F=/^[a-zA-Z0-9]([\w\-\.\+\']*)@[a-zA-Z0-9]([\w\-\.]*)(\.[a-zA-Z]{2,15}(\.[a-zA-Z]{2}){0,2})$/;D.getField().change(function(){var K=$.trim(D.getField().val());if(K==""||F.test(K)){C.clearError();$(this).trigger("onuserinput")}else{C.showError(i18n.validEmailMsg.replace("{0}",E))}})}else{if(G==FieldType.NUMBER||G==FieldType.PERCENTAGE||G==FieldType.DECIMAL){var I=H.fieldDecimalLength();var E=H.getDisplayName();var J=/^(\+|-)?[0-9]*(\.?[0-9]+)?$/;D.getField().change(function(){var L=D.getField().val();var K=L.indexOf(".");C.clearError();if(L!=""&&$.trim(L)!=""){if(isNaN(parseFloat(L))||!J.test(L)){C.showError((i18n.validNumberMsg).replace("{0}",E));return }else{if((I==0&&K!=-1)||(I>0&&K!=-1&&(L.substr(K+1).length>I))){var M=(i18n.roundDecimalMsg).replace("{0}",E);M=M.replace("{1}",I);C.showError(M);return }}}$(this).trigger("onuserinput")})}else{if(H.isAddressSubField()){D.getField().change(function(){var M=C.getParentField();var L=M.getModel();if(L.isCaptureGeoCoordinates()){M.geocodeAddress(true)}else{var K=M.getView();K.updateZMAPLocation("","",true)}})}else{if(!H.isCompositeField()&&G!=FieldType.DATE&&G!=FieldType.IMAGE&&G!=FieldType.DATE_TIME&&G!=FieldType.CURRENCY){D.getField().change(function(){$(this).trigger("onuserinput")})}}}}};this.bindFieldHelpText=function(){var J=D.getFieldParentGroup().parent().width();var E;var G=C.getModel();var F=G.getComponentType();if(!A.isTopAlignment()&&!A.isFloatLabelAlignment()){var I=D.getFieldParentGroup().find(".form-label").outerWidth();E=J-I}else{E=J}var H=$('<div class="zc-help-txt" style="white-space:pre-line;width:'+(E-10)+'px"></div>');H.text(G.getTitle());D.getFieldParent().append(H)};this.adjustLabelWidth=function(I,O){var M=C.getModel();if(A.isFloatLabelAlignment()){if(M.isCompositeSubField()){var L=D.getField();var K=$($(L).parent()[0].querySelector(".zc-subfield-label")).addClass("adjustInplaceWidth");$(K).css({"max-width":($(L).width()-5)})}else{if(!M.isSubformField()){var E=$(D.getFieldParentGroup()[0].querySelector(".form-label").querySelector("span"));if(E!=undefined&&E!=null){$(E).addClass("adjustInplaceWidth");var F=D.getFieldParent();if(F!=undefined){var G=$(F).width();var N=$(F).height();if(!O){switch(I){case FieldType.EMAIL_ADDRESS:case FieldType.PERCENTAGE:case FieldType.CURRENCY:G-=$(F[0].querySelector(".zc-prepend-icon")).width();break;case FieldType.DATE:case FieldType.DATE_TIME:G-=$(F[0].querySelector(".calcIcon")).width();break;case FieldType.INLINE_PICK_LIST:case FieldType.DROPDOWN:case FieldType.RADIO:case FieldType.SYSTEM_LOOKUP:G-=20;break;case FieldType.PHONE_NUMBER:G-=$(F[0].querySelector(".flag-container")).width();break;case FieldType.IMAGE:case FieldType.FILE_UPLOAD:case FieldType.AUDIO:case FieldType.VIDEO:if(M.getDefaultValue()==""||M.getDefaultValue==undefined){var J=$(D.getImageIcons().querySelector(".calcIcon:last-child")).width();var M=C.getModel();if(I==FieldType.IMAGE){G=A.calculateWidthForRestore(M.getImageType(),G,J+1)}else{if(I==FieldType.FILE_UPLOAD){var H=M.getCloudService();if(H==""||H.indexOf("mycomputer")==-1){G=G-J}else{G=G-(2*J)}}else{G=G-(2*J)}}}break;case FieldType.CHECK_BOXES:if(D.getField().data("select2")==undefined){return }break}}$(E).css({"max-width":(G-20)})}}}}}};this.showHelpText=function(){if(C.getModel().getComponentType()==FieldType.DECISIONBOX){$(D.getFieldParent().parent()[0].querySelector(".zc-help-txt")).show()}else{$(D.getFieldParent()[0].querySelector(".zc-help-txt")).show()}};this.hideHelpText=function(){if(C.getModel().getComponentType()==FieldType.DECISIONBOX){$(D.getFieldParent().parent()[0].querySelector(".zc-help-txt")).hide()}else{$(D.getFieldParent()[0].querySelector(".zc-help-txt")).hide()}};this.bindFieldDescription=function(){var H=C.getModel();var G={tooltip:H.getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(H.isSubformField()){var E=$(B.getDOM().getFormDOM()).parent()[0].querySelector("."+H.getClassName()+"-group");if(E!=null&&E!=undefined){G.tooltipelem=E.querySelector(".zc-label-text");$(G.tooltipelem).tooltipPositionCalc(G);$(D.getField()).parent().tooltipPositionCalc(G)}}else{var F=H.getComponentType();if(F==FieldType.NAME){G.containsSubfield=true;G.extraHeight=($(D.getField()).height()-$(D.getField()).find("#firstname").height())}else{if(F==FieldType.ADDRESS){G.containsSubfield=true;G.extraHeight=($(D.getPrimaryOuterEl()).height()-$(D.getPrimaryInput()).height())}}$(D.getField()).parent().tooltipPositionCalc(G)}};this.isFloatLabelAlignment=function(){fieldModel=D.getModel();var E=fieldModel.isSubformField()?fieldModel.getFormModel().getFormModel():fieldModel.getFormModel();return E.getFormAlign()==FormAlign.INPLACE?true:false};this.isTopAlignment=function(){fieldModel=D.getModel();var E=fieldModel.isSubformField()?fieldModel.getFormModel().getFormModel():fieldModel.getFormModel();return E.getFormAlign()==FormAlign.TOP?true:false};this.bindFocus=function(){var G=D.getField();var E=D.getFieldParentGroup();var F=D.getModel().getComponentType();if(!(F==FieldType.DECISIONBOX||F==FieldType.SUB_FORM_GRID)){if(!LIB._isNull($(G).val())&&!$(E).hasClass("zc-label-float")){$(E).addClass("zc-label-float")}$(G).focus(function(){$(E).addClass("zc-focus");if(!$(E).hasClass("zc-label-float")){$(E).addClass("zc-label-float")}if(F!=FieldType.PHONE_NUMBER){A.adjustLabelWidth(C.getModel().getComponentType(),true)}}).blur(function(){if($(E).hasClass("zc-focus")){$(E).removeClass("zc-focus")}if(C.getModel().isCompositeSubField()){if(!LIB._isNull($(G).val())){$(G).parent().addClass("zc-label-float")}}else{if(LIB._isNull($(G).val())&&$(E).hasClass("zc-label-float")){$(E).removeClass("zc-label-float");if(F!=FieldType.PHONE_NUMBER){A.adjustLabelWidth(C.getModel().getComponentType(),false)}}else{if(!$(E).hasClass("zc-label-float")){$(E).addClass("zc-label-float")}}}})}};this.bindFormula=function(){var H=C;var I=H.getModel().isSubformField()?H.getFormController().getFormController():H.getFormController();var F=I.getWorkflowController();if(F==undefined){F=new WorkflowController(I)}var E=false;var G=function(K){if(H instanceof SubformController&&$(K.target).attr("elname")!="subformdiv"){return }if(!E){var J={};if(H.getModel().isSubformField()){J.fieldname=H.getFormController().getModel().getActualLabelName();J.subformfieldname=H.getModel().getActualLabelName();J.rowseqid=H.getModel().getRowID()}else{J.fieldname=H.getModel().getActualLabelName()}F.triggerFormulaAction(H,J);E=true}$(this).trigger("formulacalc")};D.getField().change(G).bind("triggerformula",G)};this.bindFormulaForFileType=function(H){var F=H;var I=F.getModel().isSubformField()?F.getFormController().getFormController():F.getFormController();var E=I.getWorkflowController();if(E==undefined){E=new WorkflowController(I)}initFormula=false;if(F.getModel().isFormulaExist()){if(!initFormula){var G={};if(F.getModel().isSubformField()){G.fieldname=F.getFormController().getModel().getActualLabelName();G.subformfieldname=F.getModel().getActualLabelName();G.rowseqid=F.getModel().getRowID()}else{G.fieldname=F.getModel().getActualLabelName()}E.triggerFormulaAction(F,G);initFormula=true}D.getField().trigger("formulacalc")}};this.trigger=function(E){D.getField().trigger(E)};this.fieldEvents=function(){};this.destroy=function(){};this.getValue=function(){return $(D.getField()).val()};this.setValue=function(E){if($(D.getField()).data("select2")!=undefined){$(D.getField()).select2("data",E)}else{$(D.getField()).val(E)}if(this.isFloatLabelAlignment()){D.getField().trigger("blur")}};this.getField=function(){return D.getField()};this.getFieldContainer=function(){return this.getField().closest(".form-group")};this.focus=function(){this.getField().focus()};this.hasError=false;this.showError=function(F){var E=C.getModel().isSubformField();if(!this.hasError){var H=D.getField().outerWidth()+"px";var G="";if(E){G=$('<div class="fieldErrorMsg zc-dem-box-sizing" style = "min-width:'+H+";width:"+H+'">'+F+"</div>")}else{G=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+F+"</div>")}if(C.getModel().getComponentType()==FieldType.DECISIONBOX){D.getFieldParent().parent().append(G);D.getFieldParent().addClass("validationError")}else{D.getFieldParent().append(G).addClass("validationError");D.getFieldParent().addClass("select2Err")}this.hasError=true}};this.clearError=function(){if(this.hasError){D.getFieldParent().removeClass("validationError");if(C.getModel().getComponentType()==FieldType.DECISIONBOX){$((D.getFieldParent().parent()).find(".fieldErrorMsg")).remove()}else{$((D.getFieldParent()).find(".fieldErrorMsg")).remove()}this.hasError=false}};this.showLoader=function(){this.getFieldContainer().append('<i class="cogLoader fa fa-spinner fa-spin"></i>')};this.hideLoader=function(){$(this.getFieldContainer().find(".cogLoader")).remove()};this.hideField=function(){if(this.getDOM().getModel().isCompositeSubField()){this.getField().parent().hide()}else{this.getFieldContainer().hide()}};this.showField=function(){if(this.getDOM().getModel().isCompositeSubField()){this.getField().parent().show()}else{this.getFieldContainer().show()}};this.disableField=function(){this.getField().attr("disabled",true);if(isEdgeBrowser()){this.getField().attr("readonly",true)}};this.enableField=function(){this.getField().attr("disabled",false);if(isEdgeBrowser()){this.getField().attr("readonly",false)}};this.showInPage=function(){$(this.getFieldContainer()).removeClass("field-screen")};this.hideInPage=function(){$(this.getFieldContainer()).addClass("field-screen")};this.bindFieldHoverEvent=function(E){$(E).hover(function(){$(E).parent().addClass("zc-field-hover")},function(){$(E).parent().removeClass("zc-field-hover")})};this.inPlaceLayoutHover=function(F,E,H,I,G){if(!H){if(E){$(F).addClass("zc-focus");if(!$(F).hasClass("zc-label-float")){$(F).addClass("zc-label-float")}}else{if($(F).hasClass("zc-focus")){$(F).removeClass("zc-focus")}if(LIB._isNull(I)&&!G){if($(F).hasClass("zc-label-float")){$(F).removeClass("zc-label-float")}}else{if(!$(F).hasClass("zc-label-float")){$(F).addClass("zc-label-float")}}}}};this.bindFieldFocusEvent=function(H,E,G){var F=D.getFieldParentGroup();$(H).focus(function(){if(!$(F).hasClass("zc-focus")){$(F).addClass("zc-focus")}$(E).parent().addClass("zc-field-focus");var I="";if(G){I=$(D.getFileValue()).val()}else{I=$(D.getField()).val()}if(I==""||I==undefined){$($(D.getImageIcons()).children("span").eq(1)).trigger("mouseover")}$($(D.getImageIcons()).children("span").eq(1)).addClass("zc-icon-focus")});$(H).blur(function(){$(E).parent().removeClass("zc-field-focus");var I="";if(G){I=$(D.getFileValue()).val()}else{I=$(D.getField()).val()}if(I==""||I==undefined){$($(D.getImageIcons()).children("span").eq(1)).trigger("mouseleave")}$($(D.getImageIcons()).children("span").eq(1)).removeClass("zc-icon-focus");$(F).removeClass("zc-focus")})}});createPrototype(FieldView,ViewFactory.prototype);var CurrencyView=(function(H,E,B){FieldView.call(this,H,E,B);var A=this;var C=H.getModel();var D=C.getValueFormat();var G=FormatSeparators[D][0];var F=FormatSeparators[D][1];if(A.isFloatLabelAlignment()&&!C.isSubformField()){H.getField().removeAttr("placeholder")}H.getField().change(function(){if(A.validateFormat(H.getField().val())){var I=A.formatNumber(H.getField().val());H.getField().val(I);if(I.replace(/[^\w]/g,"").length>C.getMaxDigits()){C.setValidationError(true);E.showError((i18n.maxdigitreached).replace("{0}",C.getDisplayName()).replace("{1}",C.getMaxDigits()));return false}C.setValidationError(false);$(this).trigger("onuserinput")}else{C.setValidationError(true)}});this.validateFormat=function(K){E.clearError();if(K!=null&&$.trim(K)!=""){if(isNaN(K.replace(/,|\.|'|\s/g,""))){E.showError((i18n.validNumberMsg).replace("{0}",C.getDisplayName()));return false}var J=F;if(D!==FormatConstants.DEFAULTFORMAT&&D!==FormatConstants.DOTCOMMA&&A.getRegexForFormat(FormatConstants.DEFAULTFORMAT).test(K)){J="."}else{if(!A.getRegexForFormat(D).test(K)){E.showError((i18n.validNumericFormat).replace("{0}",'"'+C.getPlaceHolderFormat()+'"'));return false}}var I=K.indexOf(J);if(I!=-1&&I!==K.lastIndexOf(J)){E.showError((i18n.validNumericFormat).replace("{0}",'"'+C.getPlaceHolderFormat()+'"'));return false}else{if(I!=-1&&K.substr(I+1).length>C.fieldDecimalLength()){E.showError((i18n.roundDecimalMsg).replace("{0}",C.getDisplayName()).replace("{1}",C.fieldDecimalLength()));return false}}}return true};this.getRegexForFormat=function(I){switch(I){case FormatConstants.DEFAULTFORMAT:return/^(\+|-)?[0-9]*(\.?[0-9]+)*$/;case FormatConstants.COMMADOTENGLISH:case FormatConstants.COMMADOTINDIA:return/^(\+|-)?[0-9]*(,?[0-9]+)*(\.?[0-9]+)*$/;case FormatConstants.SPACECOMMA:return/^(\+|-)?[0-9]*(\s?[0-9]+)*(,?[0-9]+)*$/;case FormatConstants.DOTCOMMA:return/^(\+|-)?[0-9]*(\.?[0-9]+)*(,?[0-9]+)*$/;case FormatConstants.QUOTEDOT:return/^(\+|-)?[0-9]*('?[0-9]+)*(\.?[0-9]+)*$/}};this.formatNumber=function(P){var L=F;if(D!==FormatConstants.DEFAULTFORMAT&&D!==FormatConstants.DOTCOMMA&&A.getRegexForFormat(FormatConstants.DEFAULTFORMAT).test(P)){L="."}var N=P.split(L);if(D===FormatConstants.DEFAULTFORMAT||P.indexOf(L)===0){return P}var O=false;if(N[0].charAt(0)==="+"||N[0].charAt(0)==="-"){N[0]=N[0].substr(1);O=true}if(N[0].indexOf(G)!==-1){N[0]=N[0].replace(new RegExp("\\"+G,"g"),"")}var I=[];I.push(N[0].length<=3?N[0]:G+N[0].substr(N[0].length-3));N[0]=N[0].split("").reverse().join("");var M=0;var J=(D===FormatConstants.COMMADOTINDIA?2:3);for(var K=3;K<N[0].length;K++){I.push(N[0][K]);if(++M===J&&K+1<N[0].length){I.push(G);M=0}}if(O){I.push(P.charAt(0))}return(N.length===1?I.reverse().join(""):I.reverse().join("")+F+N[1])};this.setValue=function(I){if(A.validateFormat(I)){H.getField().val(A.formatNumber(I));C.setValidationError(false)}else{H.getField().val(I);C.setValidationError(true)}if(this.isFloatLabelAlignment()){H.getField().trigger("blur")}}});createPrototype(CurrencyView,ViewFactory.prototype);var DateTimeView=(function(F,D,B){FieldView.call(this,F,D,B);var C=F.getModel();var E="";var A=this;this.setValue=function(I){$(F.getField()).val(I);A.setPlaceholder(I);if(this.isFloatLabelAlignment()){var H=C.isSubformField();var G=F.getFieldParentGroup();A.inPlaceLayoutHover(G,false,H,I,false)}};this.focus=function(){};this.fieldEvents=function(){D.initCalender();A.setPlaceholder(C.getDefaultValue());var K=$(F.getFieldParent()).width();var I=F.getFieldParent().find(".zc-datefield-placeholder");var N=F.getFieldParent().find(".calcIcon").width();$(I).css({"max-width":(K-N-10)});var J=D;var M=J.getModel().isSubformField()?J.getFormController().getFormController():J.getFormController();var H=M.getWorkflowController();if(H==undefined){H=new WorkflowController(M)}var L=J.getModel().isSubformField()?F.getModel().getFormModel().getFormModel().getRulesScript():F.getModel().getFormModel().getRulesScript();var G=false;$(F.getField()).blur(function(P){var Q=F.getField().val();A.setPlaceholder(Q);if(E!=Q){if(!(A.validateDateFormat())){return false}F.getField().trigger("onuserinput");if(!G){var O={};if(J.getModel().isSubformField()){O.fieldname=J.getFormController().getModel().getActualLabelName();O.subformfieldname=J.getModel().getActualLabelName();O.rowseqid=J.getModel().getRowID()}else{O.fieldname=J.getModel().getActualLabelName()}H.triggerFormulaAction(J,O);G=true}F.getField().trigger("formulacalc");E=Q;if(L!=undefined){F.getField().trigger("change")}}})};this.setupCalender=function(M,K,I,L,H,N){var G=this;var J=false;L=(L=="null"||L==null)?"":L;F.getField().val(L);F.getCalIcon().click(function(){if(!J){L=F.getField().val();G.setupCalendarPromise(M,K,I,L,H,N);J=true;$(F.getCalIcon()).click()}});F.getField().on("focus",function(){if(!J){L=F.getField().val();G.setupCalendarPromise(M,K,I,L,H,N);J=true;$(F.getCalIcon()).click()}})};this.setupCalendarPromise=function(G,N,I,M,J,L){if(L==undefined){L=ZCGlobal.uiDateFormate}else{L=L.toUpperCase().replace("E","ddd")}if(G===FieldType.DATE_TIME){L+=" HH:mm:ss"}var K=this.getPickerLanguage();if(K=="zh"){K=K+"_CN"}var O=[0,1,2,3,4,5,6];var H={format:L,keepInvalid:true,value:M,useCurrent:true,allowedDays:N,zcLocale:K,onShowCallback:function(){A.setPlaceholder("removePlaceHolder");E=F.getField().val()},onHideCallback:function(){if(ZCGlobal.isMobileLayout){$(".zc-mobile-back-button").show();var P=$(F.getField().parent()).find(".zc-dem-date-picker-clear-icon");if(!LIB._isNull(F.getField().val())){$(P).show()}F.getField().blur()}},defaultValueCallbk:function(){D.setValue("")}};if(ZCGlobal.isMobileLayout){H.ignoreReadonly=true;H.focusOnShow=false;H.showClose=true;H.icons={close:"fa fa-close"};H.locatePickerCallBack=function(){$(".zc-mobile-back-button").hide()};H.showClearValue=true;H.clearIconCallbk=function(Q){var P="<span class='zc-dem-date-picker-clear-icon "+Q+"'><i class='fa fa-close'></i></span>";if(!$(F.getField().parent()).find(".zc-dem-date-picker-clear-icon").length){$(F.getField().parent()).append(P)}};H.clearCallback=function(){F.getField().val("")}}$(F.getField().parent()).dtPicker(H)};this.setPlaceholder=function(H){if(H!=""){$($(F.getField()).parent()[0].querySelector(".zc-datefield-placeholder")).html("")}else{if(!A.isFloatLabelAlignment()||C.isSubformField()){var G=C.getDateFormat();if(C.getComponentType()===FieldType.DATE_TIME){G+=" HH:mm:ss"}$($(F.getField()).parent()[0].querySelector(".zc-datefield-placeholder")).html(G)}}};this.validateDateFormat=function(){var H=F.getField().val();var G=C.getDateFormat();G=G.toUpperCase().replace("E","ddd");if(C.getComponentType()===FieldType.DATE_TIME){G+=" HH:mm:ss"}if(H!=""){moment.locale("en-US");var I=moment(H,G,true).isValid();if(I){D.clearError();return true}else{D.showError((i18n.validDateFormat).replace("{0}",C.getDisplayName()));return false}}else{D.clearError();return true}};this.getPickerLanguage=function(){return D.getModel().getPickerLanguage()}});createPrototype(DateTimeView,FieldView.prototype);var DecisionBoxView=(function(C,B,A){FieldView.call(this,C,B,A);this.getValue=function(){return C.getField().is(":checked")?"zc_checked":"zc_unchecked"};this.setValue=function(D){var D=D=="true"?true:false;C.getField().prop("checked",D)};this.bindFieldHelpText=function(){var E=$(C.getFieldParentGroup()).width()-4;var D=$('<div class="zc-help-txt" style="white-space:pre-line;width:'+E+'px"></div>');D.text(fieldModel.getTitle());C.getFieldParent().parent().append(D)};this.bindFieldDescription=function(){var E={tooltip:C.getModel().getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(fieldModel.isSubformField()){var D=$(A.getDOM().getFormDOM()).parent()[0].querySelector("."+fieldModel.getClassName()+"-group");if(D!=null&&D!=undefined){E.tooltipelem=$(D.querySelector(".decision-box-label")).children("span");$(E.tooltipelem).tooltipPositionCalc(E);$(C.getField()).parent().tooltipPositionCalc(E)}}else{E.isDecisionBox=true;E.checkBoxWidth=$(C.getFieldParent()).width();E.tooltipelem=$(C.getFieldParent()).parent()[0].querySelector(".decision-box-label");$(C.getField()).parent().tooltipPositionCalc(E)}}});createPrototype(DecisionBoxView,FieldView.prototype);var ImageView=(function(A,G,F){FieldView.call(this,A,G,F);var L=2,H=this,E=false;var B=H.isFloatLabelAlignment();var J=A.getModel();var I=J.isSubformField();var D=J.isLocalImgSRC()||LIB._isNull((J.getImageSRC()!=undefined?J.getImageSRC().trim():J.getImageSRC()));var C=A.getFieldParentGroup();var K=false;this.getSelectedType=function(){return L};this.setSelectedType=function(M){H.selectedType=M};this.focus=function(){if(J.getImageType()==2||(J.getImageType()>=3&&D)){$(A.getFileInputEl()).focus()}else{$(A.getSourceComp()).focus()}};this.fieldEvents=function(){G.regImageEvent();var M=this;$(A.getFileInputEl()).change(function(){M.toggleOptions(this)});$(A.getSourceComp()).change(function(){M.toggleOptions(this);$(this).trigger("onuserinput");G.getView().bindFormulaForFileType(G)});var P=A.getFileInputEl().attr("dimension");var N=P>1?true:false;var O=J.getImageType();if(J.getDefaultValue()!=""&&J.getDefaultValue()!=undefined){if(B&&!I){if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}$(A.getImageIcons()).hide();if(J.getImageSelectedType()==1||O==1){M.toggleOptions(A.getSourceComp());L=1;$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link")).show();if(O!=1){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show()}}else{if(J.getImageSelectedType()==2){K=true;L=2;A.getSourceComp().val("");$(A.getImageIcons().querySelector(".calcIcon")).append(i18n.restoreMsg);M.setRestoreWidth();$(A.getFieldDOM().querySelector(".zc-image-link")).hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();$(A.getFieldParentDiv()).addClass("zc-bottomColr")}else{L=3;$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link")).show();$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show();A.getSourceComp().attr("readonly",true);A.getImgOptionsCont().show(400);A.getImgOptionsCont().removeClass("hide");$(A.getFieldParentDiv()).addClass("zc-bottomColr")}}}if(!K){$($(A.getImageIcons()).children("span").eq(1)).removeAttr("tabindex")}M.bindFieldHoverEvent(A.getFieldDOM().querySelector(".zc-file-upload"));M.bindFieldHoverEvent(A.getFieldDOM().querySelector(".zc-image-link"));M.bindFieldFocusEvent(A.getFileInputEl(),A.getFieldDOM().querySelector(".zc-file-upload"),true);if(O==Constants.LINK||O==Constants.LINKANDCAMERA){L=1}if(B&&!I){M.hoverMsgChange(L,"")}else{if(L==2){M.hoverMsgChange(L,i18n.selectImageMsg)}else{if(L==1){M.hoverMsgChange(L,"https://")}}}$(A.getImageIcons().querySelectorAll(".calcIcon")).bind("mouseenter mouseleave",function(Q){if(Q.type=="mouseenter"){M.adjustLabelWidth(G.getModel().getComponentType(),true);M.placeHolderMsgRelatedChanges($(this),true,O);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().addClass("zc-restore-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().addClass("zc-image-upload-hover")}if($(this).find("i").hasClass("ui-2-link-69")){$(this).parent().parent().addClass("zc-image-link-hover")}if($(this).find("i").hasClass("media-1-camera-20")){$(this).parent().parent().addClass("zc-image-camera-hover")}}else{if(Q.type=="mouseleave"){M.adjustLabelWidth(G.getModel().getComponentType(),false);M.placeHolderMsgRelatedChanges($(this),false,O);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().removeClass("zc-restore-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().removeClass("zc-image-upload-hover")}if($(this).find("i").hasClass("ui-2-link-69")){$(this).parent().parent().removeClass("zc-image-link-hover")}if($(this).find("i").hasClass("media-1-camera-20")){$(this).parent().parent().removeClass("zc-image-camera-hover")}}}});if(O==Constants.LINKANDLOCAL||O==Constants.LINKANDCAMERA||O==Constants.IMAGEALLOPTION||L==3){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).bind("click",function(R,Q){A.getSourceComp().val("");$(this).trigger("onuserinput");G.getView().bindFormulaForFileType(G);$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).hide();if(O==Constants.LINKANDCAMERA){M.toggleOptions(A.getSourceComp(),Q);L=1}else{L=3;A.getSourceCompDiv().hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();M.hoverMsgChange(L,i18n.selectImageMsg);M.toggleOptions(A.getFileInputEl(),Q);M.setRestoreWidth()}$(A.getImageIcons()).show()});if(B&&!I){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).bind("mouseover",function(){M.inPlaceLabelHover(true);$(A.getSourceComp()).attr("placeholder","https://")}).mouseout(function(){M.inPlaceLabelHover(false);$(A.getSourceComp()).attr("placeholder","")})}$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".form-control")).bind("focus",function(){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show();$(A.getImageIcons()).hide()})}if(O==Constants.LINK){$(A.getImageIcons()).hide();$(A.getSourceComp()).css({"padding-right":0})}if(O==Constants.CAMERA||O==Constants.LINKANDCAMERA){$(A.getFileInputEl()).bind("click",function(Q){L=2;Q.preventDefault();G.getImageObj().openCamera(A,"fileinput")})}if(O==Constants.CAMERAANDLOCAL){$(A.getImageIcons()).addClass("linkCameraIcon")}$(A.getImageIcons()).css("z-index",$(A.getField()).zIndex()+1);$(A.getImageIcons().querySelectorAll(".calcIcon")).bind("click focus blur keyup",function(Q){if(Q.type=="focus"){$(this).addClass("zc-icon-focus");$(A.getFieldDOM().querySelector(".zc-file-upload")).parent().addClass("zc-field-focus");M.placeHolderMsgRelatedChanges($(this),true,O);return }else{if(Q.type=="blur"){$(this).removeClass("zc-icon-focus");$(A.getFieldDOM().querySelector(".zc-file-upload")).parent().removeClass("zc-field-focus");M.placeHolderMsgRelatedChanges($(this),false,O);return }else{if(Q.type=="keyup"&&Q.which!=13){return }}}if($(this).find("i").hasClass("arrows-2-square-upload")){L=2;$(A.getFileInputEl()).click();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();A.getSourceCompDiv().hide();M.toggleOptions(A.getFileInputEl())}if($(this).find("i").hasClass("ui-2-link-69")){L=1;$(A.getImageIcons()).hide();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");A.getSourceCompDiv().fadeIn();$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show();$(A.getSourceComp()).focus();M.toggleOptions(A.getSourceComp())}if($(this).find("i").hasClass("media-1-camera-20")){G.getImageObj().openCamera(A,"fileinput")}if($(this).find("i").hasClass("arrows-4-undo-29")){$($(A.getField())[0].querySelector(".arrows-4-undo-29.file-restore")).click();G.clearError();$(A.getImageIcons()).hide();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");if(J.getImageSelectedType()==1){L=1;A.getSourceComp().removeAttr("tabindex");$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link")).show();A.getSourceComp().focus()}else{L=2;A.getFileInputEl().removeAttr("tabindex");$(A.getFieldDOM().querySelector(".zc-image-link")).hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileInputEl().focus()}}})};this.placeHolderMsgRelatedChanges=function(N,M,O){if(M){H.inPlaceLabelHover(true);if(O==Constants.LINKANDCAMERA){$(A.getSourceComp()).attr("placeholder","")}if(K&&!$(N).find("i").hasClass("arrows-4-undo-29")){$(A.getImageIcons().querySelector(".calcIcon")).hide()}if($(N).find("i").hasClass("arrows-2-square-upload")){H.hoverMsgChange(L,i18n.localuploadHoverMsg);if(K){H.hoverMsgChange(3,i18n.localuploadHoverMsg)}}if($(N).find("i").hasClass("ui-2-link-69")){H.hoverMsgChange(L,i18n.linkHoverMsg);if(K){H.hoverMsgChange(3,i18n.linkHoverMsg)}}if($(N).find("i").hasClass("media-1-camera-20")){H.hoverMsgChange(L,i18n.cameraHoverMsg);if(K){H.hoverMsgChange(3,i18n.cameraHoverMsg)}}}else{if(L==2||L==3){H.hoverMsgChange(L,i18n.selectImageMsg)}else{H.hoverMsgChange(L,"https://")}if(O==Constants.LINKANDCAMERA){$(A.getSourceComp()).attr("placeholder","https://")}if(B&&!I){H.inPlaceLabelHover(false)}if(K){$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block");H.inPlaceLabelHover(true);H.hoverMsgChange(3,"")}}};this.hoverMsgChange=function(N,M){if(J.getDefaultValue()==undefined||J.getDefaultValue()==""){if(N==2||N==3){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(M)}else{$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");$(A.getSourceComp()).attr("placeholder",M)}}else{if(N==3){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(M)}}};this.setRestoreWidth=function(){if(K){var P=J.getImageType();var N=$($(A.getField())[0].querySelector(".filename")).width();var O=$(A.getImageIcons().querySelector(".calcIcon:last-child")).width();var M=H.calculateWidthForRestore(P,N,O+1)-2;$(A.getImageIcons().querySelector(".calcIcon")).width(M);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block")}};this.calculateWidthForRestore=function(O,M,N){switch(O){case Constants.LOCAL:case Constants.CAMERA:M-=N;break;case Constants.LINKANDLOCAL:case Constants.CAMERAANDLOCAL:M-=(2*N);break;case Constants.LINKANDCAMERA:M-=((2*N)+2);break;case Constants.IMAGEALLOPTION:M-=(3*N);break}return M};this.toggleOptions=function(N,M){var O=($(N).attr("type")!="file")?$(N).val():A.getFileValue().val();if(O!=undefined&&O!=""){A.getImgOptionsCont().show(400);A.getImgOptionsCont().removeClass("hide")}else{if(!isNull(M)){A.getImgOptionsCont().hide()}else{A.getImgOptionsCont().hide(400)}}};upload=$('<a class="zc-link-switch hide"><i class="fa fa-upload"></i></a>');link=$('<a class="zc-link-switch hide"><i class="fa fa-link"></i></a>');this.showLink=function(){$(link).trigger("click")};this.createTab=function(N){var M=this;A.getField().addClass("zc-toggle-switch");A.getSourceCompDiv().append(upload);upload.click(function(){$(A.getFieldDOM().querySelector(".zc-file-upload")).fadeIn();A.getSourceCompDiv().hide();M.toggleOptions(A.getFileInputEl());L=2});link.click(function(){A.getSourceCompDiv().fadeIn();$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();L=1;if(M.isFloatLabelAlignment()){$(A.getSourceComp()).attr("placeholder","");M.bindFocus()}})};this.destroy=function(){$(A.getFileInput()).upload("destroy")};this.createUpload=function(N){var M=this;N.beforeSend=function(){G.showLoader();G.getFormController().markActive()};N.success=function(U,V,Y){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");G.hideLoader();G.getFormController().unmarkActive();L=2;if(J.getImageType()==Constants.LINKANDCAMERA){A.getSourceCompDiv().hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();M.toggleOptions(A.getFileInputEl())}var T=[];for(var Z in U){var Q=U[Z];for(var W=0,S=Q.length;W<S;W++){var R=Q[W];if(R.status=="error"){T.push("<b>"+R.docName+"</b>")}}}G.clearError();if(T.length>0){var X=(T.length>1)?"The following files are too larget to upload":"The following file is too large to upload";X+="<br/>"+T.join("<br/>");N.error()}else{A.getFileInputEl().removeAttr("tabindex");if(B&&!I){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileValue().val(JSON.stringify(U));$(A.getFileInputEl()).focus();E=true;G.getView().trigger("onuserinput");G.getView().bindFormulaForFileType(G)}};N.showOpts=function(){A.getImgOptionsCont().show(400)};N.ondelete=function(Q){$(A.getFieldDOM().querySelector(".zc-file-upload")).trigger("mouseleave");A.getFileValue().val("");A.getImgOptionsCont().hide(400);if(!N.isDefaultValuePreseent){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(i18n.selectImageMsg)}if($(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).removeClass("zc-bottomColr")}if(J.getImageType()==Constants.LINKANDCAMERA){L=1;$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();A.getSourceCompDiv().show();M.toggleOptions(A.getSourceCompDiv())}else{M.setRestoreWidth()}$(A.getImageIcons()).show();if(B&&!I){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(K){A.getFileInputEl().attr("tabindex","-1");A.getSourceComp().attr("tabindex","-1")}else{A.getFileInputEl().focus()}E=false;G.getView().trigger("onuserinput");G.getView().bindFormulaForFileType(G)};N.onrestore=function(Q){A.getFileValue().val(Q);A.getImgOptionsCont().show(400);E=false};N.error=function(){G.hideLoader();G.getFormController().unmarkActive();$(A.getImageIcons()).show();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(i18n.selectImageMsg);G.showError(i18n.imagesizelimit);LIB._stopLoading();clearTimeout(G.getFormController().submitTimeout)};$(A.getFileInput()).upload(N);if(!isNull(N.defaultVal)){var O=N.defaultVal;var P=(O!=undefined&&O!="")?O.substring(O.lastIndexOf("/")+1):"";A.getFileValue().val(P)}};this.getSourceVal=function(M){if(M){return A.getFileValue().val()}else{return A.getSourceComp().val()}};this.setSourceVal=function(M){if(J.getImageType()==Constants.LINK||J.getImageType()==Constants.LINKANDLOCAL||J.getImageType()==Constants.LINKANDCAMERA||J.getImageType()==Constants.IMAGEALLOPTION){$(A.getImageIcons()).hide();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");if(J.getImageType()!=Constants.LINK){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show()}if(M!=undefined&&M!=""){A.getImgOptionsCont().show(400);A.getImgOptionsCont().removeClass("hide");L=1;A.getSourceCompDiv().fadeIn();$(A.getFieldDOM().querySelector(".zc-file-upload")).hide()}}return A.getSourceComp().val(M)};this.setFileVal=function(M){A.getFileValue().val(M)};this.getLinkVal=function(){return A.getLinkComp().val()};this.setLinkVal=function(M){return A.getLinkComp().val(M)};this.getTitleVal=function(){return A.getTitleComp().val()};this.setTitleVal=function(M){return A.getTitleComp().val(M)};this.getAltVal=function(){return this.getTitleVal()};this.setAltVal=function(M){return this.setTitleVal(M)};this.addToStore=function(){return E};this.reset=function(){$(A.getFieldDOM().querySelectorAll("input[type=text]")).val("")};this.bindFocus=function(){var M;if(L==2||L==3){M=A.getFileInputEl()}else{M=A.getSourceComp()}if(!I){if(!LIB._isNull($(M).val())&&!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}$(A.getFileInputEl()).mouseover(function(){H.inPlaceLabelHover(true);H.hoverMsgChange(2,i18n.selectImageMsg);H.adjustLabelWidth(G.getModel().getComponentType(),true)}).mouseout(function(){H.inPlaceLabelHover(false);H.hoverMsgChange(2,"");H.adjustLabelWidth(G.getModel().getComponentType(),false)});$(A.getSourceComp()).mouseover(function(){H.inPlaceLabelHover(true);$(A.getSourceComp()).attr("placeholder","https://");H.adjustLabelWidth(G.getModel().getComponentType(),true)}).mouseout(function(){H.inPlaceLabelHover(false);$(A.getSourceComp()).attr("placeholder","");H.adjustLabelWidth(G.getModel().getComponentType(),true)})}};this.inPlaceLabelHover=function(M){if(L==2||L==3){fileinputel=A.getFileInputEl()}else{fileinputel=A.getSourceComp()}if(!M){H.hoverMsgChange(L,"")}H.inPlaceLayoutHover(C,M,I,$(fileinputel).val(),K)};this.disableField=function(){A.getFileInputEl().attr("disabled",true);A.getSourceComp().attr("disabled",true);A.getLinkComp().attr("disabled",true);A.getTitleComp().attr("disabled",true);A.getAltComp().attr("disabled",true);if(isEdgeBrowser()){A.getFileInputEl().attr("readonly",true);A.getSourceComp().attr("readonly",true);A.getLinkComp().attr("readonly",true);A.getTitleComp().attr("readonly",true);A.getAltComp().attr("readonly",true)}$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable");A.getFileInput().parent().addClass("zc-disabled");A.getFileInput().parent().parent().addClass("zc-hideicon");A.getSourceComp().parent().addClass("zc-hideicon")};this.enableField=function(){A.getFileInputEl().attr("disabled",false);A.getSourceComp().attr("disabled",false);A.getLinkComp().attr("disabled",false);A.getTitleComp().attr("disabled",false);A.getAltComp().attr("disabled",false);if(isEdgeBrowser()){A.getFileInputEl().attr("readonly",false);A.getSourceComp().attr("readonly",false);A.getLinkComp().attr("readonly",false);A.getTitleComp().attr("readonly",false);A.getAltComp().attr("readonly",false)}$(A.getImageIcons().querySelectorAll(".calcIcon")).removeClass("zc-eventDisable");A.getFileInput().parent().removeClass("zc-disabled");A.getFileInput().parent().parent().removeClass("zc-hideicon");A.getSourceComp().parent().removeClass("zc-hideicon")};this.bindFieldDescription=function(){var N={tooltip:A.getModel().getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(J.isSubformField()){var M=$(F.getDOM().getFormDOM()).parent()[0].querySelector("."+J.getClassName()+"-group");if(M!=null&&M!=undefined){N.tooltipelem=M.querySelector(".zc-label-text");$(N.tooltipelem).tooltipPositionCalc(N);$(A.getField()).tooltipPositionCalc(N)}}else{$(A.getField()).tooltipPositionCalc(N)}};this.clearValue=function(){J.setDefaultValue("");if(J.getImageType()==Constants.LINK){$(A.getSourceComp()).val("");H.toggleOptions(A.getSourceComp(),1)}else{if(J.isLocalImgSRC()){$(A.getFieldDOM().querySelector(".zc-file-upload").querySelector(".filename i")).trigger("click");H.hoverMsgChange(L,i18n.selectImageMsg);H.toggleOptions(A.getFileInputEl(),1);K=false;$(A.getImageIcons().querySelector(".calcIcon")).removeAttr("style")}else{$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).trigger("click",1)}}this.setLinkVal("");this.setTitleVal("");this.setAltVal("")}});createPrototype(ImageView,FieldView.prototype);var URLView=(function(C,B,A){FieldView.call(this,C,B,A);this.fieldEvents=function(){if(this.isFloatLabelAlignment()){$(C.getURLComp()).attr("placeholder","")}var D=this;$(C.getURLComp()).change(function(){D.toggleOptions(this)});D.toggleOptions(C.getURLComp())};this.toggleOptions=function(D){if($(D).val()!=undefined&&$(D).val()!=""){C.getUrlOptions().show(400);C.getUrlOptions().removeClass("hide")}else{C.getUrlOptions().hide(400)}};this.bindFocus=function(){var E=C.getTextField();var D=C.getFieldParentGroup();if(!LIB._isNull($(E).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}$(E).focus(function(){$(D).addClass("zc-focus");if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}).blur(function(){if($(D).hasClass("zc-focus")){$(D).removeClass("zc-focus")}if(LIB._isNull($(E).val())&&$(D).hasClass("zc-label-float")){$(D).removeClass("zc-label-float")}else{if(!LIB._isNull($(E).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}})};this.focus=function(){C.getTextField().focus()};this.getURLVal=function(){return C.getURLComp().val()};this.setURLVal=function(D){C.getURLComp().val(D);if(this.isFloatLabelAlignment()){C.getTextField().trigger("blur")}return };this.getLinkVal=function(){return C.getLinkComp().val()};this.setLinkVal=function(D){return C.getLinkComp().val(D)};this.getTitleVal=function(){return C.getTitleComp().val()};this.setTitleVal=function(D){return C.getTitleComp().val(D)};this.reset=function(){C.getTextField().val("")};this.disableField=function(){C.getField().attr("disabled",true);C.getURLComp().attr("disabled",true);C.getLinkComp().attr("disabled",true);C.getTitleComp().attr("disabled",true);if(isEdgeBrowser()){C.getField().attr("readonly",true);C.getURLComp().attr("readonly",true);C.getLinkComp().attr("readonly",true);C.getTitleComp().attr("readonly",true)}};this.enableField=function(){C.getField().attr("disabled",false);C.getURLComp().attr("disabled",false);C.getLinkComp().attr("disabled",false);C.getTitleComp().attr("disabled",false);if(isEdgeBrowser()){C.getField().attr("readonly",false);C.getURLComp().attr("readonly",false);C.getLinkComp().attr("readonly",false);C.getTitleComp().attr("readonly",false)}};this.bindFieldDescription=function(){var F=B.getModel();var E={tooltip:F.getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(F.isSubformField()){var D=$(A.getDOM().getFormDOM()).parent()[0].querySelector("."+F.getClassName()+"-group");if(D!=null&&D!=undefined){E.tooltipelem=D.querySelector(".zc-label-text");$(E.tooltipelem).tooltipPositionCalc(E);$(C.getField()).tooltipPositionCalc(E)}}else{$(C.getField()).tooltipPositionCalc(E)}}});createPrototype(URLView,FieldView.prototype);var FileUploadView=(function(A,F,E){FieldView.call(this,A,F,E);var D=false,G=this;var B=G.isFloatLabelAlignment();var I=A.getModel();var C=A.getFieldParentGroup();var H=I.isSubformField();var J=false;this.focus=function(){$(A.getUploadElement()).focus()};this.fieldEvents=function(){F.regFileUploadEvent();var K=I.getCloudService();if(I.isPickerRestricted()&&K!=""&&K.indexOf("mycomputer")==-1){G.disableField()}if(I.getDefaultValue()!=""&&I.getDefaultValue()!=undefined){if(B&&!H){if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}J=true;var L=I.isOneFileUpload();$(A.getImageIcons().querySelector(".calcIcon")).append(i18n.restoreMsg);G.setRestoreWidth();$(A.getImageIcons()).hide();$(A.getFieldParentDiv()).addClass("zc-bottomColr")}else{$($(A.getImageIcons()).children("span").eq(1)).removeAttr("tabindex")}G.bindFieldHoverEvent(A.getFieldParentDiv().querySelector(".zc-file-upload"));G.bindFieldFocusEvent(A.getFileInput(),A.getFieldParentDiv().querySelector(".zc-file-upload"),false);if(!B||H){G.hoverMesg(i18n.selectfileMsg)}$(A.getImageIcons().querySelectorAll(".calcIcon")).bind("mouseenter mouseleave",function(M){if(M.type=="mouseenter"){G.adjustLabelWidth(F.getModel().getComponentType(),true);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().addClass("zc-restore-hover")}G.placeHolderMsgRelatedChanges($(this),true);if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().addClass("zc-image-upload-hover")}if($(this).find("i").hasClass("arrows-1-cloud-upload-96")){$(this).parent().parent().addClass("zc-image-cloud-hover")}}else{if(M.type=="mouseleave"){G.adjustLabelWidth(F.getModel().getComponentType(),false);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().removeClass("zc-restore-hover")}G.placeHolderMsgRelatedChanges($(this),false);if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().removeClass("zc-image-upload-hover")}if($(this).find("i").hasClass("arrows-1-cloud-upload-96")){$(this).parent().parent().removeClass("zc-image-cloud-hover")}}}});$(A.getImageIcons()).css("z-index",$(A.getField()).zIndex()+1);$(A.getImageIcons().querySelectorAll(".calcIcon")).bind("click keyup focus blur",function(M){if(M.type=="focus"){$(this).addClass("zc-icon-focus");$(A.getFieldParentDiv()).addClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),true);return }else{if(M.type=="blur"){$(this).removeClass("zc-icon-focus");$(A.getFieldParentDiv()).removeClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),false);return }else{if(M.type=="keyup"&&M.which!=13){return }}}if(M.type=="keyup"&&M.which==13&&$(this).find("i").hasClass("arrows-1-cloud-upload-96")){$(this).click();return }if($(this).find("i").hasClass("arrows-2-square-upload")){$(A.getFileInput()).click()}if($(this).find("i").hasClass("arrows-4-undo-29")){A.getFileInput().removeAttr("tabindex");$($(A.getField()).parent()[0].querySelector(".arrows-4-undo-29.file-restore")).click();F.clearError();$(A.getImageIcons()).hide();if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileInput().focus()}})};this.placeHolderMsgRelatedChanges=function(L,K){if(K){G.inPlaceLayoutHover(C,true,H,"",J);if(J&&!$(L).find("i").hasClass("arrows-4-undo-29")){$(A.getImageIcons().querySelector(".calcIcon")).hide()}if($(L).find("i").hasClass("arrows-2-square-upload")){G.hoverMesg(i18n.localuploadHoverMsg);if(J){G.hoverMesg(i18n.localuploadHoverMsg,true)}}if($(L).find("i").hasClass("arrows-1-cloud-upload-96")){G.hoverMesg(i18n.cloudUploadHoverMsg);if(J){G.hoverMesg(i18n.cloudUploadHoverMsg,true)}}}else{G.hoverMesg(i18n.selectfileMsg);if(B&&!H){G.hoverMesg("",true);G.inPlaceLayoutHover(C,false,H,$(A.getUploadElement()).val(),J)}if(J){G.inPlaceLayoutHover(C,true,H,"",J);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block");G.hoverMesg("",true)}}};this.setRestoreWidth=function(){if(J){var M=I.getCloudService();var O=I.isOneFileUpload();var L=$($(A.getField()).parent()[0].querySelector(".filename")).width();var K;var N=$(A.getImageIcons().querySelector(".calcIcon:last-child")).width()+1;if(M!=undefined&&(O||M==""||(M.indexOf("mycomputer")==-1))){K=L-N-2}else{K=L-(2*N)-2}$(A.getImageIcons().querySelector(".calcIcon")).width(K);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block")}};this.hoverMesg=function(K,L){if(I.getDefaultValue()==undefined||I.getDefaultValue()==""||L){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(K)}};this.createUpload=function(K){K.beforeSend=function(){F.showLoader();F.getFormController().markActive()};K.success=function(P,Q,T){G.hoverMesg("",true);F.hideLoader();F.getFormController().unmarkActive();var O=[];for(var U in P){var L=P[U];for(var R=0,N=L.length;R<N;R++){var M=L[R];if(M.status=="error"){O.push("<b>"+M.docName+"</b>")}}}if(O.length>0){var S=(O.length>1)?"The following files are too larget to upload":"The following file is too large to upload";S+="<br/>"+O.join("<br/>");K.error()}else{if(P!=undefined&&!jQuery.isEmptyObject(P)){A.getFileInput().removeAttr("tabindex");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}}F.clearError();F.setValue(JSON.stringify(P));$(A.getFileInput()).focus();D=true}if(Object.keys(P).length>0){$(F.getField()).trigger("onuserinput");F.getView().bindFormulaForFileType(F)}};K.isPickerRestricted=function(){return F.isPickerRestricted()};K.ondelete=function(L){$(A.getFieldParentDiv().querySelector(".zc-file-upload")).trigger("mouseleave");G.setRestoreWidth();$(A.getImageIcons()).show();if(!K.isDefaultValuePreseent){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(i18n.selectfileMsg)}if($(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).removeClass("zc-bottomColr")}F.setValue("");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}D=false;F.getView().trigger("onuserinput");F.getView().bindFormulaForFileType(F);if(J){A.getFileInput().attr("tabindex","-1")}else{A.getFileInput().focus()}};K.onrestore=function(L){F.setValue(L);D=false};K.error=function(){F.clearError();F.hideLoader();F.getFormController().unmarkActive();$(A.getImageIcons()).show();$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(i18n.selectfileMsg);F.showError(i18n.fileuploadsizelimit);F.clear();LIB._stopLoading();clearTimeout(F.getFormController().submitTimeout)};$(A.getFileInput()).upload(K)};this.addToStore=function(){return D};this.destroy=function(){$(A.getUploadElement()).upload("destroy")};this.disableField=function(){A.getUploadElement().attr("disabled",true);$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable");A.getUploadElement().parent().addClass("zc-disabled");A.getUploadElement().parent().parent().addClass("zc-hideicon")};this.enableField=function(){var L=A.getImageIcons().querySelector(".calcIcon.cloudIcon");var K=(L!=null&&L!=undefined)?$(L).attr("isrestictedcno"):"false";if(K!="true"){A.getUploadElement().attr("disabled",false);$(A.getImageIcons().querySelectorAll(".calcIcon")).removeClass("zc-eventDisable");A.getUploadElement().parent().removeClass("zc-disabled");A.getUploadElement().parent().parent().removeClass("zc-hideicon")}};this.bindFocus=function(){if(!H){var K=A.getUploadElement();if(!LIB._isNull($(K).val())&&!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}$(K).mouseover(function(){G.inPlaceLayoutHover(C,true,H,"",J);G.hoverMesg(i18n.selectfileMsg,true);G.adjustLabelWidth(F.getModel().getComponentType(),true)}).mouseout(function(){G.hoverMesg("",true);G.inPlaceLayoutHover(C,false,H,$(K).val(),J);G.adjustLabelWidth(F.getModel().getComponentType(),false)})}}});createPrototype(FileUploadView,FieldView.prototype);var MediaUploadView=(function(A,F,E){FieldView.call(this,A,F,E);var D=false,G=this;var I=A.getModel();var B=G.isFloatLabelAlignment();var C=A.getFieldParentGroup();var H=I.isSubformField();var J=false;this.focus=function(){$(A.getUploadElement()).focus()};this.fieldEvents=function(){F.regFileUploadEvent();$(A.getImageIcons()).css("z-index",$(A.getFileInput()).parent().zIndex()+1);if(I.getDefaultValue()!=""&&I.getDefaultValue()!=undefined){if(B&&!H){if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}J=true;$(A.getImageIcons().querySelector(".calcIcon")).append(i18n.restoreMsg);G.setRestoreWidth();$(A.getImageIcons()).hide();$(A.getFieldParentDiv()).addClass("zc-bottomColr")}else{$($(A.getImageIcons()).children("span").eq(1)).removeAttr("tabindex")}G.bindFieldHoverEvent(A.getFieldParentDiv().querySelector(".zc-file-upload"));G.bindFieldFocusEvent(A.getFileInput(),A.getFieldParentDiv().querySelector(".zc-file-upload"),false);if(!B||H){G.hoverMesg(i18n.selectfileMsg)}$(A.getImageIcons().querySelectorAll(".calcIcon")).bind("mouseenter mouseleave",function(K){if(K.type=="mouseenter"){G.adjustLabelWidth(F.getModel().getComponentType(),true);G.placeHolderMsgRelatedChanges($(this),true);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().addClass("zc-restore-hover")}if($(this).find("i").hasClass("media-1-video-64")){$(this).parent().parent().addClass("zc-video-upload-hover")}if($(this).find("i").hasClass("media-1-audio-91")){$(this).parent().parent().addClass("zc-audio-upload-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().addClass("zc-image-upload-hover")}}else{if(K.type=="mouseleave"){G.adjustLabelWidth(F.getModel().getComponentType(),false);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().removeClass("zc-restore-hover")}G.placeHolderMsgRelatedChanges($(this),false);if($(this).find("i").hasClass("media-1-video-64")){$(this).parent().parent().removeClass("zc-video-upload-hover")}if($(this).find("i").hasClass("media-1-audio-91")){$(this).parent().parent().removeClass("zc-audio-upload-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().removeClass("zc-image-upload-hover")}}}});$(A.getImageIcons().querySelectorAll(".calcIcon")).unbind("click");$(A.getImageIcons().querySelectorAll(".calcIcon")).bind("click keyup focus blur",function(K){if(K.type=="focus"){$(this).addClass("zc-icon-focus");$(A.getFieldParentDiv()).addClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),true);return }else{if(K.type=="blur"){$(this).removeClass("zc-icon-focus");$(A.getFieldParentDiv()).removeClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),false);return }else{if(K.type=="keyup"&&K.which!=13){return }}}if($(this).find("i").hasClass("media-1-video-64")){K.preventDefault();$(A.getUploadElement()).focus();F.getMediaPopup().openCamRecorder(A)}if($(this).find("i").hasClass("media-1-audio-91")){K.preventDefault();$(A.getUploadElement()).focus();F.getMediaPopup().openAudioRecorder(A)}if($(this).find("i").hasClass("arrows-2-square-upload")){$(A.getFileInput()).click()}if($(this).find("i").hasClass("arrows-4-undo-29")){A.getFileInput().removeAttr("tabindex");$($(A.getField()).parent()[0].querySelector(".arrows-4-undo-29.file-restore")).click();$(A.getImageIcons()).hide();if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileInput().focus()}})};this.placeHolderMsgRelatedChanges=function(L,K){if(K){G.inPlaceLayoutHover(C,true,H,"",J);if(J&&!$(L).find("i").hasClass("arrows-4-undo-29")){$(A.getImageIcons().querySelector(".calcIcon")).hide()}if($(L).find("i").hasClass("media-1-video-64")){G.hoverMesg(i18n.cameraHoverMsg);if(J){G.hoverMesg(i18n.cameraHoverMsg,true)}}if($(L).find("i").hasClass("media-1-audio-91")){G.hoverMesg(i18n.audioHoverMsg);if(J){G.hoverMesg(i18n.audioHoverMsg,true)}}if($(L).find("i").hasClass("arrows-2-square-upload")){G.hoverMesg(i18n.localuploadHoverMsg);if(J){G.hoverMesg(i18n.localuploadHoverMsg,true)}}}else{G.hoverMesg(i18n.selectfileMsg);if(B&&!H){G.inPlaceLayoutHover(C,false,H,$(A.getUploadElement()).val(),J);G.hoverMesg("",true)}if(J){G.inPlaceLayoutHover(C,true,H,"",J);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block");G.hoverMesg("",true)}}};this.setRestoreWidth=function(){if(J){var L=$($(A.getField()).parent()[0].querySelector(".filename")).width();var M=$(A.getImageIcons().querySelector(".calcIcon:last-child")).width()+1;var K=L-(2*M)-2;$(A.getImageIcons().querySelector(".calcIcon")).width(K);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block")}};this.hoverMesg=function(K,L){if(I.getDefaultValue()==undefined||I.getDefaultValue()==""||L){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(K)}};this.createUpload=function(K){K.beforeSend=function(){F.showLoader();F.getFormController().markActive()};K.success=function(P,Q,U){G.hoverMesg("",true);F.hideLoader();F.getFormController().unmarkActive();var O=[];var T=false;for(var W in P){var L=P[W];for(var R=0,N=L.length;R<N;R++){var M=L[R];if(M.status=="error"){O.push(M.docName)}else{if(M.status=="mismatchedTypeError"){T=true;O.push(M.errorMsg)}}}}var V=F.getMediaPopup();F.clearError();V.clearError();$(A.getImageIcons()).hide();$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html("");if(O.length>0){var S=(O.length>1)?"The following files are too larget to upload":"The following file is too large to upload";if(T){S=""}S+=O;K.error(S);V.setError()}else{A.getFileInput().removeAttr("tabindex");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}F.setValue(JSON.stringify(P));$(A.getFileInput()).focus();D=true}$(F.getField()).trigger("onuserinput");F.getView().bindFormulaForFileType(F)};K.ondelete=function(L){$(A.getFieldParentDiv().querySelector(".zc-file-upload")).trigger("mouseleave");G.setRestoreWidth();$(A.getImageIcons()).show();if(!K.isDefaultValuePreseent){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(i18n.selectfileMsg)}if($(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).removeClass("zc-bottomColr")}F.setValue("");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(J){A.getFileInput().attr("tabindex","-1")}else{A.getFileInput().focus()}D=false;$(F.getField()).trigger("onuserinput");F.getView().bindFormulaForFileType(F)};K.onrestore=function(L){F.setValue(L);D=false};K.error=function(M){F.clearError();F.hideLoader();var L=F.getMediaPopup();F.getFormController().unmarkActive();if(typeof M=="string"){F.showError(M)}else{L.setError();L.showError(M)}F.clear();LIB._stopLoading();clearTimeout(F.getFormController().submitTimeout)};$(A.getUploadElement()).upload(K)};this.addToStore=function(){return D};this.destroy=function(){$(A.getUploadElement()).upload("destroy")};this.disableField=function(){A.getUploadElement().attr("disabled",true);$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable");A.getUploadElement().parent().addClass("zc-disabled");A.getUploadElement().parent().parent().addClass("zc-hideicon")};this.enableField=function(){A.getUploadElement().attr("disabled",false);A.getUploadElement().parent().removeClass("zc-disabled");A.getUploadElement().parent().parent().removeClass("zc-hideicon");$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable")};this.bindFocus=function(){if(!H){var K=A.getUploadElement();if(!LIB._isNull($(K).val())&&!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}$(K).mouseover(function(){G.inPlaceLayoutHover(C,true,H,"",J);G.hoverMesg(i18n.selectfileMsg,true);G.adjustLabelWidth(F.getModel().getComponentType(),true)}).mouseout(function(){G.hoverMesg("",true);G.inPlaceLayoutHover(C,false,H,$(K).val(),J);G.adjustLabelWidth(F.getModel().getComponentType(),false)})}};this.getUploadField=function(){return A.getUploadField()}});createPrototype(MediaUploadView,FieldView.prototype);var SelectView=(function(C,B,A){FieldView.call(this,C,B,A);this.setValue=function(D){$(C.getField()).select2("zcData",D);C.getModel().setDefaultValue(D);if(this.isFloatLabelAlignment()){C.getField().trigger("blur")}};this.destroy=function(){C.getField().select2("destroy")};this.focus=function(){var D=this.getField();setTimeout(function(){D.select2("focus")},10)};this.fieldEvents=function(){if(B.getModel().isCompositeSubField()){return }else{setTimeout(function(){B.createSelect()},0)}var D=B.getModel();var E=C.getField();if(!D.isSubformField()&&D.getComponentType()==FieldType.INLINE_RADIO){E=$(C.getFieldDOM().querySelectorAll("input"))}$(E).change(function(){if($(this).val()==Constants.OTHER_OPTION){C.getOtherValueContainer().show(400)}else{C.getOtherValueContainer().hide(400)}})};this.getSelectedChoice=function(){return C.getModel().getDefaultValue()};this.intitateSelect=function(E,H){var J=this;var L=true;var D=this.isFloatLabelAlignment();var K=!LIB._isNull(J.getValue());if(D&&K&&!C.getFieldParentGroup().hasClass("zc-label-float")){if(C.getModel().getComponentType()==FieldType.LIST&&C.getModel().getDefaultValue().length==0){K=false}if(K){C.getFieldParentGroup().addClass("zc-label-float")}}function I(){if(D){C.getFieldParentGroup().addClass("zc-focus");if(!C.getFieldParentGroup().hasClass("zc-label-float")){C.getFieldParentGroup().addClass("zc-label-float")}}var N=$(this).data("select2");var M=this;setTimeout(function(){var R=B.getFormController().getModel().getFirstFieldName();if(!N.opened()&&!$(M).parent(".form-field").hasClass("select2Err")&&R!=B.getModel().getActualLabelName()){var U=false;var P=B.getModel();if(P.hasAddToParent()){var O=0;var Q=P.getChoices("");var T=Q.length;var S=C.getField().select2("data");if(!isNull(S)){O=S.length}if(O>0){Q=Q.filter(function(V){return(V.text!="")});T=Q.length}if(T==O){U=true}}if(P.isFromReport()||U){N.open()}}$(M).parent(".form-field").removeClass("select2Err")},0)}var F=C.getField().select2(E).on("change",function(M){if(!C.getModel().isFromReport()){if(E.multiple){$(this).data().select2.highlight(0)}}else{H.reinitZCScrollPane()}}).on("select2-loaded",function(){B.positionDropDown($("#select2-drop")[0],$(C.getDropDownWrapper()));if(E.multiple&&E.isFirstValue){$(this).data().select2.highlight(0)}}).on("select2-opening",function(){if(L){$(E.data).each(function(O,N){if(N!=undefined){var P=document.createElement("textarea");N.text=decode(P,N.text);if(!C.getModel().isLookup()){N.id=P.value}}});L=false;var M=B.getModel();if(E.data.length<=10&&!M.isExternalField()){C.getSearchBoxContainer().addClass("select2-search-hidden select2-offscreen");if(ZCGlobal.isMobileLayout){F.select2("container").find(".select2-focusser").attr("readonly","readonly")}}}}).on("select2-open",function(){if(E.multiple){$(this).data().select2.highlight(0)}}).one("select2-focus",I).on("select2-blur",function(){$(this).one("select2-focus",I);if(D){if(C.getFieldParentGroup().hasClass("zc-focus")){C.getFieldParentGroup().removeClass("zc-focus")}var M=!LIB._isNull(J.getValue());if(C.getModel().getComponentType()==FieldType.INLINE_PICK_LIST){var N=C.getModel().getDefaultValue();N=(N!=undefined&&N!=null)?N.id:"";if(Constants.OTHER_OPTION==N){M=true}}if(C.getModel().getComponentType()==FieldType.LIST){M=C.getModel().getDefaultValue().length>0}if(!M){C.getFieldParentGroup().removeClass("zc-label-float")}}}).on("select2-selecting",function(O){var M=C.getField().select2("data");if(C.getModel().isSingleSelect()){M=O.object}else{if(M!=null&&M.length>0){M.push(O.object)}else{M=[];M.push(O.object)}}if(ZCGlobal.isMobileLayout){F.select2("container").find(".select2-focusser").attr("readonly","readonly")}M=(M==null)?"":M;C.getModel().setDefaultValue(M);if(C.getModel().isFromReport()){var N=O.choice;var Q=C.getField().select2("data");var P=0;if(Q!=null){$.each(Q,function(R,S){if(S.id instanceof Object){$.each(S.id,function(T,U){P++})}else{P++}})}if(N.id instanceof Object){$.each(N.id,function(R,S){P++})}else{P++}if(P>6){C.getField().select2("close");$.alert({msg:i18n.searchlimit});return false}}}).on("select2-clearing",function(M){C.getModel().setDefaultValue("")}).on("select2-removing",function(P){var M=C.getField().select2("data");for(var O=0;O<M.length;O++){var N=M[O];if(P.choice.id==N.id&&P.choice.text==N.text){M.splice(O,1)}}C.getModel().setDefaultValue(M)});if(C.getModel().isFromReport()){$((C.getField().parent()).find(".select2-search-field > input.select2-input")).on("paste",function(N,M){var O=$.trim(N.originalEvent.clipboardData.getData("text"));$(this).val(O);return false});$(C.getField()).focus()}var G=C.getModel().getLabelName();C.getFieldParent().find(".select2-input").attr("name","zc-sel2-inp-"+G);C.getFieldParent().find(".select2-input").attr("autocomplete","new-zc-sel2-inp-"+G);C.getFieldParent().find(".select2-focusser.select2-offscreen").attr("name","zc-sel2-foc-"+G);C.getFieldParent().find(".select2-focusser.select2-offscreen").attr("autocomplete","new-zc-sel2-foc-"+G);return F};this.disableField=function(){var F=function(){var G=navigator.userAgent;if(G.indexOf("MSIE ")!=-1){return true}if(G.indexOf("Trident/")!=-1){return true}if(G.indexOf("Edge/")!=-1){return true}return false};if(F()==true){var E=C.getField().select2("data");C.getField().select2("destroy");C.getField().prop("disabled",true);B.createSelect();C.getField().select2("data",E)}else{C.getField().prop("disabled",true)}var D=C.getModel();if(D.isOtherEnabled()){C.getOtherValueField().attr("disabled",true);if(isEdgeBrowser()){C.getOtherValueField().attr("readonly",true)}}};this.enableField=function(){this.getField().attr("disabled",false);var D=C.getModel();if(D.isOtherEnabled()){C.getOtherValueField().prop("disabled",false);if(isEdgeBrowser()){C.getOtherValueField().attr("readonly",false)}}}});createPrototype(SelectView,FieldView.prototype);var DropdownView=(function(C,B,A){SelectView.call(this,C,B,A);this.getValue=function(){if(C.getModel().isName_PrefixField()||C.getModel().isAddress_CountryField()){var J=C.getModel().getLabelName();var G=B.getParentField();if(C.getModel().isName_PrefixField()){return G.getView().getValue(J)}var L="";var K=G.getView().getValue(J);L=Constants.COUNTRY_MAP[K];L=(L!=undefined)?L:K;return L}var E=C.getModel().getDefaultValue();if(C.getModel().getSystemDisplayType()==FieldType.USER_MULTI_SELECT){var H=C.getModel().getDefaultValue(),D=[];if(E!=undefined&&E!=null){for(var I=0,F=H.length;I<F;I++){D.push(H[I].id)}}return JSON.stringify(D)}E=(E!=undefined&&E!=null)?E.id:"";if(E==Constants.OTHER_OPTION){E=$((C.getField().closest(".form-field"))[0].querySelectorAll('div[elname="othersinput"] > input')).val()}return E};$((C.getField().closest(".form-field"))[0].querySelectorAll('div[elname="othersinput"] > input')).change(function(){$(B.getField()).trigger("change")})});createPrototype(DropdownView,SelectView.prototype);var RadioView=(function(D,B,A){SelectView.call(this,D,B,A);var C=false;this.trigger=function(E){D.getField().first().trigger(E)};$(D.getFieldParent()).find('span[elname="zc-show-parent"]').click(function(){if(!C){B.addNewParent($(D.getFieldDOM().querySelectorAll("input")))}});if(D.getField().data("select2")==undefined){this.focus=function(){this.getField().focus()}}this.setValue=function(E){if(D.getField().data("select2")!=undefined){D.getField().select2("data",E);D.getModel().setDefaultValue(E)}else{if(E==""){$(D.getFieldDOM().querySelectorAll("input")).filter(":checked").removeAttr("checked")}else{$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+E.id+'"]').prop("checked",true)}}};this.getValue=function(){var E;if(D.getModel().isSelectField()){E=D.getModel().getDefaultValue();E=(E!=undefined&&E!=null)?E.id:""}else{E=$(D.getFieldDOM().querySelectorAll("input")).filter(":checked").val();E=(E!=null&&E!=undefined)?E:""}if(E==Constants.OTHER_OPTION){E=$((D.getField().closest(".form-field"))[0].querySelector('div[elname="othersinput"] > input')).val()}return E};this.getSelectedChoice=function(){if(D.getField().data("select2")!=undefined){return D.getField().select2("data")}else{return this.getValue()}};this.deselect=function(E){$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+E[0].id+'"]').removeAttr("checked")};this.clearChoices=function(){D.getOptionsDiv().empty()};this.appendChoices=function(R){var N=D.getOptionsDiv(),S=$(N.find(".choice-table-row")).length;var M=D.getOptionTemplate();var K=D.getModel().getChoiceColumn();var Q=R.length;var G=0;var O=D.getModel();if(O.isOtherEnabled()){var E=N[0].querySelector("input[elname=othersVal"+O.getFormComponentId()+"]");if(E!=null){$(E).parent().parent().empty()}}for(var P=0;P<Q;P++){N.append('<div class="choice-table-row">');for(var J=0,H=K;J<H;J++){if(Q>G){var I=$(M.replace(/\$\{INDEX\}/g,S+1).replace("${CHOICE.TEXT}",R[G].text));I.find("input").val(R[G].id);N.append(I);S++;G++}}N.append("</div>");if((Q==G)&&O.isOtherEnabled()){if((G%K)==0){N.append('<div class="choice-table-row">')}var F=D.getOtherTemplate();N.append(F)}if(Q>G){N.append('<div class="choice-table-row">')}else{break}}var L=$(D.getFieldDOM().querySelectorAll("input"));$(L).unbind("change").bind("change",function(){if($(this).val()==Constants.OTHER_OPTION){D.getOtherValueContainer().show(400)}else{D.getOtherValueContainer().hide(400)}});if(C){this.disableField()}};this.disableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",true)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","disabled")}C=true};this.enableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",false)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","")}C=false};$((D.getField().closest(".form-field"))[0].querySelectorAll('div[elname="othersinput"] > input')).change(function(){$(B.getField()).trigger("change")})});createPrototype(RadioView,SelectView.prototype);var MultiSelectView=(function(C,B,A){SelectView.call(this,C,B,A);this.getValue=function(){var G=C.getModel().getDefaultValue(),F=[];for(var E=0,D=G.length;E<D;E++){F.push(G[E].id)}return JSON.stringify(F)}});createPrototype(MultiSelectView,SelectView.prototype);var CheckBoxView=(function(D,B,A){SelectView.call(this,D,B,A);var C=false;this.trigger=function(E){D.getField().first().trigger(E)};$(D.getFieldParent()).find('span[elname="zc-show-parent"]').click(function(){if(!C){B.addNewParent($(D.getFieldDOM().querySelectorAll("input")))}});if(D.getField().data("select2")==undefined){this.focus=function(){this.getField().focus()}}this.setValue=function(F){var G=B;var H=G.getModel().isSubformField()?G.getFormController().getFormController():G.getFormController();var E=H.getWorkflowController();if(E==undefined){E=new WorkflowController(H)}if(E.getIsSetTask()){$(D.getFieldDOM().querySelectorAll("input")).removeAttr("checked")}if(D.getField().data("select2")!=undefined){$(D.getField()).select2("data",F)}else{if(typeof (F)=="object"){for(ind in F){$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+F[ind].id+'"]').prop("checked",true)}}else{if(F==""&&!E.getIsSelectTask()){$(D.getFieldDOM().querySelectorAll("input")).removeAttr("checked")}}}D.getModel().setDefaultValue(F)};this.getValue=function(){var I=[],K=D.getModel();if(K.isSearchEnabled()||K.isSubformField()){var J=K.getDefaultValue();for(var G=0,E=J.length;G<E;G++){I.push(J[G].id)}}else{var F=$(D.getFieldDOM().querySelectorAll("input")).serializeArray();if($(D.getFieldDOM().querySelectorAll("input")).prop("disabled")){var H=$(D.getFieldDOM().querySelectorAll("input")).removeAttr("disabled");F=$(D.getFieldDOM().querySelectorAll("input")).serializeArray();H.attr("disabled","disabled")}for(var G=0,E=F.length;G<E;G++){I.push(F[G].value)}}return JSON.stringify(I)};this.getSelectedChoice=function(){if(D.getField().data("select2")!=undefined){return $(D.getField()).select2("data")}else{return $(D.getFieldDOM().querySelectorAll("input")).serializeArray()}};this.deselect=function(E){for(ind in E){$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+E[ind].id+'"]').removeAttr("checked")}};this.clearChoices=function(){D.getOptionsDiv().empty()};this.appendChoices=function(N){var K=D.getOptionsDiv(),O=$(K.find(".choice-table-row")).length;var J=D.getOptionTemplate();var I=D.getModel().getChoiceColumn();var M=N.length;var E=0;for(var L=0;L<M;L++){K.append('<div class="choice-table-row">');for(var H=0,F=I;H<F;H++){if(M>E){var G=$(J.replace(/\$\{INDEX\}/g,O+1).replace("${CHOICE.TEXT}",N[E].text));G.find("input").val(N[E].id);K.append(G);O++;E++}}K.append("</div>");if(M>E){K.append('<div class="choice-table-row">')}else{break}}if(C){this.disableField()}};this.disableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",true)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","disabled")}C=true};this.enableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",false)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","")}C=false}});createPrototype(CheckBoxView,SelectView.prototype);var CompositeView=(function(C,B,A){FieldView.call(this,C,B,A);this.fieldEvents=function(){this.bindEvents()};this.initiateSelect=function(D){};this.bindEvents=function(){};this.getValue=function(D){return C.getChildField(D).val()};this.setValue=function(E,D){if(C.getChildField(E).is("select")){$(C.getChildField(E).find("option[value='"+D+"']")).attr("selected",true);if(this.isFloatLabelAlignment()){C.getField().trigger("blur")}}else{C.getChildField(E).val(D);if(this.isFloatLabelAlignment()){C.getField().trigger("blur")}}};this.resetDropdown=function(D){C.getDropdown(D).get(0).selectedIndex=0};this.clearError=function(){if(this.hasError){C.getFieldParent().removeClass("validationError");C.getAllChildFields().removeClass("childValError");$(C.getFieldParent().find(".fieldErrorMsg")).remove();this.hasError=false}};this.bindFocus=function(){$.each(C.getAllChildFields(),function(){var D=this;var E=$(this).attr("elname");var F=$(D.querySelector("#"+E));if($(F).data("select2")!=undefined){if(!LIB._isNull($(F).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}$(F).on("select2-focus",function(){$(D).addClass("zc-focus");if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}).on("select2-blur",function(){if($(D).hasClass("zc-focus")){$(D).removeClass("zc-focus")}if(LIB._isNull($(F).val())&&$(D).hasClass("zc-label-float")){$(D).removeClass("zc-label-float")}else{if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}})}else{if(!LIB._isNull($(F).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}$(F).focus(function(){$(D).addClass("zc-focus");if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}).blur(function(){if($(D).hasClass("zc-focus")){$(D).removeClass("zc-focus")}if(LIB._isNull($(F).val())&&$(D).hasClass("zc-label-float")){$(D).removeClass("zc-label-float")}else{if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}})}})}});createPrototype(CompositeView,FieldView.prototype);var NameView=(function(C,B,A){CompositeView.call(this,C,B,A);this.destroy=function(){C.getPrefixSelect().select2("destroy")};this.showError=function(D){if(!this.hasError){C.getAllChildFields().each(function(F,G){var H=$(G).attr("elname");var I=$(G).find("#"+H).val();if(isNull(I.trim())){$(G).addClass("childValError")}});var E=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+D+"</div>");C.getFieldParent().append(E).addClass("validationError");this.hasError=true}};this.initiateSelect=function(G){var D=B.getModel().getActualLabelNameFromMapKey("prefix");var E=B.getCompositeSubField(D).getModel();if(G==="prefix"){var F=C.getPrefixSelect().find("option");var I=document.createElement("textarea");$.each(F,function(J,K){I.innerHTML=K.value;K.value=I.value;I.innerHTML=K.text;K.text=I.value});C.getPrefixSelect().val(E.getDefaultValue());var H=C.getPrefixSelect().select2({placeholder:(!this.isFloatLabelAlignment())?(ZCGlobal.isMobileLayout?$(C.getPrefixSelect()).parent().attr("display-name"):i18n.prefixplaceholder):" ",minimumResultsForSearch:-1}).on("select2-loaded",function(){B.positionDropDown($("#select2-drop")[0],$(C.getDropDownWrapper()))})}};this.disableField=function(){if(C.getPrefixSelect().length>0&&C.getPrefixSelect().data("select2")!=undefined){C.getPrefixSelect().attr("disabled",true);if(isEdgeBrowser()){C.getPrefixSelect().attr("readonly",true)}}this.getDOM().getInputFields().attr("disabled",true);if(isEdgeBrowser()){this.getDOM().getInputFields().attr("readonly",true)}};this.enableField=function(){if(C.getPrefixSelect().length>0&&C.getPrefixSelect().data("select2")!=undefined){C.getPrefixSelect().attr("disabled",false);if(isEdgeBrowser()){C.getPrefixSelect().attr("readonly",false)}}this.getDOM().getInputFields().attr("disabled",false);if(isEdgeBrowser()){this.getDOM().getInputFields().attr("readonly",false)}}});createPrototype(NameView,CompositeView.prototype);var AddressView=(function(E,D,C){CompositeView.call(this,E,D,C);var B=this;this.showGeocodeLoader=function(){E.getAdjustLocationWrapper().append('<i class="zc-geocodeLoader fa fa-spinner fa-spin"></i>')};this.hideGeocodeLoader=function(){$(E.getAdjustLocationWrapper().find(".zc-geocodeLoader")).remove()};this.destroy=function(){E.getCountrySelect().select2("destroy")};this.showError=function(G){if(!this.hasError){var H=JSON.parse(G);var I=H[Constants.ADDRESS_ERROR_MESSAGE];if(H[Constants.ADDRESS_ERROR_TYPE]==Constants.ADDRESS_INVALID_ZIP_TYPE){E.getPostalCodeEl().addClass("childValError")}else{E.getAllChildFields().each(function(K,L){var M=$(L).attr("elname");var N=$(L).find("#"+M).val();if(M!="locality"&&isNull(N.trim())){$(L).addClass("childValError")}})}E.getFieldParent().addClass("validationError");var J=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+I+"</div>");J.insertBefore(E.getLocationContainer());this.hasError=true}};var A;var F;this.isCountrySubFieldPresent=function(){return(E.getCountrySelect().length>0)};this.initiateSelect=function(G){if(G==="country"&&this.isCountrySubFieldPresent()&&E.getCountrySelect().data("select2")==undefined){var H=D.getModel().getActualLabelNameFromMapKey("country");var K=D.getCompositeSubField(H).getModel();E.getCountrySelect().val(K.getDefaultValue());var J=D;var I=$.map(Constants.COUNTRY_DATA,function(L){L.id=L.id||L.iso2;L.text=L.text||L.name;if(!LIB._isNull(E.getCountrySelect().val())&&LIB._isNull(A)){if((L.id).toLowerCase===(E.getCountrySelect()).val()||(L.text).toLowerCase()===(E.getCountrySelect().val()).toLowerCase()){A=L}}return L});F=E.getCountrySelect().select2({allowClear:true,placeholder:(!this.isFloatLabelAlignment())?(ZCGlobal.isMobileLayout?$(E.getCountrySelect()).parent().attr("display-name"):i18n.selectplaceholder):" ",data:I}).on("select2-loaded",function(){D.positionDropDown($("#select2-drop")[0],$(E.getDropDownWrapper()))});if(A!=undefined&&A.iso2!=undefined){$(F).val(A.iso2);$(F).select2("data",{id:A.id,text:A.text})}}};this.bindEvents=function(){E.getAdjustLocationIcon().click(function(){if(!$(this).hasClass("disable")){B.openZMap()}})};this.openZMap=function(){var H="map_"+(Math.floor(Math.random()*100000));var G={lat:"",lon:""};var J="",I="";$.zcmodal({title:i18n.pickyourlocation,type:ZCModalConstants.JIT_MODAL,width:700,closeOnAnyClick:false,beforeShow:function(K){if(useCompression){require(["mapbox"],function(M){window.mapboxgl=M;L()})}else{L()}function L(){var P;var R=[];var N=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));J=G.lat=N.getValue();var M=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));I=G.lon=M.getValue();var Q=$("#zMap");function O(){P.on("click",function(S){G.lat=S.lngLat.lat.toString();G.lon=S.lngLat.lng.toString();R.push(G);Q.find("#"+H+" .zc-marker-div").remove();createMarker(R,P)})}P=new mapboxgl.Map({container:H,style:OpenSansMapReportJson,hash:false,zoom:10,maxZoom:18,minZoom:7.5,center:new mapboxgl.LngLat(G.lon,G.lat)});R.push(G);createMarker(R,P);O()}},beforeClose:function(){var K=false;jQuery.each(E.getAllChildFields(),function(O,N){var L=$(this).attr("elname");var M=$(this).find("#"+L);if($(M).val()!=undefined&&isNull($(M).val().trim())){$(N).find("input").focus();K=true;return false}});if(!K){$(E.getPrimaryOuterEl()).find("input").focus()}},buildDOM:function(){var K=500;if($(window).height()<700){K=$(window).height()-230}var L="<div id='zMap' class='zc-form-address-map'>";L+="<div id='"+H+"' style='height:"+K+"px; position:relative'><div style='height:"+K+"px; background-color:#E8E5D8; position:absolute; left:0; top:0; width:100%'></div></div>";L+="</div>";return L},buttons:[{id:"Done",name:i18n.done,type:ZCModalConstants.MODAL_SUBMIT,action:function(){var K=(J!=G.lat)||(I!=G.lon);if(K){B.updateZMAPLocation(G.lat,G.lon,true)}}},{id:"Cancel",name:i18n.cancel,type:ZCModalConstants.MODAL_CANCEL,action:function(){}}]})};this.updateZMapAddress=function(J){var L=E.getField();var I;for(k in J){var K=E.getField().find("#"+k).val();if(k=="countryCode"){K=E.getField().find("#country").val()}if(k!="country"&&K!=J[k]){I=E.getField().find("#"+k);break}}E.getInputFields().val("");var H=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));H.getView().setValue("");var G=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));G.getView().setValue("");for(k in J){if(J[k]==undefined||J[k]==null){$(L).find("#"+k).val("")}else{if(k==="country"){var M={id:J.countryCode,text:Constants.COUNTRY_MAP[J.countryCode]};$(E.getCountrySelect()).select2("data",M);if(this.isFloatLabelAlignment()){E.getField().find("#"+k).trigger("blur")}}else{$(L).find("#"+k).val(J[k]);if(this.isFloatLabelAlignment()){E.getField().find("#"+k).trigger("blur")}}}}if(I!==undefined){$(I).trigger("change")}};this.updateZMAPLocation=function(J,K,G){var I=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));I.getView().setValue(J);var H=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));H.getView().setValue(K);this.toggleAdjustLocationContent();if(E.getModel().isOnChangeExist()&&G){this.trigger("onuserinput")}};this.disableAdjustLocation=function(){$(E.getAdjustLocationIcon()).addClass("disable");E.getAdjustLocationWrapper().find(".zc-adjustlocation-info").hide()};this.enableAdjustLocation=function(){$(E.getAdjustLocationIcon()).removeClass("disable");E.getAdjustLocationWrapper().find(".zc-adjustlocation-info").show()};this.showWarning=function(H){var G=$('<div class="zc-geocodeWarning"><i class="zc-geocodeWarningIcon zc-li-outline ui-3-alert"></i><span class="zc-geocodeWarning-content">'+H+"</span></div>");E.getAdjustLocationWrapper().append(G)};this.clearWarning=function(){$((E.getAdjustLocationWrapper()).find(".zc-geocodeWarning")).remove()};this.disableField=function(){if(E.getCountrySelect().length>0&&E.getCountrySelect().data("select2")!=undefined){E.getCountrySelect().attr("disabled",true);if(isEdgeBrowser()){E.getCountrySelect().attr("readonly",true)}}var G=E.getPrimarySelectFld();if(G.length>0&&G.data("select2")!=undefined){G.attr("disabled",true);if(isEdgeBrowser()){G.attr("readonly",true)}E.getPrimaryOuterEl().hasClass("map-icon-disable")?"":E.getPrimaryOuterEl().addClass("map-icon-disable")}this.getDOM().getInputFields().attr("disabled",true);if(isEdgeBrowser()){this.getDOM().getInputFields().attr("readonly",true)}};this.enableField=function(){if(E.getCountrySelect().length>0&&E.getCountrySelect().data("select2")!=undefined){E.getCountrySelect().attr("disabled",false);if(isEdgeBrowser()){E.getCountrySelect().attr("readonly",false)}}var G=E.getPrimarySelectFld();if(G.length>0&&G.data("select2")!=undefined){G.attr("disabled",false);if(isEdgeBrowser()){G.attr("readonly",false)}E.getPrimaryOuterEl().removeClass("map-icon-disable")}this.getDOM().getInputFields().attr("disabled",false);if(isEdgeBrowser()){this.getDOM().getInputFields().attr("readonly",false)}};this.toggleAdjustLocationContent=function(){var I=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));var J=I.getValue();var H=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));var G=H.getValue();if(!isNull(J)||!isNull(G)){E.getLocationPlaceHolder().hide();E.getCoordinateInputs().show()}else{E.getLocationPlaceHolder().show();E.getCoordinateInputs().hide()}if(E.getModel().isAdjustLocation()){isNull(J)||isNull(G)?this.disableAdjustLocation():this.enableAdjustLocation()}}});createPrototype(AddressView,CompositeView.prototype);var SubformView=(function(G,D,C){FieldView.call(this,G,D,C);var B=false;var A=this,F=0,H=15,E=0;if(ZCGlobal.isMobileLayout){H=0}E=G.getField().closest("div.formColumn").width()-H;this.fieldEvents=function(){if(B){setTimeout(function(){D.createDefaultRow()},0)}else{D.createDefaultRow()}};this.getValue=function(){return $(G.getField()).val()};this.clearRow=function(){G.setRow(undefined)};this.setRow=function(I){G.setRow(I)};this.bindSortable=function(I){I.containment=G.getField(),G.getInnerWrapper().sortable(I)};this.reorderSubform=function(M,P){var L=$(M).prev(),O=$(M).nextAll('div[elname="dataRow"]'),N=0;if(L.length>0){var J=$(L).attr("rowno");N=parseInt(J.substr(J.indexOf("_")+1,J.length))}var I=N;O.each(function(){K(this,I+2);I++});K(M,N+1);function K(Q,T){var R=$(Q).attr("rowno"),S=R.substr(0,R.indexOf("_"));$(Q).attr("rowno",S+"_"+T)}};this.createNewRow=function(K,M,J){var L=$(M).attr("rowNo",K),I=L[0].querySelector(".form-group");if(G.getModel().getSubformType()==Constants.POPUP_SUBFORM){$(L[0].querySelectorAll(".notes-field")).hide()}if(!J){$(I.querySelectorAll("label")).hide()}if(G.getModel().isEmptyRow()){G.getInnerWrapper().empty();G.getModel().setEmptyRow(false)}G.getInnerWrapper().append(L);return L};this.createVoidRow=function(){var J="t::row_0";G.getModel().setEmptyRow(true);G.getInnerWrapper().append(G.getModel().getVoidRow());var I=G.getRow(J);this.calibrateWidth(I);this.showPlaceHolder(true);G.getBottomAddNewLink().hide();this.getField().addClass("zcPlacehldflow");this.getField().removeClass("zc-placeholder-overflow")};this.getRow=function(I){return G.getRow(I)};this.getDeleteLink=function(I){return G.getDeleteLink(I)};this.getAddLink=function(){return G.getAddNewLink()};this.setFormStyle=function(R,U){var N="",V=1;var I=0;var S=G.getModel();if(!S.isNewSubform()){var L={};while(V<=M()){L=P(V,N,I);N=L.css;I=L.totColsWidth;++V}}else{V=0;var L=P(V,N,I);N=L.css;I=L.totColsWidth}T(N);$(R).parent().css("width",Math.ceil(I));function P(b,a,Z){var d=0,Y=30;var X=K(O(b));var c=b==0||b==1?"first-column":(b==2?"second-column":"column-"+b);a+=".subform-popup ."+c+" .form-label{width : "+X.LABEL+"px;}";a+=".subform-popup ."+c+" .form-field{width : "+X.INPUT+"px;}";var W=X.LABEL+X.INPUT+d+Y;a+=".subform-popup ."+c+" {width : "+W+"px;}";Z=Z+W;return{css:a,totColsWidth:Z}}function K(a){var c=0,Z=0;for(var Y=0,W=a.length;Y<W;Y++){var X=a[Y],b=X.FIELDCOMPTYPE;if(b==FieldType.SUB_FORM_GRID||b==FieldType.SECTION||b==FieldType.PLAIN_TEXT||b==FieldType.DECISIONBOX){continue}lblWidth=J(X.FIELDCLASSNAME+"-label");inpWidth=Q(X.FIELDCLASSNAME);if(b==FieldType.IMAGE&&X.IMAGETYPE==3){inpWidth=inpWidth+30}if(lblWidth>c){c=lblWidth}if(inpWidth>Z){Z=inpWidth}}return{LABEL:c,INPUT:Z}}function O(Y){var Z=U,a=[];for(var X=0,W=Z.length;X<W;X++){if(Z[X].FIELDCOLUMN==Y){a.push(Z[X])}}return a}function M(){var a=0;var Y=U,Z=[];for(var X=0,W=Y.length;X<W;X++){if(a<Y[X].FIELDCOLUMN){a=Y[X].FIELDCOLUMN}}return a}function J(X){var W=R[0].querySelector("."+X);if(W!=null){return W.getBoundingClientRect().width}return 0}function Q(W){var X=R[0].querySelector(".column-block ."+W+"-group > .form-field");if(X!=null){return X.getBoundingClientRect().width}return 0}function T(W){var X=document.createElement("style");X.type="text/css";if(X.styleSheet){X.styleSheet.cssText=W}else{X.appendChild(document.createTextNode(W))}R[0].appendChild(X)}};this.calibrateWidth=function(K){F=0;var I=$(K[0].querySelectorAll(".form-group")),J=2;I.each(function(){var L=$(this)[0].getBoundingClientRect().width;F+=L});F=Math.ceil(F)+2;G.getInnerWrapper().width(F);G.getField().parent().width(Math.min((F+J),E))};this.adjustWidth=function(I){var J=this.getRow(I);sfFields=$(J.find(".form-group:visible")),innerWrapperPadding=2,rowWidth=0;sfFields.each(function(){var K=$(this)[0].getBoundingClientRect().width;rowWidth+=K});rowWidth=Math.ceil(rowWidth)+2;G.getInnerWrapper().width(rowWidth);G.getField().parent().width(Math.min((rowWidth+innerWrapperPadding),E))};this.hidePlaceHolder=function(){G.getPlaceHolder().css({display:"none"});G.getField().removeClass("zc-placeholder-overflow");G.getBottomAddNewLink().css({display:"block"});if(isMobileBrowser()){G.getBottomAddNewLink().addClass("suform-add-row-link")}};this.showPlaceHolder=function(I){if(I){G.getPlaceHolder().css({opacity:0});G.getPlaceHolder().show("blind",{direction:"up"},200,function(){$(this).animate({opacity:1},200);G.getBottomAddNewLink().hide()})}};this.deleteRow=function(L,K){var I=$((G.getField())[0].querySelector('div[rowNo="'+L+'"]')),J=I.next();I.remove();if(K&&J.length>0){J.find(".form-group").find("label").show()}if(D.getModel().isFormulaExist()){D.getField().trigger("change")}};this.hideAddLink=function(){G.getAddNewLink().hide()};this.showAddLink=function(){G.getAddNewLink().show()};this.hideDeleteLink=function(){G.getDeleteLinks().hide()};this.showDeleteLink=function(){G.getDeleteLinks().show()};this.showError=function(I){if(!this.hasError){var J=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+I+"</div>");G.getFieldParent().parent().append(J);this.hasError=true}};this.clearError=function(){if(this.hasError){$(G.getFieldParent().parent().find(".fieldErrorMsg")).remove();this.hasError=false}};this.bindFieldHelpText=function(){var K=G.getField().parent()[0];if(K!=undefined){var J=$(K.querySelector(".form-field")).width()-4;var I=$('<div class="zc-help-txt" style="white-space:pre-line;width:'+J+'px;"></div>');I.text(fieldModel.getTitle());$(K.querySelector(".form-label")).append(I)}};this.bindFieldDescription=function(){var I={tooltip:G.getModel().getTitle(),position:"auto"};I.tooltipelem=$(G.getField()).parent().find(".zc-label-text");$(I.tooltipelem).tooltipPositionCalc(I);$($(G.getField()[0].querySelector(".subform-placeholder .add_value_link")).find("a[elname=subFormLink]")).tooltipPositionCalc(I)}});createPrototype(SubformView,FieldView.prototype);var PhoneNumberView=(function(A,F,D){FieldView.call(this,A,F,D);var G=this;var H=false;var I=A.getModel();var E;this.fieldEvents=function(){var L=this;var M={};M.dropdownContainer=document.body;M.separateDialCode=true;M.preferredCountries=[];if(this.isFloatLabelAlignment()&&!I.isSubformField()){M.customPlaceholder=function(R,S){return""}}var K=false;if(I.getCountryList()!=undefined&&I.getCountryList().trim().length>0){var O=I.getCountryList().split(",");if(O.length==1){K=true}M.onlyCountries=O}E=intlTelInput(A.getFieldDOM(),M);if(I.getParentFormModel().getAccessType()==FormAccessType.VIEW_EDIT_RECORD&&C()){E.setNumber(I.getDefaultValue())}if(LIB._isNull($(A.getField()).val())){if(I.getDefaultCountryCode()!=undefined&&I.getDefaultCountryCode().trim().length>0){E.setCountry(I.getDefaultCountryCode())}else{var N=ZCWebStorage.getItem("countrycode");var J=/^[a-zA-Z]{1,2}$/;if(N!=undefined&&N!=""&&J.test(N)){B(M,N)}else{iplocate(function(S){var R=(S&&S.COUNTRY_CODE)?S.COUNTRY_CODE.toLowerCase():"";if(J.test(R)){ZCWebStorage.setItem("countrycode",R)}else{R="us"}B(M,R)},function(){},I.getParentFormModel().getPrivateLink())}}}$(A.getField()).change(function(){var R=(E.getSelectedCountryData().dialCode!=undefined&&E.isValidNumber());if(!LIB._isNull($(A.getField()).val())&&!R){F.clearError();F.showError(i18n.phonenovalidationerror)}else{F.clearError()}});$(A.getField()).on("countrychange",function(S,R){$(A.getField()).trigger("change")});$(A.getFlagContainer()).click(function(){G.showMask()});$(A.getFlagContainer()).keydown(function(R){if(R.keyCode==$.ui.keyCode.UP||R.keyCode==$.ui.keyCode.DOWN||R.keyCode==$.ui.keyCode.SPACE){if(!H){G.showMask()}}else{if(R.keyCode==$.ui.keyCode.TAB||R.keyCode==$.ui.keyCode.ESCAPE){G.hideMask()}else{if(R.keyCode==$.ui.keyCode.ENTER){if($(".country-list").length){G.hideMask()}else{if(!H){G.showMask()}}}}}});$(A.getFlagContainer()).find(".selected-flag").bind("focus blur",function(R){if(R.type=="focus"){$(this).addClass("zc-icon-focus")}else{if(R.type=="blur"){$(this).removeClass("zc-icon-focus")}}});$(".zc-scroll-mask").click(function(){$(window).scroll();$(".zc-scroll-mask").hide();if(ZCGlobal.isMobileLayout){$(".zc-mobile-frz-layer").hide();$(".zc-mobile-back-button").removeClass("zc-popup-enable")}});if(K){var Q=A.getFlagContainer();var P=Q.width();if(P!=undefined&&P!=""){$(A.getField()).css("padding-left",(parseInt(P)-6))}$(Q).css({"pointer-events":"none"});$(Q).unbind("keydown");$($(Q)[0].querySelector(".iti-arrow")).hide();$($(Q)[0].querySelector(".selected-flag")).removeAttr("tabindex")}};function B(K,J){if(K.onlyCountries==undefined||(K.onlyCountries!=undefined&&K.onlyCountries.indexOf(J)>=0)){E.setCountry(J)}}function C(){var J=I.getDefaultValue();var L=$(A.getField()).data("plugin_intlTelInput");if(L&&L._isRegionlessNanp){return L._isRegionlessNanp(J)}else{var N=["800","822","833","844","855","866","877","880","881","882","883","884","885","886","887","888","889"];var M=J.replace(/\D/g,"");if(M.charAt(0)=="1"){var K=M.substr(1,3);return $.inArray(K,N)>-1}return false}}this.hideMask=function(){unfreeze({container:"body",type:ZCFreezeConstants.MASK_ONLY_TYPE});H=false;if(ZCGlobal.isMobileLayout){$(".zc-mobile-back-button").removeClass("zc-popup-enable")}};this.showMask=function(){if(ZCGlobal.appDirectionMeta.isRTL){var L=A.getField()[0].offsetWidth;var K=$(".intl-tel-input.iti-container").css("left");var J=parseInt(L,10)+parseInt(K,10)}H=true;if(ZCGlobal.isMobileLayout){$(".zc-mobile-back-button").addClass("zc-popup-enable")}ifreeze({container:"body",type:ZCFreezeConstants.MASK_ONLY_TYPE,clickCallBack:function(){$(window).scroll();G.hideMask()}});if(ZCGlobal.appDirectionMeta.isRTL){$(".intl-tel-input.iti-container").css({"z-index":1000,left:J})}$(".intl-tel-input.iti-container").css({"z-index":1000});$(".intl-tel-input.iti-container").unbind("click").bind("click",function(){$(window).scroll();G.hideMask()})};this.getValue=function(){var J=A.getField().val();if(!LIB._isNull(J)&&(E.getSelectedCountryData().dialCode!=undefined)){J=E.getNumber()}return J};this.setValue=function(J){E.setNumber(J);$(A.getField()).blur()};this.destroy=function(){E.destroy()};this.showField=function(){G.getFieldContainer().show();var K=A.getFlagContainer();var J=K.width();if(J!=undefined&&J!=""){$(A.getField()).css("padding-left",(parseInt(J)+6))}}});createPrototype(PhoneNumberView,FieldView.prototype);var ExternalView=(function(D,C,B){FieldView.call(this,D,C,B);var A=this;this.fieldEvents=function(){D.getActionLink().click(function(){var E=D.getField().attr("disabled");if(E!=="disabled"){C.externalWindow()}});D.getField().focus(function(){A.triggerExternalOnUser()})};this.triggerExternalOnUser=function(){};this.openExternalWindow=function(E){window.open(E,"creatorwindow","location=1,status=1,scrollbars=1,width=700,height=600")}});createPrototype(ExternalView,FieldView.prototype);var RichTextView=(function(E,D,B){FieldView.call(this,E,D,B);this.zeObj={setContent:function(F){},getContent:function(){return""}};var A=this;var C=Math.floor(Math.random()*10000000);this.focus=function(){this.zeObj.win.focus()};this.fieldEvents=function(){E.getRTDiv().attr("id",C);D.createEditor()};this.safelyCreateEditor=function(F){try{ZE}catch(G){if(G instanceof ReferenceError){setTimeout(function(){A.safelyCreateEditor(F)},1000);return }}F.allowAttrsInsertHTML=["target"];this.zeObj=ZE.create(F)};this.createEditor=function(F){F.id=C+"";this.safelyCreateEditor(F)};this.getValue=function(){var F=(this.zeObj.doc==undefined||this.zeObj.state=="loading")&&this.zeObj.initobj!=undefined?this.zeObj.initobj.content:this.zeObj.getContent();if(F.length==4&&F=="<br>"){F=""}return F};this.setValue=function(G){var F=this;if(this.zeObj.doc==undefined||(this.zeObj.state!=undefined&&this.zeObj.state=="loading")){setTimeout(function(){F.setValue(G)},1000);return false}this.zeObj.doc.body.innerHTML=G};this.disableField=function(){if($((E.getRTDiv())[0].querySelector(".rt-disable")).length==0){var F=this;if(this.zeObj.doc==undefined||(this.zeObj.state!=undefined&&this.zeObj.state=="loading")){setTimeout(function(){F.disableField()},1000);return false}if($.browser.msie){this.zeObj.doc.body.contentEditable="false"}else{this.zeObj.doc.designMode="off"}var G=E.getRTDiv();G.addClass("rt-disable-toolbar");var H=G.find(".ze_toolbarbg").height();G.append('<div class="rt-disable" style="height: calc(100% - '+H+"px); top: "+H+'px"></div>')}};this.enableField=function(){var F=this;if(this.zeObj.doc==undefined||(this.zeObj.state!=undefined&&this.zeObj.state=="loading")){setTimeout(function(){F.enableField()},1000);return false}if($.browser.msie){this.zeObj.doc.body.contentEditable="true"}else{this.zeObj.doc.designMode="on"}var G=E.getRTDiv();G.removeClass("rt-disable-toolbar");$(G[0].querySelectorAll(".rt-disable")).remove()};this.destroy=function(){$(E.getRTDiv()).empty();$(E.getRTDiv()).removeAttr("id")}});createPrototype(RichTextView,FieldView.prototype);var SignatureView=(function(C,B,A){FieldView.call(this,C,B,A);var E,D;this.fieldEvents=function(){var P=C.getField();var O=$(P).attr("recordsequence");O=O!==undefined?O:"1";if(O!=="0"){var G=C.getSignature();$(C.getClearEle()).click(function(){$(G).jSignature("reset");if(ZCGlobal.isMobileLayout){E=[];D=[]}});var H={"decor-color":"transparent",height:"100",width:"300"};if(ZCGlobal.isMobileLayout){H.width="90%"}$(G).jSignature(H);$(G).addClass("signature-div");if(ZCGlobal.isMobileLayout){var K=$(G).find("canvas")[0];if($(G).find(".zc-signature-freezer").length==0){$(K).wrap("<div class='zc-signature-freezer'></div>")}var F=$(".signature-line-div");var J=C.getSignatureTextarea();var M=C.getSignatureContainer();$(G).delegate("div.zc-signature-freezer","click",function(){var Q=$.zcmodal({type:ZCModalConstants.JIT_MODAL,closeOnAnyClick:false,bodyClass:"zc-signature-popup",wrapperClass:"zc-signature-wrapper",title:C.getModel().getDisplayName(),buildDOM:function(){return'<div class="signature-popup-clear"><span><span><a href="javascript:;" elename="signatureClear">[Clear]</a></span></div><div elename="signaturePopup" class="signature-div" labelname="Signature"></div><div class="signature-line-div"></div>'},afterOpen:function(R){var T=$(R).find("div[eleName=signaturePopup]");var S={"decor-color":"transparent",height:"100",width:"100%"};$(T).jSignature(S);if(E!=undefined&&E[1]!=undefined&&E[1].length!=0){$(T).jSignature("setData","data:"+E.join())}$(R).find("a[eleName=signatureClear]").click(function(){$(T).jSignature("clear");$(G).jSignature("clear");E=[];D=[]})},afterClose:function(R){},buttons:[{id:"Done",name:i18n.done,type:ZCModalConstants.MODAL_SUBMIT,action:function(R){$(G).jSignature("clear");var S=$(R).find("div[eleName=signaturePopup]");E=$(S).jSignature("getData","base30");if(E!=undefined&&E[1]!=undefined&&E[1].length!=0){D=$(S).jSignature("getData","image");$(G).jSignature("setData","data:"+D.join())}return false}},{id:"Cancel",name:i18n.cancel,type:ZCModalConstants.MODAL_CANCEL,action:function(){}}]})});var N=false;window.addEventListener("resize",function(){if($(G).find(".jSignature").length==1){$(G).empty()}var R={"decor-color":"transparent",height:"100",width:"100%"};$(G).jSignature(R);var Q=$(G).find("canvas")[0];if($(G).find(".zc-signature-freezer").length==0){$(Q).wrap("<div class='zc-signature-freezer'></div>")}$(G).prepend(F);$(G).prepend(J);$(G).jSignature("clear");if(E!=undefined&&E[1]!=undefined&&E[1].length!=0){$(G).jSignature("setData","data:"+D.join())}N=true;I()});function I(){var R=[];var Q=[];var T=$(".zc-signature-popup").find("div[elename=signaturePopup]");if($zcmodal.hasInstance()){if($(T).find(".jSignature").length==1){R=$(T).jSignature("getData","base30");$(T).empty()}var S={"decor-color":"transparent",height:"100",width:"90%"};$(T).jSignature(S);if(N&&(R!=undefined&&R[1]!=undefined&&R[1].length!=0)){$(T).jSignature("setData","data:"+R.join());N=false}}}}var L=C.getSignatureContainer();if($(L).attr("isHide")==="true"){$(L).hide()}$(C.getToggleChangeEle()).click(function(){$(C.getEditEle()).hide();$(L).show();$(G).attr("update","true");C.getToggleRestoreEle().parent().show()});$(C.getToggleRestoreEle()).click(function(){$(C.getEditEle()).show();$(L).hide();$(G).attr("update","false")})}};this.getValue=function(){var I=C.getSignature(),K=$(I).attr("isEdit"),M="add",J="true";if(K==="true"){M="update";J=$(I).attr("update");J=J===undefined?true:J}if(J==="true"){var N=$(I).jSignature("getData","base30");if(N!=undefined){var H=N[1].length;if(H>0){var L=$(I).jSignature("getData","image");var F=M+","+L[1];C.getSignatureTextarea().val(F)}else{if(K){C.getSignatureTextarea().val("")}}}if(ZCGlobal.isMobileLayout){if(E!=undefined&&E[1]!=undefined){var F=M+","+D[1];C.getSignatureTextarea().val(F)}}}var G=C.getSignatureTextarea().val();return(G!=undefined&&G!=null)?G:""};this.setValue=function(G){if(G==""){var F=C.getSignature().attr("isEdit");if(F){C.getToggleRestoreEle().click()}else{C.getClearEle().click()}}}});createPrototype(SignatureView,FieldView.prototype);var PlainTextView=(function(C,B,A){FieldView.call(this,C,B,A);this.getValue=function(){return C.getField().html()};this.setValue=function(D){C.getField().html(D)}});createPrototype(PlainTextView,FieldView.prototype);var SectionView=(function(C,B,A){FieldView.call(this,C,B,A);this.getValue=function(){return C.getField().html()};this.setValue=function(D){C.getField().html(D)};this.hideField=function(){C.getSectionRow().hide()};this.showField=function(){C.getSectionRow().show()}});createPrototype(SectionView,FieldView.prototype);var IntegrationView=(function(E,D,B){FieldView.call(this,E,D,B);var A=this;var F=E.getModel();var C;this.fieldEvents=function(){this.getField().on("click",function(){A.opener()});this.getField().on("keydown",function(G){if(G.keyCode==13||G.keyCode==40){G.preventDefault();A.opener()}});E.getValueDeselectButton().on("click",function(G){G.stopPropagation();D.removeValue()});E.getDropArrow().on("click",function(G){G.stopPropagation();A.opener()})};this.onDemandBindEvents=function(){E.getOptionsDOM().find(".zc-combined-lookup-search-table").on("scroll.fetchData",function(){var G=Math.abs(($(this).scrollTop()+$(this).outerHeight())-$(this)[0].scrollHeight);if(G<100&&!F.getInProgress()){F.setInProgress(true);D.preDataController()}});$(document).on("keydown.lookupSearchTable",function(H){if(A.isOptionsVisible()){var G=E.getHighlightedRow();if(H.keyCode==40){H.preventDefault();if(G.next().length>0&&!F.getInProgress()){G.toggleClass("combined-lookup-row-highlighted");G.next().toggleClass("combined-lookup-row-highlighted");A.changeViewPort()}else{if(!F.getInProgress()){F.setInProgress(true);D.preDataController()}}}else{if(H.keyCode==38){H.preventDefault();if(G.prev().length>0&&!F.getInProgress()){G.toggleClass("combined-lookup-row-highlighted");G.prev().toggleClass("combined-lookup-row-highlighted");A.changeViewPort()}}else{if(H.keyCode==13&&!F.getInProgress()){H.preventDefault();D.setValueForField(G[0])}else{if(H.keyCode==27){H.preventDefault();H.stopPropagation();A.hideOptionsDOM();D.reset(false)}}}}}});E.getOptionsDOM().on("click.integFieldFocus",".zc-combined-lookup-search-icon",function(){$(this).prev("input").focus()});E.getOptionsDOM().on("keydown.showOptionsOnKeyDown",".zc-combined-lookup-search-head > input",A.triggerSearchQuery);E.getOptionsDOM().on("mouseover.highlightCurrentRecord","tbody[layoutType=options] > tr , tbody[layoutType=search] > tr",function(H){var G=E.getHighlightedRow();G.removeClass("combined-lookup-row-highlighted");$(H.target.parentElement).toggleClass("combined-lookup-row-highlighted")});E.getOptionsDOM().on("click.selectIntegrationValue","tbody[layoutType=options] > tr , tbody[layoutType=search] > tr",function(){D.setValueForField(this)})};this.unbindOnDemandEvents=function(){E.getOptionsDOM().find(".zc-combined-lookup-search-table").off("scroll.fetchData");$(document).off("keydown.lookupSearchTable");E.getOptionsDOM().off("click.integFieldFocus");E.getOptionsDOM().off("keydown.showOptionsOnKeyDown");E.getOptionsDOM().off("mouseover.highlightCurrentRecord");E.getOptionsDOM().off("click.selectIntegrationValue")};this.triggerSearchQuery=function(G){if(!((G.keyCode>=36&&G.keyCode<=40)||(G.keyCode>=16&&G.keyCode<=20)||(G.keyCode==9||G.keyCode==16)||(G.keyCode==91||G.keyCode==92))){clearTimeout(C);C=setTimeout(D.initiateSearchQuery,1000)}};this.opener=function(){if(!A.isOptionsVisible()){A.constructColumnHeaders(F.getColumnHeaders());A.showSpinner();A.showDefaultLayout();E.getScrollMask().show();E.getOptionsLayout().empty();E.getSearchLayout().empty();E.getMessageContainer().empty();F.setCurrentDisplayCount(0);D.preDataController();E.getScrollMask().on("click.integrationPopup",function(G){if(!($(G.target).closest(".zc-combined-lookup-search").length)&&!$(G.target).is(A.getField())){if(A.isOptionsVisible()){A.hideOptionsDOM();D.reset(false)}}});E.getFieldParentGroup().addClass("zc-focus");if(A.isFloatLabelAlignment()){E.getFieldParentGroup().addClass("zc-label-float")}}A.showOptionsDOM();A.onDemandBindEvents();E.getSearchBoxes()[0].focus();A.firstRowFocus()};this.constructOptionsDOM=function(){if(!E.getOptionsDOM().length){var G='<div id="zc-combined-lookup-popup" class="zc-dem-clearfix zc-combined-lookup-field-select" style="display:none"><div class="zc-combined-lookup-spinner"><i class="fa fa-spin fa-spinner"></i></div><div class="zc-combined-lookup-search-container"><table id="combinedlookupsearchtable" class="zc-combined-lookup-search"><thead><tr></tr></thead></table><div class="zc-combined-lookup-search-table"><table id="combinedlookupoptionstable"><tbody layouttype="options"></tbody><tbody layouttype="search"></tbody><tbody layouttype="default" class="zc-combined-lookup-nodata"><tr><td><span id="combinedlookupmessagecontainer"></span></td></tr></tbody></table></div></div></div>';$("body").append(G)}};this.changeViewPort=function(){var H=$(E.getHighlightedRow()).offset().top;var J=$(E.getHighlightedRow()).outerHeight(true);var I=$(E.getSearchOptionsTable()).outerHeight(true);var G=$(E.getSearchOptionsTable()).offset().top;if((G+I-H-J)<0){E.getSearchOptionsTable().scrollTop(E.getSearchOptionsTable().scrollTop()+J)}else{if((G-H)>0){E.getSearchOptionsTable().scrollTop(E.getSearchOptionsTable().scrollTop()-J)}}};this.isOptionsVisible=function(){return E.getOptionsDOM().is(":visible")};this.showOptionsDOM=function(){E.getOptionsDOM().show();F.setActive(true);A.calculatePosition();E.getSearchOptionsTable().scrollTop(0)};this.calculatePosition=function(){var T=E.getOptionsDOM();T.removeClass("zc-lookup-single-display-small zc-lookup-single-display-medium zc-lookup-single-display-large zc-combined-lookup-overflow-column");if(E.getSearchHeader().find("th").length<=3){if(E.getSearchHeader().find("th").length==1){if(E.getFieldParent().hasClass("smallSizeLive")){T.addClass("zc-lookup-single-display-small")}else{if(E.getFieldParent().hasClass("mediumSizeLive")){T.addClass("zc-lookup-single-display-medium")}else{if(E.getFieldParent().hasClass("largeSizeLive")){T.addClass("zc-lookup-single-display-large")}}}}T.addClass("zc-combined-lookup-overflow-column")}var G=T.outerHeight();var M=T.outerWidth();var P=A.getField().offset();var I=A.getField().outerWidth();var J=P.top+A.getField().outerHeight(true)-1,S=J;var R=P.left,N=R;var U=$(document).height();var L=$(document).width();var K=P.top;var Q=U-J;var O=L-R;var H=R;if(Q>=G){S=J}else{if(Q<G&&K>=G){S=K-G}else{if(K>Q){S=0;E.getSearchOptionsTable().height(K-40)}else{S=J;E.getSearchOptionsTable().height(Q-40)}}}if(O>=M){N=R}else{if(O<M&&H>=M){N=(R+I)-M}}$(T).css({top:S,left:N});E.getSearchOptionsTable().width(E.getSearchHeader().width())};this.hideOptionsDOM=function(){E.getOptionsDOM().hide();F.setActive(false);E.getScrollMask().off("click.integrationPopup");E.getSearchOptionsTable().removeAttr("style");E.getScrollMask().hide();E.getFieldParentGroup().removeClass("zc-focus");if(A.isFloatLabelAlignment()&&!this.getField().attr("field-id")){E.getFieldParentGroup().removeClass("zc-label-float")}E.getOptionsLayout().empty();E.getSearchLayout().empty();E.getMessageContainer().empty();A.unbindOnDemandEvents()};this.showSpinner=function(){E.getSearchSpinner().show();E.getOptionsDOM().addClass("zc-combined-lookup-freeze")};this.hideSpinner=function(){E.getSearchSpinner().hide();E.getOptionsDOM().removeClass("zc-combined-lookup-freeze")};this.showDeselector=function(){E.getValueDeselectButton().removeClass("zc-hide")};this.hideDeselector=function(){E.getValueDeselectButton().addClass("zc-hide")};this.disableField=function(){this.getField().attr("disabled",true);E.getFieldParentGroup().addClass("zc-disabled");if(isEdgeBrowser()){this.getField().attr("readonly",true)}};this.enableField=function(){this.getField().attr("disabled",false);E.getFieldParentGroup().removeClass("zc-disabled");if(isEdgeBrowser()){this.getField().attr("readonly",false)}};this.disableSearchBoxes=function(){E.getSearchBoxes().attr("disabled",true);E.getSearchBoxes().css("cursor","not-allowed")};this.enableSearchBoxes=function(){E.getSearchBoxes().removeAttr("disabled");E.getSearchBoxes().removeAttr("style")};this.showOptionsLayout=function(){E.getOptionsLayout().show();E.getSearchLayout().hide();E.getDefaultLayout().hide()};this.showSearchLayout=function(){E.getOptionsLayout().hide();E.getSearchLayout().show();E.getDefaultLayout().hide()};this.showDefaultLayout=function(){E.getOptionsLayout().hide();E.getSearchLayout().hide();E.getDefaultLayout().show()};this.showPlaceholder=function(){if(!A.isFloatLabelAlignment()||F.isSubformField()){this.getField().attr("placeholder",i18n.selectplaceholder)}};this.hidePlaceholder=function(){this.getField().attr("placeholder","")};this.firstRowFocus=function(){if(!E.getCurrentLayout().is(E.getDefaultLayout())){if(E.getCurrentLayout().find("tr").length>0){E.getCurrentLayout().find("tr:first").addClass("combined-lookup-row-highlighted")}}};this.constructColumnHeaders=function(K){var I=E.getSearchTableHeader().find("tr");I.empty();var L,M,G,J;for(var H=0;H<K.length;H++){L=$("<th/>");M=$("<div/>").addClass("zc-combined-lookup-search-head");G=$('<input type="text" maxLength="255" autocomplete="off"/>');J=$("<i/>").addClass("ui-1-zoom zc-li-outline zc-combined-lookup-search-icon");$(G).attr("placeholder",K[H].displayName);if(!K[H].isSearchable){$(G).attr("disabled",!K[H].isSearchable);$(G).css("cursor","not-allowed")}M.append(G);M.append(J);L.append(M);I.append(L)}};this.constructOptions=function(I,N,O){var G,H;if(O){I.empty()}for(var M in N){var J=N[M];G=$("<tr/>").attr("id",J.id);var L=J.actualText.split("@#zoho-comma#@");for(var K in L){H=$("<td/>").text(L[K]);G.append(H)}I.append(G)}};this.getSearchValues=function(){var H=[];var N,G,K;var M=E.getSearchBoxes();var J=F.getColumnHeaders();var L=false;for(var I=0;I<M.length;I++){N={};G=J[I].labelName;K=M[I].value;N.labelName=G;N.value=K;H.push(N)}return H}});createPrototype(IntegrationView,FieldView.prototype);var FormCacheHelper=(function(){var E;var J=this,G="";var B="formCache",H=36000*1000,I=36000*1000;this.status=G;this.isCacheAvailable=function(){return(G==="available")};this.generateKey=function(N,S){var R=(N).lastIndexOf("/form/")+"/form/".length,Q=N.length;for(var M=R;M<N.length;++M){if(N[M]==="/"||N[M]==="?"){Q=M;break}}var P=(N).substring(R,Q);var O=ZCGlobal.scopeName+"_"+ZCGlobal.appLinkName+"_"+P;if(S!==undefined){O+=S.formAccessType===FormAccessType.VIEW_EDIT_RECORD?"_edit":"";O+=S.editOnlyViewFields!==undefined?"_"+S.editOnlyViewFields:""}O+=previewURLRegex.test(N)?"_preview":"";return O};this.getFormHash=function(M){if(!J.isCacheAvailable()){throw new Error("Cache not initialized")}return new Promise(function(O,N){E.get(M).then(function(R){if(R!==undefined){var P=JSON.parse(R),Q=new Date().getTime();(Q-P.last_used_time<I)?O(P.CACHE_HASH):O(undefined)}else{O(undefined)}},function(){O(undefined)})})};this.getFormCache=function(M){if(!J.isCacheAvailable()){throw new Error("Cache not initialized")}return new Promise(function(O,N){E.get(M).then(function(Q){var P=JSON.parse(Q);O(P);P.last_used_time=new Date().getTime();E.put(M,JSON.stringify(P))},function(){O(undefined)})})};this.cacheForm=function(R,N,Q){if(!J.isCacheAvailable()){throw new Error("Cache not initialized")}var O=J.generateKey(N,Q);var P={MODEL:R.MODEL,HTML:R.HTML,CACHE_HASH:R.CACHE_HASH,cacheKey:O,last_used_time:new Date().getTime()};var M=E.put(O,JSON.stringify(P));return M};this.initFormCache=function(){return F().then(L)};function F(){return Promise.resolve()}function L(){var N=new CacheFactory();var O=CacheType.INMEMORY;E=N.getCache({type:O,poolName:B,NeededFallback:true});var M=E.init().then(A).then(function(){G="available"});catchPromiseChain(M,function(P){Console.log(P);G="error"})}function A(){var N=ZCWebStorage.getItem("last_cleanup_time"),M=new Date().getTime();if(N&&M-N<H||E.getCacheType()===CacheType.INMEMORY){return Promise.resolve()}var P=E.getAllKeys();var O=P.then(D).then(C).then(K).then(function(){ZCWebStorage.setItem("last_cleanup_time",new Date().getTime())});return catchPromiseChain(O)}function D(O){var P=O.map(function(Q){return E.get(Q)});var N=[];P.forEach(function(Q){Q.then(M)});return Promise.all(P).then(function(){return N});function M(Q){if(Q!==undefined){N.push(Q)}}}function C(M){var N=new Date().getTime();return M.map(function(O){return JSON.parse(O)}).filter(function(O){return(N-O.last_used_time>I)}).map(function(O){return O.cacheKey})}function K(N){var M=N.map(function(O){return E.remove(O)});return Promise.all(M)}});window.formCacheHelper=new FormCacheHelper();formCacheHelper.initFormCache();